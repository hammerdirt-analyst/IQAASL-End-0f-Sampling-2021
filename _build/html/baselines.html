

<!DOCTYPE html>


<html lang="de" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>14. Basiswerte für Abfallobjekte an Gewässern &#8212; My Jupyter Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/.ipynb_checkpoints/custom-checkpoint.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'baselines';</script>
    <link rel="index" title="Stichwortverzeichnis" href="genindex.html" />
    <link rel="search" title="Suche" href="search.html" />
    <link rel="next" title="15. Statistische Schlüsselindikatoren" href="key_indicators.html" />
    <link rel="prev" title="13. Zürichsee" href="zurichsee.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="de"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="titlepage_de.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/newlogo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/newlogo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Zusammenfassung</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="foreword.html">Vorwort</a></li>
<li class="toctree-l1"><a class="reference internal" href="esummary.html">Kurzfassung</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Ergebnisse der Erhebung</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lakes_rivers.html">1. Seen und Fliessgewässer</a></li>
<li class="toctree-l1"><a class="reference internal" href="alpes_valaisannes.html">2. Alpen und der Jura</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Erhebungsgebiete</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="aare_sa.html">3. Aare</a></li>
<li class="toctree-l1"><a class="reference internal" href="linth_sa.html">4. Linth</a></li>
<li class="toctree-l1"><a class="reference internal" href="rhone_sa.html">5. Rhône</a></li>
<li class="toctree-l1"><a class="reference internal" href="ticino_sa.html">6. Ticino</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seen</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="bielersee.html">7. Bielersee</a></li>
<li class="toctree-l1"><a class="reference internal" href="lac-leman.html">8. Lac Léman</a></li>
<li class="toctree-l1"><a class="reference internal" href="neuenburgersee.html">9. Neuenburgersee</a></li>
<li class="toctree-l1"><a class="reference internal" href="maggiorelugano.html">10. Lago Maggiore/Luganersee</a></li>
<li class="toctree-l1"><a class="reference internal" href="thunerseebrienzersee.html">11. Thunersee/Brienzersee</a></li>
<li class="toctree-l1"><a class="reference internal" href="walensee.html">12. Walensee</a></li>
<li class="toctree-l1"><a class="reference internal" href="zurichsee.html">13. Zürichsee</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Verstehen</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">14. Basiswerte für Abfallobjekte an Gewässern</a></li>
<li class="toctree-l1"><a class="reference internal" href="key_indicators.html">15. Statistische Schlüsselindikatoren</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_groups.html">16. Codegruppen</a></li>
<li class="toctree-l1"><a class="reference internal" href="land_use_correlation.html">17. Landnutzungsprofil</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">18. Bibliografie</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Anwendungen</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="reuse_remake.html">19. Recyceln und neugestalten</a></li>
<li class="toctree-l1"><a class="reference internal" href="shared_responsibility.html">20. Geteilte Verantwortung</a></li>
<li class="toctree-l1"><a class="reference internal" href="slr-iqaasl.html">21. Vergleich der Datenerhebungen seit 2018</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/hammerdirt-analyst/IQAASL-End-0f-Sampling-2021" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Quell-Repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/hammerdirt-analyst/IQAASL-End-0f-Sampling-2021/issues/new?title=Issue%20on%20page%20%2Fbaselines.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Öffnen Sie ein Problem"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Vollbildmodus"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Suche" aria-label="Suche" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Basiswerte für Abfallobjekte an Gewässern</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Inhalt </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#zahlen-von-abfallobjekten-am-strand-ein-uberblick">14.1. Zählen von Abfallobjekten am Strand: ein Überblick</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#schweiz-2020">14.1.1. Schweiz 2020</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#das-sammeln-von-daten">14.1.2. Das Sammeln von Daten</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#festlegung-des-erhebungsgebiets">14.1.2.1. Festlegung des Erhebungsgebiets</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zahlen-von-objekten">14.1.2.2. Zählen von Objekten</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#berechnung-der-basislinien">14.2. Berechnung der Basislinien</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#die-daten">14.2.1. Die Daten</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#die-bewertungsmetrik">14.2.2. Die Bewertungsmetrik</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#konfidenzintervalle-kis">14.2.3. Konfidenzintervalle (KIs)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-methoden">14.2.3.1. Bootstrap-Methoden:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vergleich-der-bootstrap-kis">14.2.4. Vergleich der Bootstrap-KIs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basiswerte">14.2.5. Basiswerte</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#basismedianwert-aller-erhebungsergebnisse">14.2.5.1. Basismedianwert aller Erhebungsergebnisse</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#median-basislinie-und-ki-pro-erhebungsgebiet">14.2.5.2. Median-Basislinie und KI pro Erhebungsgebiet</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extremwerte">14.3. Extremwerte</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extremwerte-definieren">14.3.1. Extremwerte definieren</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#angepasste-boxplots">14.3.1.1. Angepasste Boxplots</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modellierung">14.3.1.2. Modellierung</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#methode-der-momente-mom">14.3.1.2.1. Methode der Momente (MOM)</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-likelihood-schatzung-mle">14.3.1.2.2. Maximum-Likelihood-Schätzung (MLE)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#umsetzung">14.4. Umsetzung</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf8 -*-</span>
<span class="c1"># This is a report using the data from IQAASL.</span>
<span class="c1"># IQAASL was a project funded by the Swiss Confederation</span>
<span class="c1"># It produces a summary of litter survey results for a defined region.</span>
<span class="c1"># These charts serve as the models for the development of plagespropres.ch</span>
<span class="c1"># The data is gathered by volunteers.</span>
<span class="c1"># Please remember all copyrights apply, please give credit when applicable</span>
<span class="c1"># The repo is maintained by the community effective January 01, 2022</span>
<span class="c1"># There is ample opportunity to contribute, learn and teach</span>
<span class="c1"># contact dev@hammerdirt.ch</span>

<span class="c1"># Dies ist ein Bericht, der die Daten von IQAASL verwendet.</span>
<span class="c1"># IQAASL war ein von der Schweizerischen Eidgenossenschaft finanziertes Projekt.</span>
<span class="c1"># Es erstellt eine Zusammenfassung der Ergebnisse der Littering-Umfrage für eine bestimmte Region.</span>
<span class="c1"># Diese Grafiken dienten als Vorlage für die Entwicklung von plagespropres.ch.</span>
<span class="c1"># Die Daten werden von Freiwilligen gesammelt.</span>
<span class="c1"># Bitte denken Sie daran, dass alle Copyrights gelten, bitte geben Sie den Namen an, wenn zutreffend.</span>
<span class="c1"># Das Repo wird ab dem 01. Januar 2022 von der Community gepflegt.</span>
<span class="c1"># Es gibt reichlich Gelegenheit, etwas beizutragen, zu lernen und zu lehren.</span>
<span class="c1"># Kontakt dev@hammerdirt.ch</span>

<span class="c1"># Il s&#39;agit d&#39;un rapport utilisant les données de IQAASL.</span>
<span class="c1"># IQAASL était un projet financé par la Confédération suisse.</span>
<span class="c1"># Il produit un résumé des résultats de l&#39;enquête sur les déchets sauvages pour une région définie.</span>
<span class="c1"># Ces tableaux ont servi de modèles pour le développement de plagespropres.ch</span>
<span class="c1"># Les données sont recueillies par des bénévoles.</span>
<span class="c1"># N&#39;oubliez pas que tous les droits d&#39;auteur s&#39;appliquent, veuillez indiquer le crédit lorsque cela est possible.</span>
<span class="c1"># Le dépôt est maintenu par la communauté à partir du 1er janvier 2022.</span>
<span class="c1"># Il y a de nombreuses possibilités de contribuer, d&#39;apprendre et d&#39;enseigner.</span>
<span class="c1"># contact dev@hammerdirt.ch</span>

<span class="c1"># sys, file and nav packages:</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">locale</span>
<span class="c1"># math packages:</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.distributions.empirical_distribution</span> <span class="kn">import</span> <span class="n">ECDF</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.stattools</span> <span class="kn">import</span> <span class="n">medcouple</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">newton</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">digamma</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="c1"># charting:</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">ticker</span>
<span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1"># home brew utitilties</span>
<span class="kn">import</span> <span class="nn">resources.chart_kwargs</span> <span class="k">as</span> <span class="nn">ck</span>
<span class="kn">import</span> <span class="nn">resources.sr_ut</span> <span class="k">as</span> <span class="nn">sut</span>

<span class="c1"># build report</span>
<span class="kn">import</span> <span class="nn">reportlab</span>
<span class="kn">from</span> <span class="nn">reportlab.platypus.flowables</span> <span class="kn">import</span> <span class="n">Flowable</span>
<span class="kn">from</span> <span class="nn">reportlab.platypus</span> <span class="kn">import</span> <span class="n">SimpleDocTemplate</span><span class="p">,</span> <span class="n">Paragraph</span><span class="p">,</span><span class="n">PageBreak</span><span class="p">,</span> <span class="n">KeepTogether</span>
<span class="kn">from</span> <span class="nn">reportlab.lib.pagesizes</span> <span class="kn">import</span> <span class="n">A4</span>
<span class="kn">from</span> <span class="nn">reportlab.lib.units</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">from</span> <span class="nn">reportlab.platypus</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">TableStyle</span>

<span class="c1"># the module that has all the methods for handling the data</span>
<span class="kn">import</span> <span class="nn">resources.featuredata</span> <span class="k">as</span> <span class="nn">featuredata</span>
<span class="kn">from</span> <span class="nn">resources.featuredata</span> <span class="kn">import</span> <span class="n">makeAList</span><span class="p">,</span> <span class="n">small_space</span><span class="p">,</span> <span class="n">large_space</span><span class="p">,</span> <span class="n">aSingleStyledTable</span><span class="p">,</span> <span class="n">smallest_space</span>
<span class="kn">from</span> <span class="nn">resources.featuredata</span> <span class="kn">import</span> <span class="n">caption_style</span><span class="p">,</span> <span class="n">subsection_title</span><span class="p">,</span> <span class="n">title_style</span><span class="p">,</span> <span class="n">block_quote_style</span>
<span class="kn">from</span> <span class="nn">resources.featuredata</span> <span class="kn">import</span> <span class="n">figureAndCaptionTable</span><span class="p">,</span> <span class="n">tableAndCaption</span><span class="p">,</span> <span class="n">aStyledTableWithTitleRow</span>
<span class="kn">from</span> <span class="nn">resources.featuredata</span> <span class="kn">import</span> <span class="n">sectionParagraphs</span><span class="p">,</span> <span class="n">section_title</span><span class="p">,</span> <span class="n">addToDoc</span><span class="p">,</span> <span class="n">makeAParagraph</span><span class="p">,</span> <span class="n">bold_block</span>

<span class="c1"># images and display</span>
<span class="kn">import</span> <span class="nn">IPython</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span> <span class="k">as</span> <span class="nn">mpimg</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">loc</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">getlocale</span><span class="p">()</span>
<span class="n">lang</span> <span class="o">=</span>  <span class="s2">&quot;de_CH.utf8&quot;</span>
<span class="n">locale</span><span class="o">.</span><span class="n">setlocale</span><span class="p">(</span><span class="n">locale</span><span class="o">.</span><span class="n">LC_ALL</span><span class="p">,</span> <span class="n">lang</span><span class="p">)</span>

<span class="c1"># set some parameters:</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="s1">&#39;2020-03-01&#39;</span>
<span class="n">end_date</span> <span class="o">=</span><span class="s1">&#39;2021-05-31&#39;</span>

<span class="c1"># name of the output folder:</span>
<span class="n">name_of_project</span> <span class="o">=</span> <span class="s1">&#39;threshold_values&#39;</span>
<span class="n">save_fig_prefix</span> <span class="o">=</span> <span class="s2">&quot;resources/output/&quot;</span>

<span class="n">save_figure_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;fname&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s2">&quot;dpi&quot;</span><span class="p">:</span> <span class="mf">300.0</span><span class="p">,</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;jpeg&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bbox_inches&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s2">&quot;pad_inches&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;bbox_inches&quot;</span><span class="p">:</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span>
    <span class="s2">&quot;facecolor&quot;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="s2">&quot;edgecolor&quot;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="s2">&quot;backend&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">}</span>


<span class="c1"># the scale for pieces per meter and the column and chart label for the units</span>
<span class="n">reporting_unit</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">unit_label</span> <span class="o">=</span> <span class="s1">&#39;p/100 m&#39;</span>

<span class="c1"># get your data:</span>
<span class="n">survey_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;resources/checked_sdata_eos_2020_21.csv&#39;</span><span class="p">)</span>
<span class="n">dfBeaches</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;resources/beaches_with_land_use_rates.csv&quot;</span><span class="p">)</span>
<span class="n">dfCodes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;resources/codes_with_group_names_2015.csv&quot;</span><span class="p">)</span>
<span class="n">dfDims</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;resources/corrected_dims.csv&quot;</span><span class="p">)</span>

<span class="c1"># set the index of the beach data to location slug</span>
<span class="n">dfBeaches</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># index the code data</span>
<span class="n">dfCodes</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># make a map to the code descriptions</span>
<span class="n">code_description_map</span> <span class="o">=</span> <span class="n">dfCodes</span><span class="o">.</span><span class="n">description</span>

<span class="c1"># make a map to the code descriptions</span>
<span class="n">code_material_map</span> <span class="o">=</span> <span class="n">dfCodes</span><span class="o">.</span><span class="n">material</span>

<span class="c1"># this defines the css rules for the note-book table displays</span>
<span class="n">header_row</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;th:nth-child(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;background-color: #FFF; font-size:20px; text-align:left;&#39;</span><span class="p">}</span>
<span class="n">even_rows</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s1">&#39;tr:nth-child(even)&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;background-color: rgba(139, 69, 19, 0.08);&#39;</span><span class="p">}</span>
<span class="n">odd_rows</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;tr:nth-child(odd)&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="s1">&#39;background: #FFF;&#39;</span><span class="p">}</span>
<span class="n">table_font</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;tr&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="s1">&#39;font-size: 20px;&#39;</span><span class="p">}</span>
<span class="n">table_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;td&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="s1">&#39;padding:6px;&#39;</span><span class="p">}</span>
<span class="n">table_css_styles</span> <span class="o">=</span> <span class="p">[</span><span class="n">even_rows</span><span class="p">,</span> <span class="n">odd_rows</span><span class="p">,</span> <span class="n">table_font</span><span class="p">,</span> <span class="n">header_row</span><span class="p">,</span> <span class="n">table_data</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="basiswerte-fur-abfallobjekte-an-gewassern">
<span id="threshhold"></span><h1><span class="section-number">14. </span>Basiswerte für Abfallobjekte an Gewässern<a class="headerlink" href="#basiswerte-fur-abfallobjekte-an-gewassern" title="Link zu dieser Überschrift">#</a></h1>
<p><a class="reference download internal" download="" href="_downloads/b7c85740c4bb5b92811f63cef8ebacd5/baselines.pdf"><code class="xref download docutils literal notranslate"><span class="pre">Download</span></code></a></p>
<p>Basiswerte (BVs), die auch als Benchmarks bezeichnet werden, sind die Mengen oder Werte, die zur statistischen Definition einer Situation verwendet werden. Die BVs beziehen sich auf eine Reihe von Daten, die sowohl zeitlich als auch geografisch begrenzt sind und auch als Referenzpunkt oder Basisperiode bezeichnet werden. BVs sind die Grössen, an denen der Fortschritt gemessen wird. In dieser Hinsicht sind die BVs eng mit den Daten und den zu ihrer Erhebung verwendeten Methoden verbunden.</p>
<div class="section" id="zahlen-von-abfallobjekten-am-strand-ein-uberblick">
<h2><span class="section-number">14.1. </span>Zählen von Abfallobjekten am Strand: ein Überblick<a class="headerlink" href="#zahlen-von-abfallobjekten-am-strand-ein-uberblick" title="Link zu dieser Überschrift">#</a></h2>
<p>Der erste internationale Leitfaden zur Erfassung von Abfallobjekten am Strand wurde 2008 vom Umweltprogramm der Vereinten Nationen (UNEP) und der Zwischenstaatlichen Ozeanographischen Kommission (IOC) veröffentlicht <span id="id1">[<a class="reference internal" href="references.html#id48" title="Cheshire et all. Unep/ioc guidelines on survey and monitoring of marine litter. UNEP Regional Seas Reports and Studies, 2009.">eall09</a>]</span>. Auf der Grundlage der gesammelten Arbeit vieler Forschenden wurde diese Methode 2010 von der OSPAR-Kommission übernommen <span id="id2">[<a class="reference internal" href="references.html#id43" title="OSPAR. Beach litter - abundance, composition and trends. D10 - Marine Litter, 2017.">OSP17</a>]</span>,  2013 veröffentlichte die EU einen Leitfaden für die Überwachung mariner Abfallobjekte an den europäischen Meeren (<em>the guide</em>) <span id="id3">[<a class="reference internal" href="references.html#id41" title="George Hanke. Guidance on monitoring of marine litter in european seas. Joint Research Centre of the European Commission, 2013. URL: https://indicit-europa.eu/cms/wp-content/uploads/2017/05/guidance_monitoring_marine_litter_2013.pdf.">Han13</a>]</span>. Die Schweiz ist Mitglied von OSPAR und hat über 1000 Proben nach den im the guide beschriebenen Methoden genommen.</p>
<p>Auf <em>the guide</em> folgte 2016 Riverine Litter Monitoring - Options and Recommendations <span id="id4">[<a class="reference internal" href="references.html#id45" title="Georg Hanke, Daniel González Fernández, Tweehuysen, Bellert, Holzhauer, Andreja Palatinus, Hohenblum, and L. Oosterbaan. Riverine litter monitoring - options and recommendations. publications Office of the European Union, 02 2017. doi:10.2788/461233.">HGFT+17</a>]</span>, der die zunehmende Erkenntnis widerspiegelt, dass Flüsse wichtige Quellen für Haushaltsabfälle in Küstenregionen sind. Zu diesem Zeitpunkt war das erste Projekt zur Überwachung von Abfallobjekten am Genfer See bereits abgeschlossen und die Vorbereitungen für ein einjähriges nationales Projekt in der Schweiz, das von STOPPP initiiert und von WWF-Freiwilligen unterstützt wurde, liefen an, siehe <a class="reference internal" href="slr-iqaasl.html#slr-iqaasl"><span class="std std-ref">Vergleich der Datenerhebungen seit 2018</span></a>.</p>
<p>2019 veröffentlichte das Joint Research Centre (JRC) eine Analyse eines europäischen Datensatzes zu Abfallobjekten am Strand aus den Jahren 2012–2016, ein technisches Dokument, in dem die Methoden und verschiedenen Szenarien zur Berechnung von Basiswerten von Abfallobjekten am Strand detailliert beschrieben werden. Von besonderem Interesse für das JRC war die Robustheit der Methoden gegenüber Extremwerten und die Transparenz der Berechnungsmethode.<span id="id5">[<a class="reference internal" href="references.html#id42" title="van Loon W. Hanke G., Walvoort D. Eu marine beach litter baselines. Publications Office of the European Union, 2019. doi:10.2760/16903.">HG19</a>]</span></p>
<p>Im September 2020 schliesslich legte die EU Basis- und Zielwerte auf der Grundlage der 2015–2016 erhobenen Daten fest. Die Zielwerte beziehen sich auf den guten Umweltzustand der Meeresgewässer, der in der Meeresstrategie-Rahmenrichtlinie (MSRL) beschrieben wird. Die Basiswerte wurden anhand der in der Veröffentlichung von 2019 beschriebenen Methoden berechnet.<span id="id6">[<a class="reference internal" href="references.html#id44" title="Fleet D. Van Loon W., Hanke G. A european threshold value and assessment method for macro litter on coastlines. Publications Office of the European Union, 2020.">VLW20</a>]</span></p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="figure align-default" id="takingnotes2">
<img alt="_images/takingnotes2.jpg" src="_images/takingnotes2.jpg" />
<p class="caption"><span class="caption-number">Abb. 14.1 </span><span class="caption-text"><span class="pasted-text"> </span></span><a class="headerlink" href="#takingnotes2" title="Link zu diesem Bild">#</a></p>
</div>
<p><a class="reference internal" href="#takingnotes2"><span class="std std-numref">Abbildung 14.1:</span></a> Zählen von Abfallobjekten am 18.05.2020 am Zürichsee, Richterswil; 3,49 Objekte pro Meter</p>
<div class="section" id="schweiz-2020">
<h3><span class="section-number">14.1.1. </span>Schweiz 2020<a class="headerlink" href="#schweiz-2020" title="Link zu dieser Überschrift">#</a></h3>
<p>Das IQAASL-Projekt begann im März 2020. Erhebungsorte in den definierten Erhebungsgebieten wurden 2017 beprobt oder neu eingerichtet. Ähnlich wie die Erhebungsergebnisse in der Meeresumwelt sind die Daten über Ufer-Abfallobjekte in der Schweiz sehr unterschiedlich. Die Werte reichen von Null bis zu Tausenden von Objekten und Fragmenten innerhalb von 100 m Distanz entlang von Fluss- oder Seeufer.</p>
</div>
<div class="section" id="das-sammeln-von-daten">
<h3><span class="section-number">14.1.2. </span>Das Sammeln von Daten<a class="headerlink" href="#das-sammeln-von-daten" title="Link zu dieser Überschrift">#</a></h3>
<p><em>The guide</em> ist die Referenz für dieses Projekt. Die Geographie der Schweiz besteht jedoch nicht aus langen, homogenen Küstenabschnitten. Daher müssen bestimmte Empfehlungen in den Kontext der lokalen Topographie gestellt werden:</p>
<ol class="arabic simple">
<li><p>Die empfohlene Länge bleibt bei 100 m, je nach Region ist dies jedoch nicht immer möglich.</p></li>
</ol>
<div class="section" id="festlegung-des-erhebungsgebiets">
<h4><span class="section-number">14.1.2.1. </span>Festlegung des Erhebungsgebiets<a class="headerlink" href="#festlegung-des-erhebungsgebiets" title="Link zu dieser Überschrift">#</a></h4>
<p>Ein Vermessungsgebiet wird durch den GPS-Punkt und die aufgezeichneten Vermessungsmasse definiert. Die Mindestbreite ist der Abstand zwischen der Wasserkante und der Uferlinie. In einigen Fällen können die Uferlinie und der hintere Teil des Ufers identisch sein. Für weitere Informationen darüber, wie die Vermessungsflächen gemessen werden, siehe <a class="reference internal" href="land_use_correlation.html#luseprofile"><span class="std std-ref">Das Landnutzungsprofil</span></a>.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="figure align-default" id="types-survey-locations">
<img alt="_images/cab33524b8c4959da5c3ae05c3bdad0a64e523fb9b5bfd433486d5b0a7bdd231.png" src="_images/cab33524b8c4959da5c3ae05c3bdad0a64e523fb9b5bfd433486d5b0a7bdd231.png" />
<p class="caption"><span class="caption-number">Abb. 14.2 </span><span class="caption-text"><span class="pasted-text"> </span></span><a class="headerlink" href="#types-survey-locations" title="Link zu diesem Bild">#</a></p>
</div>
<p><a class="reference internal" href="#types-survey-locations"><span class="std std-numref">Abbildung 14.2:</span></a> Die Datenerhebungen finden in der Stadt, auf dem Land und in der Agglomeration statt.</p>
<p>Die Länge und Breite des Erhebungsgebiets wird bei jeder Datenerhebung gemessen. So kann die Anzahl der Objekte in einer Standardeinheit unabhängig von den Erhebungsorten angegeben werden. In diesem Bericht wird die von der EU empfohlene Standard-Berichtseinheit verwendet: Abfallobjekte pro 100 Meter.</p>
</div>
<div class="section" id="zahlen-von-objekten">
<h4><span class="section-number">14.1.2.2. </span>Zählen von Objekten<a class="headerlink" href="#zahlen-von-objekten" title="Link zu dieser Überschrift">#</a></h4>
<p>Alle sichtbaren Objekte innerhalb eines Untersuchungsgebiets werden gesammelt, klassifiziert und gezählt. Das Gesamtgewicht von Material und Plastik wird ebenfalls erfasst. Die Objekte werden anhand von <a class="reference internal" href="code_groups.html#codegroups"><span class="std std-ref"> Code-Definitionen </span></a> klassifiziert, die auf einer Masterliste von Codes in the guide basieren. Spezielle Objekte, die von lokalem Interesse sind, wurden unter G9xx und G7xx hinzugefügt.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="figure align-default" id="takingnotes">
<img alt="_images/takingnotes.jpg" src="_images/takingnotes.jpg" />
<p class="caption"><span class="caption-number">Abb. 14.3 </span><span class="caption-text"><span class="pasted-text"> </span></span><a class="headerlink" href="#takingnotes" title="Link zu diesem Bild">#</a></p>
</div>
<p><a class="reference internal" href="#takingnotes"><span class="std std-numref">Abbildung 14.3:</span></a> Zählen und Klassifizieren einer Probe. Die Objekte werden nach dem Sammeln sortiert und gezählt. Die ursprüngliche Zählung wird in einem Notizbuch festgehalten, und die Daten werden in die Anwendung <a class="reference external" href="https://www.plagespropres.ch/"> plages-propres </a> eingegeben, wenn der Erheber es wünscht.</p>
</div>
</div>
</div>
<div class="section" id="berechnung-der-basislinien">
<h2><span class="section-number">14.2. </span>Berechnung der Basislinien<a class="headerlink" href="#berechnung-der-basislinien" title="Link zu dieser Überschrift">#</a></h2>
<p>Die in den Abschnitten 3 und 4 von A European Threshold Value and Assessment Method for Macro litter on Coastlines und den Abschnitten 6, 7 und 8 von Analysis of a pan-European 2012-2016 beach litter data set beschriebenen Methoden werden auf die Ergebnisse der vorliegenden Untersuchung angewendet.</p>
<p>Die verschiedenen Optionen für die Berechnung von Basislinien, die Bestimmung von Konfidenzintervallen und die Identifizierung von Extremwerten werden erläutert und mit Beispielen versehen.</p>
<p><strong>Annahmen:</strong></p>
<ul class="simple">
<li><p>Je mehr Abfallobjekte auf dem Boden liegen, desto grösser ist die Wahrscheinlichkeit, dass eine Person sie findet.</p></li>
<li><p>Die Erhebungsergebnisse stellen die Mindestmenge an Abfallobjekten an diesem Ort dar.</p></li>
<li><p>Für jede Datenerhebung: Das Auffinden eines Objekts hat keinen Einfluss auf die Wahrscheinlichkeit, ein weiteres zu finden.</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
</div>
<div class="section" id="die-daten">
<h3><span class="section-number">14.2.1. </span>Die Daten<a class="headerlink" href="#die-daten" title="Link zu dieser Überschrift">#</a></h3>
<p>Nur Datenerhebungen mit einer Länge von mehr als zehn Metern und weniger als 100 Metern werden in die Berechnung der Basislinie einbezogen. Die folgenden Objekte wurden ausgeschlossen:</p>
<ol class="arabic simple">
<li><p>Objekte kleiner als 2,5 cm</p></li>
<li><p>Paraffin, Wachs, Öl und andere Chemikalien</p></li>
</ol>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the final survey data set here:</span>
<span class="n">a_data</span> <span class="o">=</span> <span class="n">survey_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">a_data</span> <span class="o">=</span> <span class="n">a_data</span><span class="p">[</span><span class="n">a_data</span><span class="o">.</span><span class="n">river_bassin</span> <span class="o">!=</span> <span class="s1">&#39;les-alpes&#39;</span><span class="p">]</span>

<span class="c1"># make a loc_date column from the survey data</span>
<span class="c1"># before converting to timestamp</span>
<span class="n">a_data</span><span class="p">[</span><span class="s1">&#39;loc_date&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">a_data</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="n">a_data</span><span class="o">.</span><span class="n">date</span><span class="p">))</span>

<span class="c1"># convert string dates from .csv to timestamp</span>
<span class="n">a_data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">a_data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># slice by start - end date</span>
<span class="n">a_data</span> <span class="o">=</span> <span class="n">a_data</span><span class="p">[(</span><span class="n">a_data</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">a_data</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)]</span>

<span class="c1"># combine lugano and maggiore</span>
<span class="c1"># if the river bassin name does not equal tresa leave it, else change it to ticino</span>
<span class="n">a_data</span><span class="p">[</span><span class="s1">&#39;river_bassin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_data</span><span class="o">.</span><span class="n">river_bassin</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">a_data</span><span class="o">.</span><span class="n">river_bassin</span> <span class="o">!=</span> <span class="s1">&#39;tresa&#39;</span><span class="p">,</span> <span class="s1">&#39;ticino&#39;</span> <span class="p">)</span>

<span class="c1"># assign the reporting value</span>
<span class="n">a_data</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">a_data</span><span class="o">.</span><span class="n">pcs_m</span> <span class="o">*</span> <span class="n">reporting_unit</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># save the data before aggregating to test</span>
<span class="n">before_agg</span> <span class="o">=</span> <span class="n">a_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># !! Remove the objects less than 2.5cm and chemicals !!</span>
<span class="n">codes_todrop</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;G81&#39;</span><span class="p">,</span> <span class="s1">&#39;G78&#39;</span><span class="p">,</span> <span class="s1">&#39;G212&#39;</span><span class="p">,</span> <span class="s1">&#39;G213&#39;</span><span class="p">,</span> <span class="s1">&#39;G214&#39;</span><span class="p">]</span>
<span class="n">a_data</span> <span class="o">=</span> <span class="n">a_data</span><span class="p">[</span><span class="o">~</span><span class="n">a_data</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">codes_todrop</span><span class="p">)]</span>

<span class="c1"># use the code groups to get rid of all objects less than 5mm</span>
<span class="n">a_data</span> <span class="o">=</span> <span class="n">a_data</span><span class="p">[</span><span class="n">a_data</span><span class="o">.</span><span class="n">groupname</span> <span class="o">!=</span>  <span class="s1">&#39;micro plastics (&lt; 5mm)&#39;</span><span class="p">]</span>

<span class="c1"># match records to survey data</span>
<span class="n">fd_dims</span><span class="o">=</span> <span class="n">dfDims</span><span class="p">[(</span><span class="n">dfDims</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">a_data</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span><span class="o">&amp;</span><span class="p">(</span><span class="n">dfDims</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">dfDims</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># make a loc_date column and get the unique values</span>
<span class="n">fd_dims</span><span class="p">[</span><span class="s1">&#39;loc_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">fd_dims</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="n">fd_dims</span><span class="o">.</span><span class="n">date</span><span class="p">))</span>

<span class="c1"># map the survey area name to the dims data record</span>
<span class="n">a_map</span> <span class="o">=</span> <span class="n">fd_dims</span><span class="p">[[</span><span class="s1">&#39;loc_date&#39;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;loc_date&#39;</span><span class="p">)</span>
<span class="n">l_map</span> <span class="o">=</span> <span class="n">fd_dims</span><span class="p">[[</span><span class="s1">&#39;loc_date&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;loc_date&#39;</span><span class="p">)</span>

<span class="c1"># map length and area from dims to survey data</span>
<span class="k">for</span> <span class="n">a_survey</span> <span class="ow">in</span> <span class="n">fd_dims</span><span class="o">.</span><span class="n">loc_date</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">a_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a_data</span><span class="o">.</span><span class="n">loc_date</span> <span class="o">==</span> <span class="n">a_survey</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l_map</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">a_survey</span><span class="p">],</span> <span class="s1">&#39;length&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">a_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a_data</span><span class="o">.</span><span class="n">loc_date</span> <span class="o">==</span> <span class="n">a_survey</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_map</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">a_survey</span><span class="p">],</span> <span class="s1">&#39;area&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># exclude surveys less 10 meters or less</span>
<span class="n">gten_lhun</span> <span class="o">=</span> <span class="n">a_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">a_data</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># this is a common aggregation</span>
<span class="n">agg_pcs_quantity</span> <span class="o">=</span> <span class="p">{</span><span class="n">unit_label</span><span class="p">:</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;quantity&#39;</span><span class="p">:</span><span class="s1">&#39;sum&#39;</span><span class="p">}</span>

<span class="c1"># survey totals by location</span>
<span class="n">dt_all</span> <span class="o">=</span> <span class="n">gten_lhun</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;loc_date&#39;</span><span class="p">,</span><span class="s1">&#39;location&#39;</span><span class="p">,</span><span class="s1">&#39;river_bassin&#39;</span><span class="p">,</span> <span class="s1">&#39;water_name_slug&#39;</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">agg_pcs_quantity</span><span class="p">)</span>

<span class="c1"># palettes and labels</span>
<span class="n">bassin_pallette</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rhone&#39;</span><span class="p">:</span><span class="s1">&#39;dimgray&#39;</span><span class="p">,</span> <span class="s1">&#39;aare&#39;</span><span class="p">:</span><span class="s1">&#39;salmon&#39;</span><span class="p">,</span> <span class="s1">&#39;linth&#39;</span><span class="p">:</span><span class="s1">&#39;tan&#39;</span><span class="p">,</span> <span class="s1">&#39;ticino&#39;</span><span class="p">:</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span> <span class="s1">&#39;reuss&#39;</span><span class="p">:</span><span class="s1">&#39;purple&#39;</span><span class="p">}</span>
<span class="n">comp_labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;linth&quot;</span><span class="p">:</span><span class="s2">&quot;Linth/Limmat&quot;</span><span class="p">,</span> <span class="s2">&quot;rhone&quot;</span><span class="p">:</span><span class="s2">&quot;Rhône&quot;</span><span class="p">,</span> <span class="s1">&#39;aare&#39;</span><span class="p">:</span><span class="s2">&quot;Aare&quot;</span><span class="p">,</span> <span class="s2">&quot;ticino&quot;</span><span class="p">:</span><span class="s2">&quot;Ticino/Cerisio&quot;</span><span class="p">,</span> <span class="s2">&quot;reuss&quot;</span><span class="p">:</span><span class="s2">&quot;Reuss&quot;</span><span class="p">}</span>
<span class="n">comp_palette</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Linth/Limmat&quot;</span><span class="p">:</span><span class="s2">&quot;dimgray&quot;</span><span class="p">,</span> <span class="s2">&quot;Rhône&quot;</span><span class="p">:</span><span class="s2">&quot;tan&quot;</span><span class="p">,</span> <span class="s2">&quot;Aare&quot;</span><span class="p">:</span><span class="s2">&quot;salmon&quot;</span><span class="p">,</span> <span class="s2">&quot;Ticino/Cerisio&quot;</span><span class="p">:</span><span class="s2">&quot;steelblue&quot;</span><span class="p">,</span> <span class="s2">&quot;Reuss&quot;</span><span class="p">:</span><span class="s2">&quot;purple&quot;</span><span class="p">}</span>

<span class="c1"># months locator, can be confusing</span>
<span class="c1"># https://matplotlib.org/stable/api/dates_api.html</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">MonthLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">months_fmt</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%b&#39;</span><span class="p">)</span>
<span class="n">days</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DayLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
<span class="n">axtwo</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:])</span>

<span class="c1"># scale the chart as needed to accomodate for extreme values</span>
<span class="n">scale_back</span> <span class="o">=</span> <span class="mi">98</span>

<span class="c1"># the results gets applied to the y_limit function in the chart</span>
<span class="n">the_90th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">dt_all</span><span class="p">[</span><span class="n">unit_label</span><span class="p">],</span> <span class="n">scale_back</span><span class="p">)</span>

<span class="c1"># the survey totals</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dt_all</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">unit_label</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;river_bassin&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">bassin_pallette</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># set params on ax:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">the_90th</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">unit_label</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">days</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">months_fmt</span><span class="p">)</span>
<span class="n">h</span><span class="p">,</span><span class="n">l</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>

<span class="c1"># axtwo</span>
<span class="n">a_color</span> <span class="o">=</span> <span class="s2">&quot;dodgerblue&quot;</span>

<span class="c1"># get the basic statistics from pd.describe</span>
<span class="n">cs</span> <span class="o">=</span> <span class="n">dt_all</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># change the names</span>
<span class="n">csx</span> <span class="o">=</span> <span class="n">sut</span><span class="o">.</span><span class="n">change_series_index_labels</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">featuredata</span><span class="o">.</span><span class="n">createSummaryTableIndex</span><span class="p">(</span><span class="n">unit_label</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s2">&quot;de&quot;</span><span class="p">))</span>
<span class="c1"># combined_summary = csx.apply(lambda x: featuredata.thousandsSeparator(int(x)))</span>


<span class="c1"># csx.loc[&quot;max p/100 m &quot;] = featuredata.thousandsSeparator(csx.loc[&quot;max p/100 m&quot;])</span>

<span class="n">combined_summary</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">featuredata</span><span class="o">.</span><span class="n">thousandsSeparator</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">csx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">])))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">csx</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

<span class="n">sut</span><span class="o">.</span><span class="n">hide_spines_ticks_grids</span><span class="p">(</span><span class="n">axtwo</span><span class="p">)</span>

<span class="n">a_table</span> <span class="o">=</span> <span class="n">sut</span><span class="o">.</span><span class="n">make_a_table</span><span class="p">(</span><span class="n">axtwo</span><span class="p">,</span> <span class="n">combined_summary</span><span class="p">,</span>  <span class="n">colLabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Stat&quot;</span><span class="p">,</span> <span class="n">unit_label</span><span class="p">],</span> <span class="n">colWidths</span><span class="o">=</span><span class="p">[</span><span class="mf">.6</span><span class="p">,</span><span class="mf">.4</span><span class="p">],</span> <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">a_table</span><span class="o">.</span><span class="n">get_celld</span><span class="p">()[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>

<span class="n">axtwo</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">figure_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;baseline_sample_totals&quot;</span>
<span class="n">sample_totals_file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">save_fig_prefix</span><span class="si">}{</span><span class="n">figure_name</span><span class="si">}</span><span class="s1">.jpeg&#39;</span>
<span class="n">save_figure_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;fname&quot;</span><span class="p">:</span><span class="n">sample_totals_file_name</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="o">**</span><span class="n">save_figure_kwargs</span><span class="p">)</span>

<span class="c1"># figure caption</span>
<span class="n">sample_total_notes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Erhebungsergebnisse und zusammenfassende Statistiken: &quot;</span><span class="p">,</span>
    <span class="s2">&quot;Proben grösser als 10m und ohne Objekte kleiner als 2,5cm und Chemikalien, n=372&quot;</span>
<span class="p">]</span>

<span class="n">sample_total_notes</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sample_total_notes</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;baseline_sample_total_notes&quot;</span><span class="p">,</span> <span class="n">sample_total_notes</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;baseline_sample_totals&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="figure align-default" id="baseline-sample-totals">
<img alt="_images/c9af2247f0d9e7fe3b356e57afaa9100b0d55f6d495bc5568207507d5f13b476.png" src="_images/c9af2247f0d9e7fe3b356e57afaa9100b0d55f6d495bc5568207507d5f13b476.png" />
<p class="caption"><span class="caption-number">Abb. 14.4 </span><span class="caption-text"><span class="pasted-text"> </span></span><a class="headerlink" href="#baseline-sample-totals" title="Link zu diesem Bild">#</a></p>
</div>
<p><a class="reference internal" href="#baseline-sample-totals"><span class="std std-numref">Abbildung 14.4:</span></a> <span class="pasted-text">Erhebungsergebnisse und zusammenfassende Statistiken: Proben grösser als 10m und ohne Objekte kleiner als 2,5cm und Chemikalien, n=372</span></p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># percentile rankings  1, 5, 10, 15, 20</span>
<span class="n">these_vals</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">.01</span><span class="p">,</span><span class="mf">.05</span><span class="p">,</span><span class="mf">.10</span><span class="p">,</span><span class="mf">.15</span><span class="p">,</span><span class="mf">.20</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.9</span> <span class="p">]:</span>
    <span class="n">a_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">dt_all</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">element</span><span class="p">)</span>
    <span class="n">these_vals</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">element</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span><span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">a_val</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="n">axtwo</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dt_all</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">unit_label</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dt_all</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Median&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dt_all</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Durchschnitt&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">sut</span><span class="o">.</span><span class="n">hide_spines_ticks_grids</span><span class="p">(</span><span class="n">axtwo</span><span class="p">)</span>


<span class="n">table_two</span> <span class="o">=</span> <span class="n">sut</span><span class="o">.</span><span class="n">make_a_table</span><span class="p">(</span><span class="n">axtwo</span><span class="p">,</span> <span class="n">these_vals</span><span class="p">,</span> <span class="n">colLabels</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ranking&#39;</span><span class="p">,</span> <span class="n">unit_label</span><span class="p">),</span> <span class="n">colWidths</span><span class="o">=</span><span class="p">[</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.5</span><span class="p">],</span> <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">table_two</span><span class="o">.</span><span class="n">get_celld</span><span class="p">()[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&quot;ranking&quot;</span><span class="p">)</span>
<span class="n">table_two</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>

<span class="n">axtwo</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">figure_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;empirical_dist_rankings_baseline&quot;</span>
<span class="n">empirical_dist_file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">save_fig_prefix</span><span class="si">}{</span><span class="n">figure_name</span><span class="si">}</span><span class="s1">.jpeg&#39;</span>
<span class="n">save_figure_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;fname&quot;</span><span class="p">:</span><span class="n">empirical_dist_file_name</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="o">**</span><span class="n">save_figure_kwargs</span><span class="p">)</span>

<span class="c1"># figure caption</span>
<span class="n">empirical_dist_notes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Verteilung der Datenerhebungen und Perzentilwerte: alle Erhebungen. Beachten Sie, dass der &quot;</span><span class="p">,</span>
    <span class="s2">&quot;Mittelwert (341p/100m) grösser ist als der Median (180p/100m).&quot;</span>
<span class="p">]</span>

<span class="n">empirical_dist_notes</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">empirical_dist_notes</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;empirical_dist_rankings_baseline_notes&quot;</span><span class="p">,</span> <span class="n">empirical_dist_notes</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;empirical_dist_rankings_baseline&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="figure align-default" id="empirical-dist-rankings-baseline">
<img alt="_images/840e3366a7774f32a5349cd7c061d529df2301078e36210383babad15dd7c1b7.png" src="_images/840e3366a7774f32a5349cd7c061d529df2301078e36210383babad15dd7c1b7.png" />
<p class="caption"><span class="caption-number">Abb. 14.5 </span><span class="caption-text"><span class="pasted-text"> </span></span><a class="headerlink" href="#empirical-dist-rankings-baseline" title="Link zu diesem Bild">#</a></p>
</div>
<p><a class="reference internal" href="#empirical-dist-rankings-baseline"><span class="std std-numref">Abbildung 14.5:</span></a> <span class="pasted-text">Verteilung der Datenerhebungen und Perzentilwerte: alle Erhebungen. Beachten Sie, dass der Mittelwert (341p/100m) grösser ist als der Median (180p/100m).</span></p>
</div>
<div class="section" id="die-bewertungsmetrik">
<h3><span class="section-number">14.2.2. </span>Die Bewertungsmetrik<a class="headerlink" href="#die-bewertungsmetrik" title="Link zu dieser Überschrift">#</a></h3>
<p>Die Berechnung von Basiswerten erfordert die Aggregation von Erhebungsergebnissen auf verschiedenen zeitlichen und geografischen Ebenen. Das ist die beste Methode:</p>
<ul class="simple">
<li><p>Robust in Bezug auf Ausreisser</p></li>
<li><p>Einfach zu berechnen</p></li>
<li><p>Weithin verstanden</p></li>
</ul>
<p>Die beiden gebräuchlichsten Teststatistiken, die zum Vergleich von Daten verwendet werden, sind der Mittelwert und der Median. Der Mittelwert ist der beste Prädiktor für die zentrale Tendenz, wenn die Daten ungefähr normal verteilt sind. Die Ergebnisse der Untersuchungen von Strand-Abfallaufkommen weisen jedoch eine hohe Varianz im Verhältnis zum Mittelwert auf. Es können Methoden auf die Daten angewendet werden, um die Auswirkungen der hohen Varianz bei der Berechnung des Mittelwerts zu verringern:</p>
<ol class="arabic simple">
<li><p><em>getrimmter Mittelwert:</em> entfernt einen kleinen, festgelegten Prozentsatz der grössten und kleinsten Werte, bevor der Mittelwert berechnet wird</p></li>
<li><p><em>tri-Mittelwert:</em> der gewichtete Durchschnitt des Medians und des oberen und unteren Quartils <span class="math notranslate nohighlight">\((Q1 + 2Q2 + Q3)/4\)</span></p></li>
<li><p><em>mittleres Scharnier:</em> <span class="math notranslate nohighlight">\((Q1 + Q3)/2\)</span></p></li>
</ol>
<p>Die bisherigen Methoden sind zwar wirksam, um die Auswirkungen von Ausreissern zu reduzieren, aber sie sind nicht so einfach zu berechnen wie der Mittelwert oder der Median, so dass die Signifikanz der Ergebnisse möglicherweise nicht richtig verstanden wird.</p>
<p>Der Median (50. Perzentil) ist ein ebenso guter Prädiktor für die zentrale Tendenz, wird aber im Vergleich zum Mittelwert viel weniger von Extremwerten beeinflusst. Je mehr sich ein Datensatz einer Normalverteilung nähert, desto näher kommen sich Median und Mittelwert. Der Median und die dazugehörigen Perzentil-Funktionen sind in den meisten Tabellenkalkulationsprogrammen verfügbar.</p>
<p>Aus den oben genannten Gründen wird der Medianwert einer Mindestanzahl von Proben, die während eines Probenahmezeitraums in einem Erhebungsgebiet gesammelt wurden, als statistisch geeignet für die Bewertung von Strand-Abfallobjekten angesehen. Für die Meeresumwelt beträgt die Mindestanzahl der Proben 40 pro Unterregion und der Probenahmezeitraum 6 Jahre. <span id="id7">[<a class="reference internal" href="references.html#id42" title="van Loon W. Hanke G., Walvoort D. Eu marine beach litter baselines. Publications Office of the European Union, 2019. doi:10.2760/16903.">HG19</a>]</span></p>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="konfidenzintervalle-kis">
<h3><span class="section-number">14.2.3. </span>Konfidenzintervalle (KIs)<a class="headerlink" href="#konfidenzintervalle-kis" title="Link zu dieser Überschrift">#</a></h3>
<p>Konfidenzintervalle (KIs) helfen dabei, die Unsicherheit der Ergebnisse von Strand-Abfallobjekten im Hinblick auf allgemeine Schlussfolgerungen über die Häufigkeit von Strand-Abfallobjekten in einer Region zu vermitteln. Das KI gibt den unteren und oberen Bereich der Schätzung der Teststatistik angesichts der Stichprobendaten an.</p>
<p>Der beste Weg, die Unsicherheit zu verringern, ist eine angemessene Anzahl von Proben für die Region oder das Gebiet von Interesse zu erheben. Strand-Abfallerhebungen weisen jedoch eine hohe Varianz auf und jede Schätzung eines Gesamtwerts sollte diese Varianz oder Unsicherheit widerspiegeln. kIs geben einen wahrscheinlichen Wertebereich angesichts der Unsicherheit/Varianz der Daten an.<span id="id8">[<a class="reference internal" href="references.html#id42" title="van Loon W. Hanke G., Walvoort D. Eu marine beach litter baselines. Publications Office of the European Union, 2019. doi:10.2760/16903.">HG19</a>]</span></p>
<p>Bei dieser Methode werden die Daten NICHT von den Basisberechnungen und Konfidenzintervallen ausgeschlossen.</p>
<blockquote>
<div><p>Man einigte sich darauf, die extremen Ergebnisse im Datensatz zu belassen, gleichzeitig aber die Notwendigkeit zu betonen, extreme Daten von Fall zu Fall zu überprüfen und den Median für die Berechnung von Durchschnittswerten zu verwenden. Auf diese Weise können alle Daten verwendet werden, ohne dass die Ergebnisse durch einzelne aussergewöhnlich hohe Abfallaufkommen verzerrt werden. <span id="id9">[<a class="reference internal" href="references.html#id44" title="Fleet D. Van Loon W., Hanke G. A european threshold value and assessment method for macro litter on coastlines. Publications Office of the European Union, 2020.">VLW20</a>]</span></p>
</div></blockquote>
<div class="section" id="bootstrap-methoden">
<h4><span class="section-number">14.2.3.1. </span>Bootstrap-Methoden:<a class="headerlink" href="#bootstrap-methoden" title="Link zu dieser Überschrift">#</a></h4>
<p>Bootstrapping ist eine Methode zur Wiederholung von Stichproben, bei der Zufallsstichproben mit Ersetzung verwendet werden, um den Stichprobenprozess zu wiederholen oder zu simulieren. Bootstrapping ermöglicht die Schätzung der Stichprobenverteilung von Stichprobenstatistiken unter Verwendung von Zufallsstichprobenverfahren. <span id="id10">[<a class="reference internal" href="references.html#id29" title="Wikepedia. Bootstrapping. URL: https://en.wikipedia.org/wiki/Bootstrapping_(statistics).">Wika</a>]</span> <span id="id11">[<a class="reference internal" href="references.html#id18" title="Kwanghee Jung, Jaehoon Lee, Vibhuti Gupta, and Gyeongcheol Cho. Comparison of bootstrap confidence interval methods for gsca using a monte carlo simulation. Frontiers in Psychology, 10:2215, 2019. URL: https://www.frontiersin.org/article/10.3389/fpsyg.2019.02215, doi:10.3389/fpsyg.2019.02215.">JLGC19</a>]</span> <span id="id12">[<a class="reference internal" href="references.html#id26" title="Stackexchange. Is it true that the percentile bootstrap should never be used? 2021. URL: https://stats.stackexchange.com/questions/355781/is-it-true-that-the-percentile-bootstrap-should-never-be-used.">Sta21b</a>]</span></p>
<p>Bootstrap-Methoden werden verwendet, um das KI der Teststatistiken zu berechnen, indem der Stichprobenprozess wiederholt wird und der Median bei jeder Wiederholung ausgewertet wird. Der Wertebereich, der durch die mittleren 95 % der Bootstrap-Ergebnisse beschrieben wird, ist das KI für die beobachtete Teststatistik.</p>
<p>Es stehen mehrere Berechnungsmethoden zur Auswahl, z. B. Perzentil, BCa und Student’s t. Für dieses Beispiel wurden zwei Methoden getestet:</p>
<ol class="arabic simple">
<li><p>Perzentil-Bootstrap</p></li>
<li><p>Bias-korrigiertes beschleunigtes Bootstrap-Konfidenzintervall (BCa)</p></li>
</ol>
<p>Die Perzentil-Methode berücksichtigt nicht die Form der zugrundeliegenden Verteilung, was zu Konfidenzintervallen führen kann, die nicht mit den Daten übereinstimmen. Die Bca-Methode korrigiert dies. Die Implementierung dieser Methoden ist mit den bereits zitierten Paketen einfach zu bewerkstelligen. <span id="id13">[<a class="reference internal" href="references.html#id27" title="Bradley Efron. Better bootstrap confidence intervals. Journal of the American Statistical Association, 82(397):171-185, 1987. URL: https://www.tandfonline.com/doi/abs/10.1080/01621459.1987.10478410, arXiv:https://www.tandfonline.com/doi/pdf/10.1080/01621459.1987.10478410, doi:10.1080/01621459.1987.10478410.">Efr87</a>]</span> <span id="id14">[<a class="reference internal" href="references.html#id28" title="Erik drysdale. Implementing the bias-corrected and accelerated bootstrap in python. 2020. URL: https://www.erikdrysdale.com/bca_python/.">dry20</a>]</span> <span id="id15">[<a class="reference internal" href="references.html#id31" title="Justin Bois. Introduction to data analysis in the biological sciences. 2019. URL: http://bebi103.caltech.edu.s3-website-us-east-1.amazonaws.com/2019a/content/index.html#.">Boi19</a>]</span></p>
</div>
</div>
<div class="section" id="vergleich-der-bootstrap-kis">
<h3><span class="section-number">14.2.4. </span>Vergleich der Bootstrap-KIs<a class="headerlink" href="#vergleich-der-bootstrap-kis" title="Link zu dieser Überschrift">#</a></h3>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this code was modified from this source:</span>
<span class="c1"># http://bebi103.caltech.edu.s3-website-us-east-1.amazonaws.com/2019a/content/recitations/bootstrapping.html</span>
<span class="c1"># if you want to get the confidence interval around another point estimate use np.percentile</span>
<span class="c1"># and add the percentile value as a parameter</span>

<span class="k">def</span> <span class="nf">draw_bs_sample</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draw a bootstrap sample from a 1D data set.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">compute_jackknife_reps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">statfunction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stat_param</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Returns jackknife resampled replicates for the given data and statistical function&#39;&#39;&#39;</span>
    <span class="c1"># Set up empty array to store jackknife replicates</span>
    <span class="n">jack_reps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

    <span class="c1"># For each observation in the dataset, compute the statistical function on the sample</span>
    <span class="c1"># with that observation removed</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="n">jack_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">stat_param</span><span class="p">:</span>
            <span class="n">jack_reps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">statfunction</span><span class="p">(</span><span class="n">jack_sample</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">jack_reps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">statfunction</span><span class="p">(</span><span class="n">jack_sample</span><span class="p">,</span> <span class="n">stat_param</span><span class="p">)</span>          
        
    <span class="k">return</span> <span class="n">jack_reps</span>


<span class="k">def</span> <span class="nf">compute_a</span><span class="p">(</span><span class="n">jack_reps</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Returns the acceleration constant a&#39;&#39;&#39;</span>

    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">jack_reps</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">x</span><span class="o">**-</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span> <span class="p">(</span><span class="n">mean</span><span class="o">**-</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">**</span><span class="mi">3</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">jack_reps</span><span class="p">)])</span>
        <span class="n">b</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">x</span><span class="o">**-</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">mean</span><span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">jack_reps</span><span class="p">)])</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">c</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>


<span class="k">def</span> <span class="nf">bootstrap_replicates</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n_reps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">statfunction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stat_param</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Computes n_reps number of bootstrap replicates for given data and statistical function&#39;&#39;&#39;</span>
    <span class="n">boot_reps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">n_reps</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_reps</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">stat_param</span><span class="p">:</span>
            <span class="n">boot_reps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">statfunction</span><span class="p">(</span><span class="n">draw_bs_sample</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">boot_reps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">statfunction</span><span class="p">(</span><span class="n">draw_bs_sample</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">stat_param</span><span class="p">)</span>     
        
    <span class="k">return</span> <span class="n">boot_reps</span>


<span class="k">def</span> <span class="nf">compute_z0</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">boot_reps</span><span class="p">,</span> <span class="n">statfunction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stat_param</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Computes z0 for given data and statistical function&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">stat_param</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">statfunction</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">statfunction</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">stat_param</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">boot_reps</span> <span class="o">&lt;</span> <span class="n">s</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">boot_reps</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">compute_bca_ci</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">alpha_level</span><span class="p">,</span> <span class="n">n_reps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">statfunction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stat_param</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Returns BCa confidence interval for given data at given alpha level&#39;&#39;&#39;</span>
    <span class="c1"># Compute bootstrap and jackknife replicates</span>
    <span class="n">boot_reps</span> <span class="o">=</span> <span class="n">bootstrap_replicates</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n_reps</span><span class="p">,</span> <span class="n">statfunction</span><span class="o">=</span><span class="n">statfunction</span><span class="p">,</span> <span class="n">stat_param</span><span class="o">=</span><span class="n">stat_param</span><span class="p">)</span>
    <span class="n">jack_reps</span> <span class="o">=</span> <span class="n">compute_jackknife_reps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">statfunction</span><span class="o">=</span><span class="n">statfunction</span><span class="p">,</span> <span class="n">stat_param</span><span class="o">=</span><span class="n">stat_param</span><span class="p">)</span>

    <span class="c1"># Compute a and z0</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">compute_a</span><span class="p">(</span><span class="n">jack_reps</span><span class="p">)</span>
    <span class="n">z0</span> <span class="o">=</span> <span class="n">compute_z0</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">boot_reps</span><span class="p">,</span> <span class="n">statfunction</span><span class="o">=</span><span class="n">statfunction</span><span class="p">,</span> <span class="n">stat_param</span><span class="o">=</span><span class="n">stat_param</span><span class="p">)</span>

    <span class="c1"># Compute confidence interval indices</span>
    <span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">alpha_level</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">alpha_level</span><span class="o">/</span><span class="mf">2.</span><span class="p">])</span>
    <span class="n">zs</span> <span class="o">=</span> <span class="n">z0</span> <span class="o">+</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alphas</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">shape</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="p">,)</span><span class="o">*</span><span class="n">z0</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
    <span class="n">avals</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z0</span> <span class="o">+</span> <span class="n">zs</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">zs</span><span class="p">))</span>
    <span class="n">ints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">boot_reps</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">avals</span><span class="p">)</span>
    <span class="n">ints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">ints</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>

    <span class="c1"># Compute confidence interval</span>
    <span class="n">boot_reps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">boot_reps</span><span class="p">)</span>
    <span class="n">ci_low</span> <span class="o">=</span> <span class="n">boot_reps</span><span class="p">[</span><span class="n">ints</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">ci_high</span> <span class="o">=</span> <span class="n">boot_reps</span><span class="p">[</span><span class="n">ints</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ci_low</span><span class="p">,</span> <span class="n">ci_high</span><span class="p">)</span>

<span class="n">quantiles</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.2</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.9</span><span class="p">]</span>
<span class="n">q_vals</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span><span class="n">dt_all</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">quantiles</span><span class="p">}</span>

<span class="n">the_bcas</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">a_rank</span> <span class="ow">in</span> <span class="n">quantiles</span><span class="p">:</span>
    <span class="n">an_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">a_rank</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">a_result</span> <span class="o">=</span> <span class="n">compute_bca_ci</span><span class="p">(</span><span class="n">dt_all</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="mf">.05</span><span class="p">,</span> <span class="n">n_reps</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">statfunction</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">,</span> <span class="n">stat_param</span><span class="o">=</span><span class="n">an_int</span><span class="p">)</span>
    <span class="n">observed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">dt_all</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">an_int</span><span class="p">)</span>
    <span class="n">the_bcas</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">a_rank</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:{</span><span class="s1">&#39;2.5</span><span class="si">% c</span><span class="s1">i&#39;</span><span class="p">:</span><span class="n">a_result</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Beobachtung&quot;</span><span class="p">:</span> <span class="n">observed</span><span class="p">,</span> <span class="s1">&#39;97.5</span><span class="si">% c</span><span class="s1">i&#39;</span><span class="p">:</span> <span class="n">a_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]}})</span>


<span class="n">bca_cis</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">the_bcas</span><span class="p">)</span>
<span class="n">bca_cis</span><span class="p">[[</span><span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="s1">&#39;50&#39;</span><span class="p">,</span> <span class="s1">&#39;90&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">bca_cis</span><span class="p">[[</span><span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="s1">&#39;50&#39;</span><span class="p">,</span> <span class="s1">&#39;90&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
<span class="n">bca_cis</span><span class="p">[</span><span class="s1">&#39;b-method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;BCa&#39;</span>
<span class="n">bca_d</span> <span class="o">=</span> <span class="n">bca_cis</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">bca_d</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;b-method&quot;</span><span class="p">:</span><span class="s2">&quot;Methode&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">styled_table_bca</span> <span class="o">=</span> <span class="n">bca_d</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">(</span><span class="n">table_css_styles</span><span class="p">)</span>
<span class="n">bcas</span> <span class="o">=</span> <span class="n">bca_cis</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># bcas[[&#39;10&#39;, &#39;20&#39;, &#39;50&#39;, &#39;90&#39;]] = bcas[[&#39;10&#39;, &#39;20&#39;, &#39;50&#39;, &#39;90&#39;]].astype(&#39;int&#39;)</span>
<span class="c1"># bcas[&#39;b-method&#39;] = &#39;BCa&#39;</span>

<span class="c1"># bootstrap percentile confidence intervals</span>
<span class="c1"># resample the survey totals for n times to help</span>
<span class="c1"># define the range of the sampling statistic</span>
<span class="c1"># the number of reps</span>
<span class="n">n</span><span class="o">=</span><span class="mi">5000</span>

<span class="c1"># keep the observed values</span>
<span class="n">observed_median</span> <span class="o">=</span> <span class="n">dt_all</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">observed_tenth</span> <span class="o">=</span> <span class="n">dt_all</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">.15</span><span class="p">)</span>

<span class="n">the_cis</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">a_rank</span> <span class="ow">in</span> <span class="n">quantiles</span><span class="p">:</span>
    <span class="c1"># for the median</span>
    <span class="n">sim_ptile</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># for the tenth percentile</span>
    <span class="n">sim_ten</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">less</span> <span class="o">=</span> <span class="n">dt_all</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dt_all</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    
        <span class="n">a_ptile</span> <span class="o">=</span> <span class="n">less</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">a_rank</span><span class="p">)</span>
        <span class="n">sim_ptile</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a_ptile</span><span class="p">)</span>
    <span class="c1"># get the upper and lower range of the test statistic disrtribution:</span>
    <span class="n">a_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">sim_ptile</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
    <span class="n">a_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">sim_ptile</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">)</span>
    
    <span class="c1"># add the observed value and update the dict</span>
    <span class="n">the_cis</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">a_rank</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:{</span><span class="s1">&#39;2.5</span><span class="si">% c</span><span class="s1">i&#39;</span><span class="p">:</span><span class="n">a_min</span><span class="p">,</span> <span class="s2">&quot;Beobachtung&quot;</span><span class="p">:</span> <span class="n">q_vals</span><span class="p">[</span><span class="n">a_rank</span><span class="p">],</span> <span class="s1">&#39;97.5</span><span class="si">% c</span><span class="s1">i&#39;</span><span class="p">:</span> <span class="n">a_max</span><span class="p">}})</span>

<span class="c1"># make df</span>
<span class="n">p_cis</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">the_cis</span><span class="p">)</span>
<span class="n">p_cis</span> <span class="o">=</span> <span class="n">p_cis</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
<span class="n">p_cis</span><span class="p">[</span><span class="s1">&#39;b-method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;%&#39;</span>
<span class="n">p_cd</span> <span class="o">=</span> <span class="n">p_cis</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">p_cd</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;b-method&quot;</span><span class="p">:</span><span class="s2">&quot;Methode&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">styled_table</span> <span class="o">=</span> <span class="n">p_cd</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">(</span><span class="n">table_css_styles</span><span class="p">)</span>
<span class="n">p_cis</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>




<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">axone</span> <span class="o">=</span> <span class="n">axs</span>


<span class="n">data</span> <span class="o">=</span> <span class="n">p_cis</span><span class="o">.</span><span class="n">values</span>
<span class="n">sut</span><span class="o">.</span><span class="n">hide_spines_ticks_grids</span><span class="p">(</span><span class="n">axone</span><span class="p">)</span>

<span class="n">colLabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">.&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">p_cis</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">colLabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Methode&#39;</span><span class="p">)</span>

<span class="n">table_one</span> <span class="o">=</span> <span class="n">sut</span><span class="o">.</span><span class="n">make_a_table</span><span class="p">(</span><span class="n">axone</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">colLabels</span><span class="o">=</span><span class="n">colLabels</span><span class="p">,</span> <span class="n">colWidths</span><span class="o">=</span><span class="p">[</span><span class="mf">.25</span><span class="p">,</span><span class="o">*</span><span class="p">[</span><span class="mf">.15</span><span class="p">]</span><span class="o">*</span><span class="mi">5</span><span class="p">],</span> <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>


<span class="n">table_one</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

                        
<span class="n">table_one</span><span class="o">.</span><span class="n">get_celld</span><span class="p">()[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&quot;Perzentile&quot;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">figure_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ci_percentile_bootstrap&quot;</span>
<span class="n">ci_percentile_bootstrap_file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">save_fig_prefix</span><span class="si">}{</span><span class="n">figure_name</span><span class="si">}</span><span class="s1">.jpeg&#39;</span>
<span class="n">save_figure_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;fname&quot;</span><span class="p">:</span><span class="n">ci_percentile_bootstrap_file_name</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="o">**</span><span class="n">save_figure_kwargs</span><span class="p">)</span>

<span class="c1"># figure caption</span>
<span class="n">ci_percentile_bootstrap_notes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Konfidenzintervalle, die durch eine 5.000-fache Wiederholungsstichprobe der &quot;</span><span class="p">,</span>
    <span class="s2">&quot;Umfrageergebnisse für jede Bedingung berechnet wurden&quot;</span>
<span class="p">]</span>

<span class="n">ci_percentile_bootstrap_notes</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ci_percentile_bootstrap_notes</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;ci_percentile_bootstrap_notes&quot;</span><span class="p">,</span> <span class="n">ci_percentile_bootstrap_notes</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;ci_percentile_bootstrap&quot;</span><span class="p">,</span> <span class="n">styled_table</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="figure align-default" id="ci-percentile-bootstrap">
<div class="output text_html"><style type="text/css">
#T_f0087 tr:nth-child(even) {
  background-color: rgba(139, 69, 19, 0.08);
}
#T_f0087 tr:nth-child(odd) {
  background: #FFF;
}
#T_f0087 tr {
  font-size: 20px;
}
#T_f0087 th:nth-child(1) {
  background-color: #FFF;
  font-size: 20px;
  text-align: left;
}
#T_f0087 td {
  padding: 6px;
}
</style>
<table id="T_f0087">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_f0087_level0_col0" class="col_heading level0 col0" >10</th>
      <th id="T_f0087_level0_col1" class="col_heading level0 col1" >20</th>
      <th id="T_f0087_level0_col2" class="col_heading level0 col2" >50</th>
      <th id="T_f0087_level0_col3" class="col_heading level0 col3" >90</th>
      <th id="T_f0087_level0_col4" class="col_heading level0 col4" >Methode</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_f0087_level0_row0" class="row_heading level0 row0" >2.5% ci</th>
      <td id="T_f0087_row0_col0" class="data row0 col0" >29</td>
      <td id="T_f0087_row0_col1" class="data row0 col1" >48</td>
      <td id="T_f0087_row0_col2" class="data row0 col2" >147</td>
      <td id="T_f0087_row0_col3" class="data row0 col3" >598</td>
      <td id="T_f0087_row0_col4" class="data row0 col4" >%</td>
    </tr>
    <tr>
      <th id="T_f0087_level0_row1" class="row_heading level0 row1" >Beobachtung</th>
      <td id="T_f0087_row1_col0" class="data row1 col0" >36</td>
      <td id="T_f0087_row1_col1" class="data row1 col1" >64</td>
      <td id="T_f0087_row1_col2" class="data row1 col2" >180</td>
      <td id="T_f0087_row1_col3" class="data row1 col3" >727</td>
      <td id="T_f0087_row1_col4" class="data row1 col4" >%</td>
    </tr>
    <tr>
      <th id="T_f0087_level0_row2" class="row_heading level0 row2" >97.5% ci</th>
      <td id="T_f0087_row2_col0" class="data row2 col0" >43</td>
      <td id="T_f0087_row2_col1" class="data row2 col1" >81</td>
      <td id="T_f0087_row2_col2" class="data row2 col2" >213</td>
      <td id="T_f0087_row2_col3" class="data row2 col3" >909</td>
      <td id="T_f0087_row2_col4" class="data row2 col4" >%</td>
    </tr>
  </tbody>
</table>
</div><p class="caption"><span class="caption-number">Abb. 14.6 </span><span class="caption-text"><span class="pasted-text"> </span></span><a class="headerlink" href="#ci-percentile-bootstrap" title="Link zu diesem Bild">#</a></p>
</div>
<p><a class="reference internal" href="#ci-percentile-bootstrap"><span class="std std-numref">Abbildung 14.6:</span></a> <span class="pasted-text">Konfidenzintervalle, die durch eine 5.000-fache Wiederholungsstichprobe der Umfrageergebnisse für jede Bedingung berechnet wurden</span></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">axtwo</span> <span class="o">=</span> <span class="n">axs</span>
<span class="c1"># styled_table = bcas.style.set_table_styles(table_css_styles)</span>
<span class="c1"># data = p_cis.values</span>
<span class="n">sut</span><span class="o">.</span><span class="n">hide_spines_ticks_grids</span><span class="p">(</span><span class="n">axtwo</span><span class="p">)</span>
<span class="n">colLabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">.&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">p_cis</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">colLabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Methode&#39;</span><span class="p">)</span>

<span class="n">table_two</span> <span class="o">=</span> <span class="n">sut</span><span class="o">.</span><span class="n">make_a_table</span><span class="p">(</span><span class="n">axtwo</span><span class="p">,</span> <span class="n">bcas</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">colLabels</span><span class="o">=</span><span class="n">colLabels</span><span class="p">,</span> <span class="n">colWidths</span><span class="o">=</span><span class="p">[</span><span class="mf">.25</span><span class="p">,</span><span class="o">*</span><span class="p">[</span><span class="mf">.15</span><span class="p">]</span><span class="o">*</span><span class="mi">5</span><span class="p">],</span> <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">table_two</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>    
                        
<span class="n">table_two</span><span class="o">.</span><span class="n">get_celld</span><span class="p">()[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&quot;BCa&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">figure_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;bca_bootstrap&quot;</span>
<span class="n">bca_bootstrap_file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">save_fig_prefix</span><span class="si">}{</span><span class="n">figure_name</span><span class="si">}</span><span class="s1">.jpeg&#39;</span>
<span class="n">save_figure_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;fname&quot;</span><span class="p">:</span><span class="n">bca_bootstrap_file_name</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="o">**</span><span class="n">save_figure_kwargs</span><span class="p">)</span>

<span class="c1"># figure caption</span>
<span class="n">bca_bootstrap_notes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Die gleichen Intervalle unter Verwendung der verzerrungskorrigierten Methode.&quot;</span>
<span class="p">]</span>

<span class="n">bca_bootstrap_notes</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bca_bootstrap_notes</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;bca_bootstrap_notes&quot;</span><span class="p">,</span> <span class="n">bca_bootstrap_notes</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;bca_bootstrap&quot;</span><span class="p">,</span> <span class="n">styled_table_bca</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="figure align-default" id="bca-bootstrap">
<div class="output text_html"><style type="text/css">
#T_8b88d tr:nth-child(even) {
  background-color: rgba(139, 69, 19, 0.08);
}
#T_8b88d tr:nth-child(odd) {
  background: #FFF;
}
#T_8b88d tr {
  font-size: 20px;
}
#T_8b88d th:nth-child(1) {
  background-color: #FFF;
  font-size: 20px;
  text-align: left;
}
#T_8b88d td {
  padding: 6px;
}
</style>
<table id="T_8b88d">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_8b88d_level0_col0" class="col_heading level0 col0" >10</th>
      <th id="T_8b88d_level0_col1" class="col_heading level0 col1" >20</th>
      <th id="T_8b88d_level0_col2" class="col_heading level0 col2" >50</th>
      <th id="T_8b88d_level0_col3" class="col_heading level0 col3" >90</th>
      <th id="T_8b88d_level0_col4" class="col_heading level0 col4" >Methode</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_8b88d_level0_row0" class="row_heading level0 row0" >2.5% ci</th>
      <td id="T_8b88d_row0_col0" class="data row0 col0" >28</td>
      <td id="T_8b88d_row0_col1" class="data row0 col1" >48</td>
      <td id="T_8b88d_row0_col2" class="data row0 col2" >147</td>
      <td id="T_8b88d_row0_col3" class="data row0 col3" >596</td>
      <td id="T_8b88d_row0_col4" class="data row0 col4" >BCa</td>
    </tr>
    <tr>
      <th id="T_8b88d_level0_row1" class="row_heading level0 row1" >Beobachtung</th>
      <td id="T_8b88d_row1_col0" class="data row1 col0" >36</td>
      <td id="T_8b88d_row1_col1" class="data row1 col1" >64</td>
      <td id="T_8b88d_row1_col2" class="data row1 col2" >180</td>
      <td id="T_8b88d_row1_col3" class="data row1 col3" >727</td>
      <td id="T_8b88d_row1_col4" class="data row1 col4" >BCa</td>
    </tr>
    <tr>
      <th id="T_8b88d_level0_row2" class="row_heading level0 row2" >97.5% ci</th>
      <td id="T_8b88d_row2_col0" class="data row2 col0" >42</td>
      <td id="T_8b88d_row2_col1" class="data row2 col1" >78</td>
      <td id="T_8b88d_row2_col2" class="data row2 col2" >213</td>
      <td id="T_8b88d_row2_col3" class="data row2 col3" >909</td>
      <td id="T_8b88d_row2_col4" class="data row2 col4" >BCa</td>
    </tr>
  </tbody>
</table>
</div><p class="caption"><span class="caption-number">Abb. 14.7 </span><span class="caption-text"><span class="pasted-text"> </span></span><a class="headerlink" href="#bca-bootstrap" title="Link zu diesem Bild">#</a></p>
</div>
<p><a class="reference internal" href="#bca-bootstrap"><span class="std std-numref">Abbildung 14.7:</span></a> <span class="pasted-text">Die gleichen Intervalle unter Verwendung der verzerrungskorrigierten Methode.</span></p>
<div class="figure align-default" id="mullermatte-bielersee31-01-2021">
<img alt="_images/mullermatte_bielersee31_01_2021.png" src="_images/mullermatte_bielersee31_01_2021.png" />
<p class="caption"><span class="caption-number">Abb. 14.8 </span><span class="caption-text"><span class="pasted-text"> </span></span><a class="headerlink" href="#mullermatte-bielersee31-01-2021" title="Link zu diesem Bild">#</a></p>
</div>
<p><a class="reference internal" href="#mullermatte-bielersee31-01-2021"><span class="std std-numref">Abbildung 14.8:</span></a> Beispiel für das Konfidenzintervall: Das Ergebnis der Datenerhebungen in Biel am 31.01.2021 war grösser als der Medianwert für alle Datenerhebungen. Es wurden 123 Objekte (p) über 40 Meter (m) Uferlinie gesammelt. Zunächst wird der Wert der Datenerhebungen in Abfallobjekte pro Meter (p/m) umgerechnet und dann mit der erforderlichen Anzahl von Metern (100) multipliziert: <span class="math notranslate nohighlight">\((pcs/m)*100 = (123_{pcs} / 40_m)*100 m \approxeq \text{313 p/100 m}\)</span></p>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="basiswerte">
<h3><span class="section-number">14.2.5. </span>Basiswerte<a class="headerlink" href="#basiswerte" title="Link zu dieser Überschrift">#</a></h3>
<p>Für diesen Datensatz sind die Unterschiede zwischen den mit der Bca-Methode oder der Perzentilmethode berechneten KIs minimal. Die Bca-Methode wird verwendet, um die Basiswerte und KIs anzugeben.</p>
<div class="section" id="basismedianwert-aller-erhebungsergebnisse">
<h4><span class="section-number">14.2.5.1. </span>Basismedianwert aller Erhebungsergebnisse<a class="headerlink" href="#basismedianwert-aller-erhebungsergebnisse" title="Link zu dieser Überschrift">#</a></h4>
<p>Wenn man nur Datenerhebungen mit einer Länge von mehr als 10 Metern berücksichtigt und Objekte mit einer Grösse von weniger als 2,5 cm ausschliesst, <strong>lag der Medianwert aller Daten bei 181 p/100 m mit einem KI von 147 p/100 m – 213 p/100 m. Der gemeldete Medianwert für die EU lag bei 133 p/100 m</strong> und damit im Bereich des KI der IQAASL-Erhebungsergebnisse. Während der Medianwert in der Schweiz höher ist, liegt der Mittelwert der EU-Studie bei 504 p/100 m gegenüber 341 p/100 m in der Schweiz.<span id="id16">[<a class="reference internal" href="references.html#id42" title="van Loon W. Hanke G., Walvoort D. Eu marine beach litter baselines. Publications Office of the European Union, 2019. doi:10.2760/16903.">HG19</a>]</span></p>
<p>Das deutet darauf hin, dass die höheren Extremwerte in der Meeresumwelt wahrscheinlicher waren, aber der erwartete Medianwert beider Datensätze ist ähnlich.</p>
</div>
<div class="section" id="median-basislinie-und-ki-pro-erhebungsgebiet">
<h4><span class="section-number">14.2.5.2. </span>Median-Basislinie und KI pro Erhebungsgebiet<a class="headerlink" href="#median-basislinie-und-ki-pro-erhebungsgebiet" title="Link zu dieser Überschrift">#</a></h4>
<p>In der vorliegenden Studie wurden in drei von vier Erhebungsgebieten mehr als 40 Erhebungen durchgeführt.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bassins</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;linth&quot;</span><span class="p">,</span> <span class="s2">&quot;aare&quot;</span><span class="p">,</span> <span class="s2">&quot;rhone&quot;</span><span class="p">]</span>
<span class="n">the_sas</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">a_bassin</span> <span class="ow">in</span> <span class="n">bassins</span><span class="p">:</span>
    <span class="n">an_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">a_rank</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">a_result</span> <span class="o">=</span> <span class="n">compute_bca_ci</span><span class="p">(</span><span class="n">dt_all</span><span class="p">[</span><span class="n">dt_all</span><span class="o">.</span><span class="n">river_bassin</span> <span class="o">==</span> <span class="n">a_bassin</span><span class="p">][</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="mf">.05</span><span class="p">,</span> <span class="n">n_reps</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">statfunction</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">,</span> <span class="n">stat_param</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">observed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">dt_all</span><span class="p">[</span><span class="n">dt_all</span><span class="o">.</span><span class="n">river_bassin</span> <span class="o">==</span> <span class="n">a_bassin</span><span class="p">][</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">the_sas</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">a_bassin</span><span class="p">:{</span><span class="s1">&#39;2.5</span><span class="si">% c</span><span class="s1">i&#39;</span><span class="p">:</span><span class="n">a_result</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Beobachtung&quot;</span><span class="p">:</span> <span class="n">observed</span><span class="p">,</span> <span class="s1">&#39;97.5</span><span class="si">% c</span><span class="s1">i&#39;</span><span class="p">:</span> <span class="n">a_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]}})</span>

<span class="n">sas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">the_sas</span><span class="p">)</span>

<span class="n">new_colnames</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;linth&quot;</span><span class="p">:</span><span class="s2">&quot;Linth&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rhone&quot;</span><span class="p">:</span> <span class="s2">&quot;Rhône&quot;</span><span class="p">,</span>
    <span class="s2">&quot;aare&quot;</span><span class="p">:</span><span class="s2">&quot;Aare&quot;</span><span class="p">,</span>
    <span class="s2">&quot;b-method&quot;</span><span class="p">:</span> <span class="s2">&quot;Methode&quot;</span>
<span class="p">}</span>
<span class="n">sas</span><span class="p">[</span><span class="s1">&#39;b-method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bca&#39;</span>
<span class="n">sas</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">new_colnames</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">sas</span><span class="p">[</span><span class="s2">&quot;Linth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sas</span><span class="p">[</span><span class="s2">&quot;Linth&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">featuredata</span><span class="o">.</span><span class="n">thousandsSeparator</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="n">sas</span><span class="p">[</span><span class="s2">&quot;Aare&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sas</span><span class="p">[</span><span class="s2">&quot;Aare&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">featuredata</span><span class="o">.</span><span class="n">thousandsSeparator</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="n">sas</span><span class="p">[</span><span class="s2">&quot;Rhône&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sas</span><span class="p">[</span><span class="s2">&quot;Rhône&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">featuredata</span><span class="o">.</span><span class="n">thousandsSeparator</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="n">sas_d</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  
<span class="n">styled_table</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">(</span><span class="n">table_css_styles</span><span class="p">)</span>
<span class="n">sas</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">values</span>
<span class="n">sut</span><span class="o">.</span><span class="n">hide_spines_ticks_grids</span><span class="p">(</span><span class="n">axs</span><span class="p">)</span>

<span class="n">table_one</span> <span class="o">=</span> <span class="n">sut</span><span class="o">.</span><span class="n">make_a_table</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">colLabels</span><span class="o">=</span><span class="n">sas</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">colWidths</span><span class="o">=</span><span class="p">[</span><span class="mf">.25</span><span class="p">,</span><span class="o">*</span><span class="p">[</span><span class="mf">.15</span><span class="p">]</span><span class="o">*</span><span class="mi">5</span><span class="p">],</span> <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">table_one</span><span class="o">.</span><span class="n">get_celld</span><span class="p">()[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>

<span class="n">figure_name</span> <span class="o">=</span> <span class="s2">&quot;ci_survey_area&quot;</span>
<span class="n">ci_survey_area_file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">save_fig_prefix</span><span class="si">}{</span><span class="n">figure_name</span><span class="si">}</span><span class="s1">.jpeg&#39;</span>
<span class="n">save_figure_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;fname&quot;</span><span class="p">:</span><span class="n">ci_survey_area_file_name</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="o">**</span><span class="n">save_figure_kwargs</span><span class="p">)</span>

<span class="c1"># figure caption</span>
<span class="n">ci_survey_area_notes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Der Median und das 95-Prozent-Konfidenzintervall der Erhebungsgebiete Linth, Aare &quot;</span><span class="p">,</span>
    <span class="s2">&quot;und Rhône. Das Erhebungsgebiet Tessin ist mangels ausreichender Anzahl von Datenerhebungen &quot;</span><span class="p">,</span>
    <span class="s2">&quot;nicht enthalten.&quot;</span>
<span class="p">]</span>

<span class="n">ci_survey_area_notes</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ci_survey_area_notes</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;ci_survey_area_notes&quot;</span><span class="p">,</span> <span class="n">ci_survey_area_notes</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;ci_survey_area&quot;</span><span class="p">,</span> <span class="n">styled_table</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="figure align-default" id="ci-survey-area">
<div class="output text_html"><style type="text/css">
#T_b93bb tr:nth-child(even) {
  background-color: rgba(139, 69, 19, 0.08);
}
#T_b93bb tr:nth-child(odd) {
  background: #FFF;
}
#T_b93bb tr {
  font-size: 20px;
}
#T_b93bb th:nth-child(1) {
  background-color: #FFF;
  font-size: 20px;
  text-align: left;
}
#T_b93bb td {
  padding: 6px;
}
</style>
<table id="T_b93bb">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_b93bb_level0_col0" class="col_heading level0 col0" >Linth</th>
      <th id="T_b93bb_level0_col1" class="col_heading level0 col1" >Aare</th>
      <th id="T_b93bb_level0_col2" class="col_heading level0 col2" >Rhône</th>
      <th id="T_b93bb_level0_col3" class="col_heading level0 col3" >Methode</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_b93bb_level0_row0" class="row_heading level0 row0" >2.5% ci</th>
      <td id="T_b93bb_row0_col0" class="data row0 col0" >99</td>
      <td id="T_b93bb_row0_col1" class="data row0 col1" >102</td>
      <td id="T_b93bb_row0_col2" class="data row0 col2" >264</td>
      <td id="T_b93bb_row0_col3" class="data row0 col3" >bca</td>
    </tr>
    <tr>
      <th id="T_b93bb_level0_row1" class="row_heading level0 row1" >Beobachtung</th>
      <td id="T_b93bb_row1_col0" class="data row1 col0" >127</td>
      <td id="T_b93bb_row1_col1" class="data row1 col1" >140</td>
      <td id="T_b93bb_row1_col2" class="data row1 col2" >396</td>
      <td id="T_b93bb_row1_col3" class="data row1 col3" >bca</td>
    </tr>
    <tr>
      <th id="T_b93bb_level0_row2" class="row_heading level0 row2" >97.5% ci</th>
      <td id="T_b93bb_row2_col0" class="data row2 col0" >152</td>
      <td id="T_b93bb_row2_col1" class="data row2 col1" >169</td>
      <td id="T_b93bb_row2_col2" class="data row2 col2" >467</td>
      <td id="T_b93bb_row2_col3" class="data row2 col3" >bca</td>
    </tr>
  </tbody>
</table>
</div><p class="caption"><span class="caption-number">Abb. 14.9 </span><span class="caption-text"><span class="pasted-text"> </span></span><a class="headerlink" href="#ci-survey-area" title="Link zu diesem Bild">#</a></p>
</div>
<p><a class="reference internal" href="#ci-survey-area"><span class="std std-numref">Abbildung 14.9:</span></a> <span class="pasted-text">Der Median und das 95-Prozent-Konfidenzintervall der Erhebungsgebiete Linth, Aare und Rhône. Das Erhebungsgebiet Tessin ist mangels ausreichender Anzahl von Datenerhebungen nicht enthalten.</span></p>
<div class="cell tag_remove-input docutils container">
</div>
</div>
</div>
</div>
<div class="section" id="extremwerte">
<h2><span class="section-number">14.3. </span>Extremwerte<a class="headerlink" href="#extremwerte" title="Link zu dieser Überschrift">#</a></h2>
<p>Wie bereits erwähnt, werden Extremwerte (EVs) oder Ausreisser bei der Berechnung von Basislinien oder CIs nicht aus den Daten ausgeschlossen. Die Identifizierung von EVs und wo und wann sie auftreten, ist jedoch ein wesentlicher Bestandteil des Überwachungsprozesses.</p>
<p>Das Auftreten von Extremwerten kann den Durchschnitt der Daten und die Interpretation der Erhebungsergebnisse beeinflussen. Laut dem GFS-Bericht:</p>
<blockquote>
<div><p>Die Methodik zur Identifizierung von Extremwerten kann entweder auf einem Expertenurteil beruhen oder auf statistischen und modellierenden Ansätzen, wie der Anwendung von Tukey’s Box Plots zur Erkennung potenzieller Ausreisser. Für schiefe Verteilungen ist der angepasste Boxplot besser geeignet. <span id="id17">[<a class="reference internal" href="references.html#id42" title="van Loon W. Hanke G., Walvoort D. Eu marine beach litter baselines. Publications Office of the European Union, 2019. doi:10.2760/16903.">HG19</a>]</span></p>
</div></blockquote>
<div class="section" id="extremwerte-definieren">
<h3><span class="section-number">14.3.1. </span>Extremwerte definieren<a class="headerlink" href="#extremwerte-definieren" title="Link zu dieser Überschrift">#</a></h3>
<p>Die Referenzen geben keine Hinweise auf den numerischen Wert eines EV. Im Gegensatz zu dem Zielwert von 20 p/100 m oder dem 15. Perzentil bleibt die Definition eines EV der Person überlassen, die die Daten interpretiert. Die Obergrenze von Tukeys Boxplot (unangepasst) ist ungefähr das 90. Perzentil der Daten. Diese Methode ist mit der Bewertungsmetrik kompatibel, und Boxplots lassen sich visuell relativ leicht auflösen.</p>
<div class="section" id="angepasste-boxplots">
<h4><span class="section-number">14.3.1.1. </span>Angepasste Boxplots<a class="headerlink" href="#angepasste-boxplots" title="Link zu dieser Überschrift">#</a></h4>
<p>Tukeys Boxplot wird verwendet, um die Verteilung eines univariaten Datensatzes zu visualisieren. Die Proben, die innerhalb des ersten Quartils (25 %) und des dritten Quartils (75 %) liegen, werden als innerhalb des inneren Quartilsbereichs (IQR) betrachtet. Punkte, die ausserhalb des inneren Quartils liegen, werden als Ausreisser betrachtet, wenn ihr Wert grösser oder kleiner als einer der beiden Grenzwerte ist:</p>
<ul class="simple">
<li><p>Untere Grenze =   <span class="math notranslate nohighlight">\(Q_1 - (1.5*IQR)\)</span></p></li>
<li><p>Obergrenze =   <span class="math notranslate nohighlight">\(Q_3 + (1.5*IQR)\)</span></p></li>
</ul>
<p>Die Grenzen werden erweitert oder reduziert, um der Form der Daten besser zu entsprechen. Infolgedessen repräsentieren die oberen und unteren Grenzen einen grösseren Wertebereich in Bezug auf das Perzentil-Ranking als bei der unangepassten Version.<span id="id18">[<a class="reference internal" href="references.html#id32" title="Mia Hubert and Ellen Vandervieren. An adjusted boxplot for skewed distributions. Computational Statistics &amp; Data Analysis, 52:5186-5201, 08 2008. doi:10.1016/j.csda.2007.11.008.">HV08</a>]</span> <span id="id19">[<a class="reference internal" href="references.html#id19" title="Skipper Seabold and Josef Perktold. Statsmodels: econometric and statistical modeling with python. URL: https://www.statsmodels.org/stable/generated/statsmodels.stats.stattools.medcouple.html.">SP</a>]</span></p>
<p>Die neue Berechnung sieht wie folgt aus:</p>
<ul class="simple">
<li><p>Untere Grenze = <span class="math notranslate nohighlight">\(Q_1 - (1.5e^{-4MC}*IQR)\)</span></p></li>
<li><p>Obergrenze = <span class="math notranslate nohighlight">\(Q_3 + (1.5e^{3MC}*IQR)\)</span></p></li>
</ul>
<p>Die Grenzen werden erweitert oder reduziert, um der Form der Daten besser zu entsprechen. Infolgedessen repräsentieren die oberen und unteren Grenzen einen grösseren Wertebereich in Bezug auf das Perzentil-Ranking als bei der unangepassten Version.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># implementation of medcouple</span>
<span class="n">a_whis</span> <span class="o">=</span> <span class="n">medcouple</span><span class="p">(</span><span class="n">dt_all</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>

<span class="c1"># get the ecdf </span>
<span class="n">ecdf</span> <span class="o">=</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">dt_all</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>

<span class="c1"># quantiles and IQR of the data</span>
<span class="n">q1</span> <span class="o">=</span> <span class="n">dt_all</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">q3</span> <span class="o">=</span><span class="n">dt_all</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">iqr</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">-</span> <span class="n">q1</span>

<span class="c1"># the upper and lower limit of extreme values unadjusted:</span>
<span class="n">limit_lower</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">-</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">iqr</span>
<span class="n">limit_upper</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">iqr</span>

<span class="c1"># the upper and lower limit of extreme values adjusted:</span>
<span class="n">a_fence</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">a_whis</span><span class="p">))))</span><span class="o">*</span><span class="n">iqr</span>
<span class="n">a_2fence</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="mi">3</span><span class="o">*</span><span class="n">a_whis</span><span class="p">))))</span><span class="o">*</span><span class="n">iqr</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">box_props</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;boxprops&#39;</span><span class="p">:{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span><span class="s1">&#39;magenta&#39;</span><span class="p">},</span>
    <span class="s1">&#39;medianprops&#39;</span><span class="p">:{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;magenta&#39;</span><span class="p">},</span>
    <span class="s1">&#39;whiskerprops&#39;</span><span class="p">:{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;magenta&#39;</span><span class="p">},</span>
    <span class="s1">&#39;capprops&#39;</span><span class="p">:{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;magenta&#39;</span><span class="p">}</span>
<span class="p">}</span>

<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dt_all</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">unit_label</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="mf">.35</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dt_all</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">unit_label</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">box_props</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">a_2fence</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mf">.25</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">.75</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">unit_label</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">a_2fence</span><span class="o">+</span><span class="mi">200</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;bereinigt&quot;</span><span class="p">,</span>
                  <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">a_2fence</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                  <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">.2</span><span class="p">,</span><span class="n">a_2fence</span><span class="o">-</span><span class="mi">200</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                  <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                  <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round4&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
                  <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-|&gt;&quot;</span><span class="p">,</span>
                                  <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=-0.2&quot;</span><span class="p">,</span>
                                  <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;nicht bereinigt&quot;</span><span class="p">,</span>
                  <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">limit_upper</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                  <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">.2</span><span class="p">,</span><span class="n">limit_upper</span><span class="o">+</span><span class="mi">400</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                  <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                  <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round4&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
                  <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-|&gt;&quot;</span><span class="p">,</span>
                                  <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=-0.2&quot;</span><span class="p">,</span>
                                  <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">figure_name</span> <span class="o">=</span> <span class="s2">&quot;tukeys_example&quot;</span>
<span class="n">tukeys_example_file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">save_fig_prefix</span><span class="si">}{</span><span class="n">figure_name</span><span class="si">}</span><span class="s1">.jpeg&#39;</span>
<span class="n">save_figure_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;fname&quot;</span><span class="p">:</span><span class="n">tukeys_example_file_name</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="o">**</span><span class="n">save_figure_kwargs</span><span class="p">)</span>

<span class="c1"># figure caption</span>
<span class="n">tukeys_caption</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Die Grenze, ab der eine Datenerhebung als extrem gilt, erstreckt sich auf das 98. &quot;</span><span class="p">,</span>
    <span class="s2">&quot;Perzentil, wenn die Boxplots angepasst werden, im Gegensatz zum 90. Perzentil, &quot;</span><span class="p">,</span>
    <span class="s2">&quot;wenn die Konstante bei 1,5 belassen wird. &quot;</span><span class="p">,</span>
    <span class="s2">&quot;Der Unterschied zwischen bereinigten und normalen Boxplots. Bereinigt = 1’507 p/100, m&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nicht bereinigt = 755 p/100 m.&quot;</span>
<span class="p">]</span>

<span class="n">tukeys_example_notes</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tukeys_caption</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;tukeys_example_notes&quot;</span><span class="p">,</span> <span class="n">tukeys_example_notes</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;tukeys_example&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="figure align-default" id="tukeys-example">
<img alt="_images/a38819c81c5bded50409f3f4aeeb9a664e4d2d26002a12b260a73a21ad9b4711.png" src="_images/a38819c81c5bded50409f3f4aeeb9a664e4d2d26002a12b260a73a21ad9b4711.png" />
<p class="caption"><span class="caption-number">Abb. 14.10 </span><span class="caption-text"><span class="pasted-text"> </span></span><a class="headerlink" href="#tukeys-example" title="Link zu diesem Bild">#</a></p>
</div>
<p><a class="reference internal" href="#tukeys-example"><span class="std std-numref">Abbildung 14.10:</span></a> <span class="pasted-text">Die Grenze, ab der eine Datenerhebung als extrem gilt, erstreckt sich auf das 98. Perzentil, wenn die Boxplots angepasst werden, im Gegensatz zum 90. Perzentil, wenn die Konstante bei 1,5 belassen wird. Der Unterschied zwischen bereinigten und normalen Boxplots. Bereinigt = 1’507 p/100, mnicht bereinigt = 755 p/100 m.</span></p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Der Unterschied zwischen bereinigten und normalen Boxplots. Bereinigt = 1507 p/100 m, nicht bereinigt = 755 p/100 m.</p>
<p>Bei Verwendung der bereinigten Boxplots steigt die Extremwertschwelle (EVT) auf über 1600 p/100 m. Die unbereinigten Boxplots liegen jedoch innerhalb des KI des erwarteten Perzentils der Erhebungsdaten.</p>
<div class="figure align-default" id="onethous60053pcs100m">
<img alt="_images/onethous60053pcs100m.jpg" src="_images/onethous60053pcs100m.jpg" />
<p class="caption"><span class="caption-number">Abb. 14.11 </span><span class="caption-text"><span class="pasted-text"> </span></span><a class="headerlink" href="#onethous60053pcs100m" title="Link zu diesem Bild">#</a></p>
</div>
<p><a class="reference internal" href="#onethous60053pcs100m"><span class="std std-numref">Abbildung 14.11:</span></a> Beispiel für bereinigte Extremwerte: St. Gingolph, 12.08.2020. Es wurden 514 Objekte (p) über 31 Meter (m) Uferlinie gesammelt. Zuerst wird der Wert der Datenerhebungen in Abfallobjekte pro Meter (p/m) umgerechnet und dann mit der erforderlichen Anzahl von Metern (100) multipliziert: <span class="math notranslate nohighlight">\((pcs/m)*100 = (514_{pcs} / 31_m)*100m \approxeq  \text{1'652 p/100 m}\)</span></p>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="modellierung">
<h4><span class="section-number">14.3.1.2. </span>Modellierung<a class="headerlink" href="#modellierung" title="Link zu dieser Überschrift">#</a></h4>
<p>Extremwerte können identifiziert werden, indem man davon ausgeht, dass die Daten zu einer zugrundeliegenden bekannten statistischen Verteilung gehören. Im Allgemeinen wird davon ausgegangen, dass Zähldaten eine Poisson-Verteilung oder eine sehr ähnliche Form aufweisen. Bei der Poisson-Verteilung wird angenommen, dass der Mittelwert gleich der Varianz ist. Die vorliegenden Daten und Strandabfalldaten im Allgemeinen weisen eine hohe Varianz auf, die in der Regel grösser als der Mittelwert ist.</p>
<p>Für die negative Binomialverteilung (NB) gilt diese Anforderung nicht. Die NB ist eine Poisson-Verteilung mit dem Parameter λ, wobei λ selbst nicht fest ist, sondern eine Zufallsvariable, die einer Gamma-Verteilung folgt. <span id="id20">[<a class="reference internal" href="references.html#id20" title="A. Cameron and Pravin Trivedi. Regression analysis of count data. 2nd ed, pages 200. Volume 41. cambridge, 09 1999. doi:10.1017/CBO9780511814365.">CT99</a>]</span> <span id="id21">[<a class="reference internal" href="references.html#id21" title="Eric W. Weisstein. &quot;negative binomial distribution.&quot; from mathworld–a wolfram web resource. 2020. URL: https://mathworld.wolfram.com/NegativeBinomialDistribution.html.">Wei20</a>]</span> <span id="id22">[<a class="reference internal" href="references.html#id23" title="Scipy nbimon. Scipy stats nbinom. URL: https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.nbinom.html.">nbi</a>]</span></p>
<blockquote>
<div><p>Der Modellierungsansatz zur Identifizierung von Extremwerten erfolgt dann durch Anpassung der NB-Verteilung an die Daten mittels maximaler Wahrscheinlichkeit (MLE) und Kennzeichnung aller Werte im rechten Schwanz als potenziell extreme Werte, wenn die Wahrscheinlichkeit, dass sie zur angepassten NB-Verteilung gehören, kleiner als z.B. 0,001 ist.  <span id="id23">[<a class="reference internal" href="references.html#id44" title="Fleet D. Van Loon W., Hanke G. A european threshold value and assessment method for macro litter on coastlines. Publications Office of the European Union, 2020.">VLW20</a>]</span></p>
</div></blockquote>
<p>Der MLE ist eine der beiden empfohlenen Methoden zur Modellierung oder Anpassung von Datenwerten an eine angenommene Verteilung:</p>
<ul class="simple">
<li><p>Methode der Momente (MOM)</p></li>
<li><p>MLE: Maximum-Likelihood-Schätzung</p></li>
</ul>
<div class="section" id="methode-der-momente-mom">
<h5><span class="section-number">14.3.1.2.1. </span>Methode der Momente (MOM)<a class="headerlink" href="#methode-der-momente-mom" title="Link zu dieser Überschrift">#</a></h5>
<p>Die Methode der Momente geht davon aus, dass die aus der Stichprobe abgeleiteten Parameter den Populationsparametern nahekommen oder gleich sind. Im Falle von Strand-Abfallerhebungen bedeutet dies, dass der Median, der Mittelwert und die Varianz der Stichprobe als gute Annäherung an die tatsächlichen Werte angesehen werden können, wenn alle Strände an allen Seen und Fliessgewässern untersucht werden.</p>
<p>Konkret werden die Parameter eines wahrscheinlichen Verteilungsmodells geschätzt, indem sie aus den Beispieldaten berechnet werden. Diese Methode ist einfach anzuwenden, da die meisten Parameterberechnungen für die gängigsten Verteilungen gut bekannt sind. <span id="id24">[<a class="reference internal" href="references.html#id17" title="Srikanta Mishra and Akhil Datta-Gupta. Chapter 3 - distributions and models thereof. In Srikanta Mishra and Akhil Datta-Gupta, editors, Applied Statistical Modeling and Data Analytics, pages 31-67. Elsevier, 2018. URL: https://www.sciencedirect.com/science/article/pii/B9780128032794000031, doi:https://doi.org/10.1016/B978-0-12-803279-4.00003-1.">MDG18</a>]</span> <span id="id25">[<a class="reference internal" href="references.html#id25" title="Pauli Virtanen, Ralf Gommers, Travis E. Oliphant, Matt Haberland, Tyler Reddy, David Cournapeau, Evgeni Burovski, Pearu Peterson, Warren Weckesser, Jonathan Bright, Stéfan J. van der Walt, Matthew Brett, Joshua Wilson, K. Jarrod Millman, Nikolay Mayorov, Andrew R. J. Nelson, Eric Jones, Robert Kern, Eric Larson, C J Carey, İlhan Polat, Yu Feng, Eric W. Moore, Jake VanderPlas, Denis Laxalde, Josef Perktold, Robert Cimrman, Ian Henriksen, E. A. Quintero, Charles R. Harris, Anne M. Archibald, Antônio H. Ribeiro, Fabian Pedregosa, Paul van Mulbregt, and SciPy 1.0 Contributors. SciPy 1.0: Fundamental Algorithms for Scientific Computing in Python. Nature Methods, 17:261–272, 2020. doi:10.1038/s41592-019-0686-2.">VGO+20</a>]</span> <span id="id26">[<a class="reference internal" href="references.html#id24" title="Stack-Overflow. Fitting for discrete data: negative binomial, poisson, geometric distribution. URL: https://stackoverflow.com/questions/59308441/fitting-for-discrete-data-negative-binomial-poisson-geometric-distribution.">SO</a>]</span></p>
</div>
<div class="section" id="maximum-likelihood-schatzung-mle">
<h5><span class="section-number">14.3.1.2.2. </span>Maximum-Likelihood-Schätzung (MLE)<a class="headerlink" href="#maximum-likelihood-schatzung-mle" title="Link zu dieser Überschrift">#</a></h5>
<p>MLE ist eine Methode zur Schätzung der Parameter eines statistischen Modells bei gegebenen Daten. In dieser Hinsicht unterscheidet sie sich nicht von der MOM. Der Unterschied besteht darin, dass bei der MOM die Modellparameter aus den Daten berechnet werden, während bei der MLE die Parameter so gewählt werden, dass die Daten angesichts des statistischen Modells am wahrscheinlichsten sind.</p>
<p>Diese Methode ist rechenintensiver als die MOM, hat aber einige Vorteile:</p>
<ul class="simple">
<li><p>Wenn das Modell korrekt angenommen wird, ist MLE die effizienteste Schätzung.</p></li>
<li><p>MLE führt zu unverzerrten Schätzungen in grösseren Stichproben.</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># implementaion of MLE</span>
<span class="c1"># https://github.com/pnxenopoulos/negative_binomial/blob/master/negative_binomial/core.py</span>

<span class="k">def</span> <span class="nf">r_derv</span><span class="p">(</span><span class="n">r_var</span><span class="p">,</span> <span class="n">vec</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Function that represents the derivative of the negbinomial likelihood</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">total_sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">obs_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>  <span class="c1"># Save the mean of the data</span>
    <span class="n">n_pop</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vec</span><span class="p">))</span>  <span class="c1"># Save the length of the vector, n_pop</span>

    <span class="k">for</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">vec</span><span class="p">:</span>
        <span class="n">total_sum</span> <span class="o">+=</span> <span class="n">digamma</span><span class="p">(</span><span class="n">obs</span> <span class="o">+</span> <span class="n">r_var</span><span class="p">)</span>

    <span class="n">total_sum</span> <span class="o">-=</span> <span class="n">n_pop</span><span class="o">*</span><span class="n">digamma</span><span class="p">(</span><span class="n">r_var</span><span class="p">)</span>
    <span class="n">total_sum</span> <span class="o">+=</span> <span class="n">n_pop</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">r_var</span> <span class="o">/</span> <span class="p">(</span><span class="n">r_var</span> <span class="o">+</span> <span class="n">obs_mean</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">total_sum</span>

<span class="k">def</span> <span class="nf">p_equa</span><span class="p">(</span><span class="n">r_var</span><span class="p">,</span> <span class="n">vec</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Function that represents the equation for p in the negbin likelihood</span>
<span class="sd">     &#39;&#39;&#39;</span>
    <span class="n">data_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
    <span class="n">n_pop</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vec</span><span class="p">))</span>
    <span class="n">p_var</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">data_sum</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_pop</span> <span class="o">*</span> <span class="n">r_var</span> <span class="o">+</span> <span class="n">data_sum</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">p_var</span>

<span class="k">def</span> <span class="nf">neg_bin_fit</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Function to fit negative binomial to data</span>
<span class="sd">    vec: the data vector used to fit the negative binomial distribution</span>
<span class="sd">   </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">est_r</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">r_derv</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">vec</span><span class="p">,))</span>
    <span class="n">est_p</span> <span class="o">=</span> <span class="n">p_equa</span><span class="p">(</span><span class="n">est_r</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">est_r</span><span class="p">,</span> <span class="n">est_p</span>

<span class="c1"># the data to model</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">dt_all</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="c1"># the variance</span>
<span class="n">var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>

<span class="c1"># the average</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>

<span class="c1"># dispersion</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">mean</span><span class="o">/</span><span class="n">var</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="n">mean</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">var</span><span class="o">-</span><span class="n">mean</span><span class="p">))</span>

<span class="c1"># implementation of method of moments</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">nbinom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">))</span>

<span class="c1"># format data for charting</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">unit_label</span><span class="p">:</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;group&#39;</span><span class="p">:</span><span class="s2">&quot;Beobachtung&quot;</span><span class="p">})</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">unit_label</span><span class="p">:</span><span class="n">r</span><span class="p">,</span> <span class="s1">&#39;group&#39;</span><span class="p">:</span><span class="s1">&#39;MOM&#39;</span><span class="p">})])</span>

<span class="n">scp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">group</span> <span class="o">==</span> <span class="s1">&#39;MOM&#39;</span><span class="p">][</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">group</span> <span class="o">==</span> <span class="s2">&quot;Beobachtung&quot;</span><span class="p">][</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="n">scpsx</span> <span class="o">=</span> <span class="p">[{</span><span class="n">unit_label</span><span class="p">:</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;MOM&#39;</span><span class="p">}</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">scp</span><span class="p">]</span>
<span class="n">obsx</span> <span class="o">=</span> <span class="p">[{</span><span class="n">unit_label</span><span class="p">:</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s2">&quot;Beobachtung&quot;</span><span class="p">}</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">obs</span><span class="p">]</span>

<span class="c1"># ! implementation of MLE</span>
<span class="n">estimated_r</span><span class="p">,</span> <span class="n">estimated_p</span> <span class="o">=</span> <span class="n">neg_bin_fit</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">init</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">)</span>

<span class="c1"># ! use the MLE estimators to generate data</span>
<span class="n">som_data</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">nbinom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">estimated_r</span><span class="p">,</span> <span class="n">estimated_p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dt_all</span><span class="p">))</span>
<span class="n">som_datax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="n">unit_label</span><span class="p">:</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;MLE&#39;</span><span class="p">}</span>  <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">som_data</span><span class="p">])</span>

<span class="c1"># combined the different results in to one df</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scpsx</span><span class="p">),</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">obsx</span><span class="p">),</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">som_datax</span><span class="p">)])</span>
<span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># the 90th</span>
<span class="n">ev</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">.9</span><span class="p">)</span>
<span class="n">xval</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;MOM&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Beobachtung&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;MLE&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
<span class="n">ev</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ev</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">xval</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="n">box_palette</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;MOM&#39;</span><span class="p">:</span><span class="s1">&#39;salmon&#39;</span><span class="p">,</span> <span class="s1">&#39;MLE&#39;</span><span class="p">:</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="s1">&#39;Beobachtung&#39;</span><span class="p">:</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">axone</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">bw</span><span class="o">=</span><span class="mi">80</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">unit_label</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">box_palette</span><span class="p">,</span> <span class="n">binwidth</span><span class="o">=</span><span class="n">bw</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s1">&#39;bars&#39;</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="s1">&#39;stack&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="c1"># sns.histplot(data=data, x=unit_label, ax=ax, hue=&#39;model&#39;)</span>
<span class="n">box_props</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;boxprops&#39;</span><span class="p">:{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">},</span>
    <span class="s1">&#39;medianprops&#39;</span><span class="p">:{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">},</span>
    <span class="s1">&#39;whiskerprops&#39;</span><span class="p">:{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">},</span>
    <span class="s1">&#39;capprops&#39;</span><span class="p">:{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">}</span>
<span class="p">}</span>

<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">unit_label</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axone</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">box_palette</span><span class="p">,</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dodge</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">box_props</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">unit_label</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="n">box_palette</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axone</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">dodge</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">axone</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ev</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ev</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;90%&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">axone</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">95</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;# der Erhebungen&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>
<span class="n">axone</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">unit_label</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>

<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">axone</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">axone</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">h3</span><span class="o">=</span><span class="n">handles</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">hlast</span><span class="o">=</span> <span class="n">handles</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">axone</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">axone</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">l3</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">llast</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">axone</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="o">*</span><span class="n">h3</span><span class="p">,</span> <span class="o">*</span><span class="n">hlast</span><span class="p">],</span> <span class="p">[</span><span class="o">*</span><span class="n">l3</span><span class="p">,</span> <span class="o">*</span><span class="n">llast</span><span class="p">],</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.48</span><span class="p">,</span> <span class="mf">.96</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">figure_name</span> <span class="o">=</span> <span class="s2">&quot;models_compare&quot;</span>
<span class="n">models_compare_file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">save_fig_prefix</span><span class="si">}{</span><span class="n">figure_name</span><span class="si">}</span><span class="s1">.jpeg&#39;</span>
<span class="n">save_figure_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;fname&quot;</span><span class="p">:</span><span class="n">models_compare_file_name</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="o">**</span><span class="n">save_figure_kwargs</span><span class="p">)</span>

<span class="c1"># figure caption</span>
<span class="n">models_compare_caption</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;&lt;b&gt;Anpassen der Daten an die zugrundeliegende NB-Verteilung.&lt;/b&gt; Die beobachteten Erhebungsergebnisse werden &quot;</span><span class="p">,</span>
    <span class="s2">&quot;mit den geschätzten Datenerhebungen unter Verwendung der Methode der Momente und der Maximum-Likelihood-Schätzung &quot;</span><span class="p">,</span>
    <span class="s2">&quot;verglichen. &lt;b&gt;Links:&lt;/b&gt; Histogramm der Ergebnisse im Vergleich zu den beobachteten Daten. &lt;b&gt;Rechts:&lt;/b&gt; Verteilung &quot;</span><span class="p">,</span>
    <span class="s2">&quot;der Ergebnisse im Vergleich zu den beobachteten Daten mit 90. Perzentil. 90% p/100m:  MLE=825,  Observed=727,  MOM=888&quot;</span>
<span class="p">]</span>

<span class="n">models_compare_notes</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">models_compare_caption</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;models_compare&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="figure align-default" id="models-compare">
<img alt="_images/0dbf858945eb92527a6af124241201dafd4dfa7e36e3d852a6e60e507b32dc75.png" src="_images/0dbf858945eb92527a6af124241201dafd4dfa7e36e3d852a6e60e507b32dc75.png" />
<p class="caption"><span class="caption-number">Abb. 14.12 </span><span class="caption-text"><span class="pasted-text"> </span></span><a class="headerlink" href="#models-compare" title="Link zu diesem Bild">#</a></p>
</div>
<p><a class="reference internal" href="#models-compare"><span class="std std-numref">Abbildung 14.12:</span></a> <strong>Anpassen der Daten an die zugrundeliegende NB-Verteilung.</strong> Die beobachteten Erhebungsergebnisse werden mit den geschätzten Datenerhebungen unter Verwendung der Methode der Momente und der Maximum-Likelihood-Schätzung verglichen. <strong>Links:</strong> Histogramm der Ergebnisse im Vergleich zu den beobachteten Daten. <strong>Rechts:</strong> Verteilung der Ergebnisse im Vergleich zu den beobachteten Daten mit 90. Perzentil.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
</div>
</div>
</div>
</div>
<div class="section" id="umsetzung">
<h2><span class="section-number">14.4. </span>Umsetzung<a class="headerlink" href="#umsetzung" title="Link zu dieser Überschrift">#</a></h2>
<p>Die vorgeschlagenen Bewertungsmassstäbe und -methoden für die Ergebnisse der Untersuchungen der Strand-Abfallaufkommen sind ähnlich und kompatibel mit den zuvor in der Schweiz angewandten Methoden. Diese erste Analyse hat gezeigt:</p>
<ul class="simple">
<li><p>dass die von der EU vorgeschlagenen Methoden zur Überwachung von Abfallobjekten in der Schweiz anwendbar sind,</p></li>
<li><p>dass Konfidenzintervalle und Basislinien für verschiedene Erhebungsgebiete berechnet werden können und</p></li>
<li><p>dass aggregierte Ergebnisse zwischen Regionen verglichen werden können.</p></li>
</ul>
<p>Sobald der BV für ein Erhebungsgebiet berechnet ist, können alle Proben, die innerhalb dieses Erhebungsgebiets durchgeführt werden, direkt mit diesem verglichen werden. Es zeigt sich, dass die Erhebungsgebiete in der Schweiz unterschiedliche Median-Basislinien haben. Diese Situation ist mit der EU vergleichbar, was die Unterschiede zwischen den verschiedenen Regionen und Verwaltungsgebieten betrifft.</p>
<p>Durch die Anwendung der vorgeschlagenen Methoden auf die aktuellen Ergebnisse von IQAASL können die zu untersuchenden Objekte für jedes Untersuchungsgebiet identifiziert werden.</p>
<div class="figure align-default" id="baselines-most-common-heat-map">
<div class="output text_html"><style type="text/css">
#T_c02ef tr {
  font-size: 12px;
}
#T_c02ef th:nth-child(1) {
  background-color: #FFF;
  text-align: right;
}
#T_c02ef td {
  padding: 6px;
}
#T_c02ef_row0_col0, #T_c02ef_row0_col4, #T_c02ef_row1_col1, #T_c02ef_row5_col2, #T_c02ef_row7_col3 {
  background-color: #fffbd0;
  color: #000000;
}
#T_c02ef_row0_col1, #T_c02ef_row1_col0, #T_c02ef_row8_col3 {
  background-color: #fffaca;
  color: #000000;
}
#T_c02ef_row0_col2, #T_c02ef_row3_col1 {
  background-color: #fffcd8;
  color: #000000;
}
#T_c02ef_row0_col3, #T_c02ef_row8_col0 {
  background-color: #fff1ae;
  color: #000000;
}
#T_c02ef_row1_col2 {
  background-color: #fec754;
  color: #000000;
}
#T_c02ef_row1_col3, #T_c02ef_row8_col1 {
  background-color: #fff7bc;
  color: #000000;
}
#T_c02ef_row1_col4, #T_c02ef_row3_col0, #T_c02ef_row3_col4 {
  background-color: #fff8c4;
  color: #000000;
}
#T_c02ef_row2_col0 {
  background-color: #fec14c;
  color: #000000;
}
#T_c02ef_row2_col1, #T_c02ef_row10_col2 {
  background-color: #fee89b;
  color: #000000;
}
#T_c02ef_row2_col2 {
  background-color: #662506;
  color: #f1f1f1;
}
#T_c02ef_row2_col3 {
  background-color: #feeca4;
  color: #000000;
}
#T_c02ef_row2_col4 {
  background-color: #fec34f;
  color: #000000;
}
#T_c02ef_row3_col2, #T_c02ef_row8_col4 {
  background-color: #feeda6;
  color: #000000;
}
#T_c02ef_row3_col3 {
  background-color: #ffface;
  color: #000000;
}
#T_c02ef_row4_col0, #T_c02ef_row4_col1, #T_c02ef_row4_col2, #T_c02ef_row4_col3, #T_c02ef_row4_col4, #T_c02ef_row5_col0, #T_c02ef_row6_col0, #T_c02ef_row6_col1, #T_c02ef_row7_col0, #T_c02ef_row7_col1, #T_c02ef_row9_col0, #T_c02ef_row9_col1, #T_c02ef_row9_col2, #T_c02ef_row9_col3, #T_c02ef_row9_col4, #T_c02ef_row10_col0, #T_c02ef_row10_col1, #T_c02ef_row10_col3 {
  background-color: #ffffe5;
  color: #000000;
}
#T_c02ef_row5_col1, #T_c02ef_row5_col3, #T_c02ef_row5_col4, #T_c02ef_row6_col4, #T_c02ef_row7_col4, #T_c02ef_row10_col4 {
  background-color: #fffedf;
  color: #000000;
}
#T_c02ef_row6_col2 {
  background-color: #fff8c0;
  color: #000000;
}
#T_c02ef_row6_col3 {
  background-color: #fffcd4;
  color: #000000;
}
#T_c02ef_row7_col2 {
  background-color: #fff4b5;
  color: #000000;
}
#T_c02ef_row8_col2 {
  background-color: #febd49;
  color: #000000;
}
#T_c02ef_row11_col0 {
  background-color: #fee799;
  color: #000000;
}
#T_c02ef_row11_col1 {
  background-color: #fea030;
  color: #000000;
}
#T_c02ef_row11_col2 {
  background-color: #9c3604;
  color: #f1f1f1;
}
#T_c02ef_row11_col3 {
  background-color: #fed16b;
  color: #000000;
}
#T_c02ef_row11_col4 {
  background-color: #feb643;
  color: #000000;
}
#T_c02ef_level0_col0, #T_c02ef_level0_col1, #T_c02ef_level0_col2, #T_c02ef_level0_col3, #T_c02ef_level0_col4 {
  writing-mode: vertical-lr;
  transform: rotate(-180deg);
  padding: 10px;
  margins: 0;
  vertical-align: baseline;
}
</style>
<table id="T_c02ef">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_c02ef_level0_col0" class="col_heading level0 col0" >Aare</th>
      <th id="T_c02ef_level0_col1" class="col_heading level0 col1" >Linth</th>
      <th id="T_c02ef_level0_col2" class="col_heading level0 col2" >Rhone</th>
      <th id="T_c02ef_level0_col3" class="col_heading level0 col3" >Ticino</th>
      <th id="T_c02ef_level0_col4" class="col_heading level0 col4" >Alle Erhebungsgebiete</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_c02ef_level0_row0" class="row_heading level0 row0" > Getränkeflaschen aus Glas, Glasfragmente</th>
      <td id="T_c02ef_row0_col0" class="data row0 col0" >3,0</td>
      <td id="T_c02ef_row0_col1" class="data row0 col1" >4,0</td>
      <td id="T_c02ef_row0_col2" class="data row0 col2" >2,0</td>
      <td id="T_c02ef_row0_col3" class="data row0 col3" >8,0</td>
      <td id="T_c02ef_row0_col4" class="data row0 col4" >3,0</td>
    </tr>
    <tr>
      <th id="T_c02ef_level0_row1" class="row_heading level0 row1" >Expandiertes Polystyrol</th>
      <td id="T_c02ef_row1_col0" class="data row1 col0" >4,0</td>
      <td id="T_c02ef_row1_col1" class="data row1 col1" >3,0</td>
      <td id="T_c02ef_row1_col2" class="data row1 col2" >17,5</td>
      <td id="T_c02ef_row1_col3" class="data row1 col3" >6,0</td>
      <td id="T_c02ef_row1_col4" class="data row1 col4" >5,0</td>
    </tr>
    <tr>
      <th id="T_c02ef_level0_row2" class="row_heading level0 row2" >Fragmentierte Kunststoffe</th>
      <td id="T_c02ef_row2_col0" class="data row2 col0" >18,5</td>
      <td id="T_c02ef_row2_col1" class="data row2 col1" >10,5</td>
      <td id="T_c02ef_row2_col2" class="data row2 col2" >48,0</td>
      <td id="T_c02ef_row2_col3" class="data row2 col3" >9,5</td>
      <td id="T_c02ef_row2_col4" class="data row2 col4" >18,0</td>
    </tr>
    <tr>
      <th id="T_c02ef_level0_row3" class="row_heading level0 row3" >Industriefolie (Kunststoff)</th>
      <td id="T_c02ef_row3_col0" class="data row3 col0" >5,0</td>
      <td id="T_c02ef_row3_col1" class="data row3 col1" >2,0</td>
      <td id="T_c02ef_row3_col2" class="data row3 col2" >9,0</td>
      <td id="T_c02ef_row3_col3" class="data row3 col3" >3,5</td>
      <td id="T_c02ef_row3_col4" class="data row3 col4" >5,0</td>
    </tr>
    <tr>
      <th id="T_c02ef_level0_row4" class="row_heading level0 row4" >Industriepellets (Nurdles)</th>
      <td id="T_c02ef_row4_col0" class="data row4 col0" >0,0</td>
      <td id="T_c02ef_row4_col1" class="data row4 col1" >0,0</td>
      <td id="T_c02ef_row4_col2" class="data row4 col2" >0,0</td>
      <td id="T_c02ef_row4_col3" class="data row4 col3" >0,0</td>
      <td id="T_c02ef_row4_col4" class="data row4 col4" >0,0</td>
    </tr>
    <tr>
      <th id="T_c02ef_level0_row5" class="row_heading level0 row5" >Kronkorken, Lasche von Dose/Ausfreisslachen</th>
      <td id="T_c02ef_row5_col0" class="data row5 col0" >0,0</td>
      <td id="T_c02ef_row5_col1" class="data row5 col1" >1,0</td>
      <td id="T_c02ef_row5_col2" class="data row5 col2" >3,0</td>
      <td id="T_c02ef_row5_col3" class="data row5 col3" >1,0</td>
      <td id="T_c02ef_row5_col4" class="data row5 col4" >1,0</td>
    </tr>
    <tr>
      <th id="T_c02ef_level0_row6" class="row_heading level0 row6" >Kunststoff-Bauabfälle</th>
      <td id="T_c02ef_row6_col0" class="data row6 col0" >0,0</td>
      <td id="T_c02ef_row6_col1" class="data row6 col1" >0,0</td>
      <td id="T_c02ef_row6_col2" class="data row6 col2" >5,5</td>
      <td id="T_c02ef_row6_col3" class="data row6 col3" >2,5</td>
      <td id="T_c02ef_row6_col4" class="data row6 col4" >1,0</td>
    </tr>
    <tr>
      <th id="T_c02ef_level0_row7" class="row_heading level0 row7" >Schaumstoffverpackungen/Isolierung</th>
      <td id="T_c02ef_row7_col0" class="data row7 col0" >0,0</td>
      <td id="T_c02ef_row7_col1" class="data row7 col1" >0,0</td>
      <td id="T_c02ef_row7_col2" class="data row7 col2" >7,0</td>
      <td id="T_c02ef_row7_col3" class="data row7 col3" >3,0</td>
      <td id="T_c02ef_row7_col4" class="data row7 col4" >1,0</td>
    </tr>
    <tr>
      <th id="T_c02ef_level0_row8" class="row_heading level0 row8" >Snack-Verpackungen</th>
      <td id="T_c02ef_row8_col0" class="data row8 col0" >8,0</td>
      <td id="T_c02ef_row8_col1" class="data row8 col1" >6,0</td>
      <td id="T_c02ef_row8_col2" class="data row8 col2" >19,0</td>
      <td id="T_c02ef_row8_col3" class="data row8 col3" >4,0</td>
      <td id="T_c02ef_row8_col4" class="data row8 col4" >9,0</td>
    </tr>
    <tr>
      <th id="T_c02ef_level0_row9" class="row_heading level0 row9" >Styropor < 5mm</th>
      <td id="T_c02ef_row9_col0" class="data row9 col0" >0,0</td>
      <td id="T_c02ef_row9_col1" class="data row9 col1" >0,0</td>
      <td id="T_c02ef_row9_col2" class="data row9 col2" >0,0</td>
      <td id="T_c02ef_row9_col3" class="data row9 col3" >0,0</td>
      <td id="T_c02ef_row9_col4" class="data row9 col4" >0,0</td>
    </tr>
    <tr>
      <th id="T_c02ef_level0_row10" class="row_heading level0 row10" >Wattestäbchen/Tupfer</th>
      <td id="T_c02ef_row10_col0" class="data row10 col0" >0,0</td>
      <td id="T_c02ef_row10_col1" class="data row10 col1" >0,0</td>
      <td id="T_c02ef_row10_col2" class="data row10 col2" >10,5</td>
      <td id="T_c02ef_row10_col3" class="data row10 col3" >0,0</td>
      <td id="T_c02ef_row10_col4" class="data row10 col4" >1,0</td>
    </tr>
    <tr>
      <th id="T_c02ef_level0_row11" class="row_heading level0 row11" >Zigarettenfilter</th>
      <td id="T_c02ef_row11_col0" class="data row11 col0" >11,0</td>
      <td id="T_c02ef_row11_col1" class="data row11 col1" >23,0</td>
      <td id="T_c02ef_row11_col2" class="data row11 col2" >41,5</td>
      <td id="T_c02ef_row11_col3" class="data row11 col3" >15,5</td>
      <td id="T_c02ef_row11_col4" class="data row11 col4" >20,0</td>
    </tr>
  </tbody>
</table>
</div><p class="caption"><span class="caption-number">Abb. 14.13 </span><span class="caption-text"><span class="pasted-text"> </span></span><a class="headerlink" href="#baselines-most-common-heat-map" title="Link zu diesem Bild">#</a></p>
</div>
<p><a class="reference internal" href="#baselines-most-common-heat-map"><span class="std std-numref">Abbildung 14.13:</span></a> Vergleich der BVs der häufigsten Objekte. Alle Datenerhebungen 2020–2021. Das Erhebungsgebiet Ticino/Ceresio hat weniger als 100 Datenerhebungen.</p>
<p>Der erwartete Medianwert pro Datenerhebung und der Medianwert der häufigsten Objekte pro Erhebung ist im Erhebungsgebiet Rhône höher. Wenn der Medianwert verwendet wird, zeigt der BV auch, dass 2/12 der häufigsten Objekte in weniger als 50 % der Datenerhebungen landesweit gefunden wurden, nämlich diejenigen mit einem Medianwert von Null.</p>
<p>Die Methode kann vertikal skaliert werden, um eine detailliertere Ansicht eines Erhebungsgebiets zu erhalten. Die Berechnungsmethode bleibt dieselbe, daher sind Vergleiche vom See bis zur nationalen Ebene möglich.</p>
<div class="figure align-default" id="baseline-most-aare-common-heat-map">
<div class="output text_html"><style type="text/css">
#T_a29bf tr {
  font-size: 12px;
}
#T_a29bf th:nth-child(1) {
  background-color: #FFF;
  text-align: right;
}
#T_a29bf td {
  padding: 6px;
}
#T_a29bf_row0_col0, #T_a29bf_row0_col3, #T_a29bf_row0_col4, #T_a29bf_row0_col5, #T_a29bf_row1_col0, #T_a29bf_row1_col1, #T_a29bf_row1_col4, #T_a29bf_row1_col7, #T_a29bf_row2_col0, #T_a29bf_row2_col5, #T_a29bf_row3_col0, #T_a29bf_row3_col1, #T_a29bf_row3_col7, #T_a29bf_row4_col0, #T_a29bf_row4_col1, #T_a29bf_row4_col4, #T_a29bf_row4_col5, #T_a29bf_row4_col6, #T_a29bf_row4_col7, #T_a29bf_row4_col8, #T_a29bf_row4_col9, #T_a29bf_row4_col10, #T_a29bf_row5_col0, #T_a29bf_row5_col1, #T_a29bf_row5_col4, #T_a29bf_row5_col5, #T_a29bf_row5_col7, #T_a29bf_row5_col9, #T_a29bf_row7_col0, #T_a29bf_row7_col1, #T_a29bf_row7_col2, #T_a29bf_row7_col3, #T_a29bf_row7_col4, #T_a29bf_row7_col6, #T_a29bf_row7_col7, #T_a29bf_row7_col8, #T_a29bf_row7_col9, #T_a29bf_row7_col10, #T_a29bf_row8_col0, #T_a29bf_row8_col1, #T_a29bf_row8_col3, #T_a29bf_row8_col5, #T_a29bf_row8_col8, #T_a29bf_row8_col10, #T_a29bf_row9_col0, #T_a29bf_row9_col1, #T_a29bf_row9_col3, #T_a29bf_row9_col5, #T_a29bf_row9_col8, #T_a29bf_row9_col10 {
  background-color: #ffffe5;
  color: #000000;
}
#T_a29bf_row0_col1, #T_a29bf_row0_col8, #T_a29bf_row0_col9, #T_a29bf_row0_col10, #T_a29bf_row1_col6, #T_a29bf_row9_col7 {
  background-color: #fffbd3;
  color: #000000;
}
#T_a29bf_row0_col2, #T_a29bf_row1_col2 {
  background-color: #fff8c4;
  color: #000000;
}
#T_a29bf_row0_col6, #T_a29bf_row1_col10, #T_a29bf_row3_col5, #T_a29bf_row3_col8, #T_a29bf_row3_col9, #T_a29bf_row3_col10, #T_a29bf_row5_col3, #T_a29bf_row6_col5, #T_a29bf_row10_col5 {
  background-color: #fff9c6;
  color: #000000;
}
#T_a29bf_row0_col7, #T_a29bf_row1_col3, #T_a29bf_row2_col6 {
  background-color: #fedb80;
  color: #000000;
}
#T_a29bf_row1_col5, #T_a29bf_row1_col8 {
  background-color: #feeda6;
  color: #000000;
}
#T_a29bf_row1_col9, #T_a29bf_row2_col1, #T_a29bf_row6_col8 {
  background-color: #fffacd;
  color: #000000;
}
#T_a29bf_row2_col2, #T_a29bf_row2_col3 {
  background-color: #662506;
  color: #f1f1f1;
}
#T_a29bf_row2_col4, #T_a29bf_row3_col6, #T_a29bf_row4_col3, #T_a29bf_row5_col8, #T_a29bf_row6_col0, #T_a29bf_row6_col4, #T_a29bf_row8_col4, #T_a29bf_row8_col7, #T_a29bf_row10_col0 {
  background-color: #fffdd9;
  color: #000000;
}
#T_a29bf_row2_col7, #T_a29bf_row10_col3 {
  background-color: #fff8c1;
  color: #000000;
}
#T_a29bf_row2_col8 {
  background-color: #fee79a;
  color: #000000;
}
#T_a29bf_row2_col9 {
  background-color: #feca5d;
  color: #000000;
}
#T_a29bf_row2_col10, #T_a29bf_row3_col2 {
  background-color: #fecd63;
  color: #000000;
}
#T_a29bf_row3_col3 {
  background-color: #933204;
  color: #f1f1f1;
}
#T_a29bf_row3_col4 {
  background-color: #feb643;
  color: #000000;
}
#T_a29bf_row4_col2, #T_a29bf_row8_col2 {
  background-color: #fffcd6;
  color: #000000;
}
#T_a29bf_row5_col2, #T_a29bf_row5_col10, #T_a29bf_row6_col1, #T_a29bf_row8_col6, #T_a29bf_row8_col9, #T_a29bf_row9_col6 {
  background-color: #fffee0;
  color: #000000;
}
#T_a29bf_row5_col6, #T_a29bf_row9_col9 {
  background-color: #fffee2;
  color: #000000;
}
#T_a29bf_row6_col2 {
  background-color: #febd49;
  color: #000000;
}
#T_a29bf_row6_col3, #T_a29bf_row10_col7 {
  background-color: #fd9627;
  color: #000000;
}
#T_a29bf_row6_col6, #T_a29bf_row10_col4 {
  background-color: #fff6ba;
  color: #000000;
}
#T_a29bf_row6_col7 {
  background-color: #fff1b0;
  color: #000000;
}
#T_a29bf_row6_col9 {
  background-color: #fff3b4;
  color: #000000;
}
#T_a29bf_row6_col10, #T_a29bf_row10_col2 {
  background-color: #fff0ad;
  color: #000000;
}
#T_a29bf_row7_col5, #T_a29bf_row10_col8 {
  background-color: #fed676;
  color: #000000;
}
#T_a29bf_row9_col2 {
  background-color: #ffefaa;
  color: #000000;
}
#T_a29bf_row9_col4, #T_a29bf_row10_col9 {
  background-color: #feeaa0;
  color: #000000;
}
#T_a29bf_row10_col1 {
  background-color: #fa8f24;
  color: #f1f1f1;
}
#T_a29bf_row10_col6 {
  background-color: #fed16b;
  color: #000000;
}
#T_a29bf_row10_col10 {
  background-color: #fec34f;
  color: #000000;
}
#T_a29bf_level0_col0, #T_a29bf_level0_col1, #T_a29bf_level0_col2, #T_a29bf_level0_col3, #T_a29bf_level0_col4, #T_a29bf_level0_col5, #T_a29bf_level0_col6, #T_a29bf_level0_col7, #T_a29bf_level0_col8, #T_a29bf_level0_col9, #T_a29bf_level0_col10 {
  writing-mode: vertical-lr;
  transform: rotate(-180deg);
  padding: 10px;
  margins: 0;
  vertical-align: baseline;
}
</style>
<table id="T_a29bf">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_a29bf_level0_col0" class="col_heading level0 col0" >Aare</th>
      <th id="T_a29bf_level0_col1" class="col_heading level0 col1" >Nidau-Büren-Kanal</th>
      <th id="T_a29bf_level0_col2" class="col_heading level0 col2" >Bielersee</th>
      <th id="T_a29bf_level0_col3" class="col_heading level0 col3" >Brienzersee</th>
      <th id="T_a29bf_level0_col4" class="col_heading level0 col4" >Emme</th>
      <th id="T_a29bf_level0_col5" class="col_heading level0 col5" >La Thièle</th>
      <th id="T_a29bf_level0_col6" class="col_heading level0 col6" >Neuenburgersee</th>
      <th id="T_a29bf_level0_col7" class="col_heading level0 col7" >Schüss</th>
      <th id="T_a29bf_level0_col8" class="col_heading level0 col8" >Thunersee</th>
      <th id="T_a29bf_level0_col9" class="col_heading level0 col9" >Erhebungsgebiet Aare</th>
      <th id="T_a29bf_level0_col10" class="col_heading level0 col10" >Alle Erhebungsgebiete</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_a29bf_level0_row0" class="row_heading level0 row0" > Getränkeflaschen aus Glas, Glasfragmente</th>
      <td id="T_a29bf_row0_col0" class="data row0 col0" >0,0</td>
      <td id="T_a29bf_row0_col1" class="data row0 col1" >3,0</td>
      <td id="T_a29bf_row0_col2" class="data row0 col2" >5,5</td>
      <td id="T_a29bf_row0_col3" class="data row0 col3" >0,0</td>
      <td id="T_a29bf_row0_col4" class="data row0 col4" >0,0</td>
      <td id="T_a29bf_row0_col5" class="data row0 col5" >0,0</td>
      <td id="T_a29bf_row0_col6" class="data row0 col6" >5,0</td>
      <td id="T_a29bf_row0_col7" class="data row0 col7" >15,0</td>
      <td id="T_a29bf_row0_col8" class="data row0 col8" >3,0</td>
      <td id="T_a29bf_row0_col9" class="data row0 col9" >3,0</td>
      <td id="T_a29bf_row0_col10" class="data row0 col10" >3,0</td>
    </tr>
    <tr>
      <th id="T_a29bf_level0_row1" class="row_heading level0 row1" >Expandiertes Polystyrol</th>
      <td id="T_a29bf_row1_col0" class="data row1 col0" >0,0</td>
      <td id="T_a29bf_row1_col1" class="data row1 col1" >0,0</td>
      <td id="T_a29bf_row1_col2" class="data row1 col2" >5,5</td>
      <td id="T_a29bf_row1_col3" class="data row1 col3" >15,0</td>
      <td id="T_a29bf_row1_col4" class="data row1 col4" >0,0</td>
      <td id="T_a29bf_row1_col5" class="data row1 col5" >10,0</td>
      <td id="T_a29bf_row1_col6" class="data row1 col6" >3,0</td>
      <td id="T_a29bf_row1_col7" class="data row1 col7" >0,0</td>
      <td id="T_a29bf_row1_col8" class="data row1 col8" >10,0</td>
      <td id="T_a29bf_row1_col9" class="data row1 col9" >4,0</td>
      <td id="T_a29bf_row1_col10" class="data row1 col10" >5,0</td>
    </tr>
    <tr>
      <th id="T_a29bf_level0_row2" class="row_heading level0 row2" >Fragmentierte Kunststoffe</th>
      <td id="T_a29bf_row2_col0" class="data row2 col0" >0,0</td>
      <td id="T_a29bf_row2_col1" class="data row2 col1" >4,0</td>
      <td id="T_a29bf_row2_col2" class="data row2 col2" >53,0</td>
      <td id="T_a29bf_row2_col3" class="data row2 col3" >53,0</td>
      <td id="T_a29bf_row2_col4" class="data row2 col4" >2,0</td>
      <td id="T_a29bf_row2_col5" class="data row2 col5" >0,0</td>
      <td id="T_a29bf_row2_col6" class="data row2 col6" >15,0</td>
      <td id="T_a29bf_row2_col7" class="data row2 col7" >6,0</td>
      <td id="T_a29bf_row2_col8" class="data row2 col8" >12,0</td>
      <td id="T_a29bf_row2_col9" class="data row2 col9" >18,5</td>
      <td id="T_a29bf_row2_col10" class="data row2 col10" >18,0</td>
    </tr>
    <tr>
      <th id="T_a29bf_level0_row3" class="row_heading level0 row3" >Industriefolie (Kunststoff)</th>
      <td id="T_a29bf_row3_col0" class="data row3 col0" >0,0</td>
      <td id="T_a29bf_row3_col1" class="data row3 col1" >0,0</td>
      <td id="T_a29bf_row3_col2" class="data row3 col2" >18,0</td>
      <td id="T_a29bf_row3_col3" class="data row3 col3" >47,0</td>
      <td id="T_a29bf_row3_col4" class="data row3 col4" >22,0</td>
      <td id="T_a29bf_row3_col5" class="data row3 col5" >5,0</td>
      <td id="T_a29bf_row3_col6" class="data row3 col6" >2,0</td>
      <td id="T_a29bf_row3_col7" class="data row3 col7" >0,0</td>
      <td id="T_a29bf_row3_col8" class="data row3 col8" >5,0</td>
      <td id="T_a29bf_row3_col9" class="data row3 col9" >5,0</td>
      <td id="T_a29bf_row3_col10" class="data row3 col10" >5,0</td>
    </tr>
    <tr>
      <th id="T_a29bf_level0_row4" class="row_heading level0 row4" >Industriepellets (Nurdles)</th>
      <td id="T_a29bf_row4_col0" class="data row4 col0" >0,0</td>
      <td id="T_a29bf_row4_col1" class="data row4 col1" >0,0</td>
      <td id="T_a29bf_row4_col2" class="data row4 col2" >2,5</td>
      <td id="T_a29bf_row4_col3" class="data row4 col3" >2,0</td>
      <td id="T_a29bf_row4_col4" class="data row4 col4" >0,0</td>
      <td id="T_a29bf_row4_col5" class="data row4 col5" >0,0</td>
      <td id="T_a29bf_row4_col6" class="data row4 col6" >0,0</td>
      <td id="T_a29bf_row4_col7" class="data row4 col7" >0,0</td>
      <td id="T_a29bf_row4_col8" class="data row4 col8" >0,0</td>
      <td id="T_a29bf_row4_col9" class="data row4 col9" >0,0</td>
      <td id="T_a29bf_row4_col10" class="data row4 col10" >0,0</td>
    </tr>
    <tr>
      <th id="T_a29bf_level0_row5" class="row_heading level0 row5" >Schaumstoffverpackungen/Isolierung</th>
      <td id="T_a29bf_row5_col0" class="data row5 col0" >0,0</td>
      <td id="T_a29bf_row5_col1" class="data row5 col1" >0,0</td>
      <td id="T_a29bf_row5_col2" class="data row5 col2" >1,0</td>
      <td id="T_a29bf_row5_col3" class="data row5 col3" >5,0</td>
      <td id="T_a29bf_row5_col4" class="data row5 col4" >0,0</td>
      <td id="T_a29bf_row5_col5" class="data row5 col5" >0,0</td>
      <td id="T_a29bf_row5_col6" class="data row5 col6" >0,5</td>
      <td id="T_a29bf_row5_col7" class="data row5 col7" >0,0</td>
      <td id="T_a29bf_row5_col8" class="data row5 col8" >2,0</td>
      <td id="T_a29bf_row5_col9" class="data row5 col9" >0,0</td>
      <td id="T_a29bf_row5_col10" class="data row5 col10" >1,0</td>
    </tr>
    <tr>
      <th id="T_a29bf_level0_row6" class="row_heading level0 row6" >Snack-Verpackungen</th>
      <td id="T_a29bf_row6_col0" class="data row6 col0" >2,0</td>
      <td id="T_a29bf_row6_col1" class="data row6 col1" >1,0</td>
      <td id="T_a29bf_row6_col2" class="data row6 col2" >21,0</td>
      <td id="T_a29bf_row6_col3" class="data row6 col3" >27,0</td>
      <td id="T_a29bf_row6_col4" class="data row6 col4" >2,0</td>
      <td id="T_a29bf_row6_col5" class="data row6 col5" >5,0</td>
      <td id="T_a29bf_row6_col6" class="data row6 col6" >7,0</td>
      <td id="T_a29bf_row6_col7" class="data row6 col7" >8,5</td>
      <td id="T_a29bf_row6_col8" class="data row6 col8" >4,0</td>
      <td id="T_a29bf_row6_col9" class="data row6 col9" >8,0</td>
      <td id="T_a29bf_row6_col10" class="data row6 col10" >9,0</td>
    </tr>
    <tr>
      <th id="T_a29bf_level0_row7" class="row_heading level0 row7" >Styropor < 5mm</th>
      <td id="T_a29bf_row7_col0" class="data row7 col0" >0,0</td>
      <td id="T_a29bf_row7_col1" class="data row7 col1" >0,0</td>
      <td id="T_a29bf_row7_col2" class="data row7 col2" >0,0</td>
      <td id="T_a29bf_row7_col3" class="data row7 col3" >0,0</td>
      <td id="T_a29bf_row7_col4" class="data row7 col4" >0,0</td>
      <td id="T_a29bf_row7_col5" class="data row7 col5" >16,0</td>
      <td id="T_a29bf_row7_col6" class="data row7 col6" >0,0</td>
      <td id="T_a29bf_row7_col7" class="data row7 col7" >0,0</td>
      <td id="T_a29bf_row7_col8" class="data row7 col8" >0,0</td>
      <td id="T_a29bf_row7_col9" class="data row7 col9" >0,0</td>
      <td id="T_a29bf_row7_col10" class="data row7 col10" >0,0</td>
    </tr>
    <tr>
      <th id="T_a29bf_level0_row8" class="row_heading level0 row8" >Verpackungen aus Aluminiumfolie</th>
      <td id="T_a29bf_row8_col0" class="data row8 col0" >0,0</td>
      <td id="T_a29bf_row8_col1" class="data row8 col1" >0,0</td>
      <td id="T_a29bf_row8_col2" class="data row8 col2" >2,5</td>
      <td id="T_a29bf_row8_col3" class="data row8 col3" >0,0</td>
      <td id="T_a29bf_row8_col4" class="data row8 col4" >2,0</td>
      <td id="T_a29bf_row8_col5" class="data row8 col5" >0,0</td>
      <td id="T_a29bf_row8_col6" class="data row8 col6" >1,0</td>
      <td id="T_a29bf_row8_col7" class="data row8 col7" >2,0</td>
      <td id="T_a29bf_row8_col8" class="data row8 col8" >0,0</td>
      <td id="T_a29bf_row8_col9" class="data row8 col9" >1,0</td>
      <td id="T_a29bf_row8_col10" class="data row8 col10" >0,0</td>
    </tr>
    <tr>
      <th id="T_a29bf_level0_row9" class="row_heading level0 row9" >Verpackungsfolien, nicht für Lebensmittel</th>
      <td id="T_a29bf_row9_col0" class="data row9 col0" >0,0</td>
      <td id="T_a29bf_row9_col1" class="data row9 col1" >0,0</td>
      <td id="T_a29bf_row9_col2" class="data row9 col2" >9,5</td>
      <td id="T_a29bf_row9_col3" class="data row9 col3" >0,0</td>
      <td id="T_a29bf_row9_col4" class="data row9 col4" >11,0</td>
      <td id="T_a29bf_row9_col5" class="data row9 col5" >0,0</td>
      <td id="T_a29bf_row9_col6" class="data row9 col6" >1,0</td>
      <td id="T_a29bf_row9_col7" class="data row9 col7" >3,0</td>
      <td id="T_a29bf_row9_col8" class="data row9 col8" >0,0</td>
      <td id="T_a29bf_row9_col9" class="data row9 col9" >0,5</td>
      <td id="T_a29bf_row9_col10" class="data row9 col10" >0,0</td>
    </tr>
    <tr>
      <th id="T_a29bf_level0_row10" class="row_heading level0 row10" >Zigarettenfilter</th>
      <td id="T_a29bf_row10_col0" class="data row10 col0" >2,0</td>
      <td id="T_a29bf_row10_col1" class="data row10 col1" >28,0</td>
      <td id="T_a29bf_row10_col2" class="data row10 col2" >9,0</td>
      <td id="T_a29bf_row10_col3" class="data row10 col3" >6,0</td>
      <td id="T_a29bf_row10_col4" class="data row10 col4" >7,0</td>
      <td id="T_a29bf_row10_col5" class="data row10 col5" >5,0</td>
      <td id="T_a29bf_row10_col6" class="data row10 col6" >17,0</td>
      <td id="T_a29bf_row10_col7" class="data row10 col7" >27,0</td>
      <td id="T_a29bf_row10_col8" class="data row10 col8" >16,0</td>
      <td id="T_a29bf_row10_col9" class="data row10 col9" >11,0</td>
      <td id="T_a29bf_row10_col10" class="data row10 col10" >20,0</td>
    </tr>
  </tbody>
</table>
</div><p class="caption"><span class="caption-number">Abb. 14.14 </span><span class="caption-text"><span class="pasted-text"> </span></span><a class="headerlink" href="#baseline-most-aare-common-heat-map" title="Link zu diesem Bild">#</a></p>
</div>
<p><a class="reference internal" href="#baseline-most-aare-common-heat-map"><span class="std std-numref">Abbildung 14.14:</span></a> Vergleich der Basiswerte der häufigsten Objekte. Erhebungsgebiet Aare, Seen und Fliessgewässer 2020–2021. Orte mit mehr als 30 Datenerhebungen: Bielersee, Neuenburgersee und Thunersee.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Die empfohlene Mindestanzahl von Datenerhebungen (40) pro Probenahmezeitraum soll sicherstellen, dass die BV-Berechnungen auf einer ausreichenden Anzahl von Stichproben basieren. Dies ist wegen der hohen Variabilität der Untersuchungen der Strand-Abfallobjekte wichtig.</p>
<p>Die Probenahmen für IQAASL haben im Zeitraum von April 2020 bis Mai 2021 stattgefunden. Unter Berücksichtigung der Mindestanzahl der Proben gibt es drei Basiswerte für das Erhebungsgebiet Aare:</p>
<ul class="simple">
<li><p>Bielersee</p></li>
<li><p>Neuenburgersee</p></li>
<li><p>Erhebungsgebiet Aare</p></li>
</ul>
<p>Für Bewertungszwecke bedeutet dies, dass eine Stichprobe als Stichprobenbewertung dienen kann und die Ergebnisse direkt mit einer der regionalen Basislinien verglichen werden können, was ein sofortiges Feedback ermöglicht. Diese Art der Bewertung vereinfacht den Prozess und versetzt die lokalen Akteure in die Lage, unabhängige Bewertungen vorzunehmen, Schlussfolgerungen zu ziehen und auf der Grundlage der Ergebnisse der festgelegten BVs für das Erhebungsgebiet Minderungsstrategien festzulegen.</p>
<p>In den vorherigen Beispielen sind keine Schwellenwerte oder Extremwerte angegeben. Werte, die grösser als Null sind, entsprechen dem erwarteten Medianwert des Objekts für jede gemessene Einheit. Ein Nullwert bedeutet, dass das Objekt in weniger als 50 % der Datenerhebungen gefunden wurde. Der Perzentil-Rang für ein bestimmtes Objekt lässt sich ableiten, indem die Wertetabelle in horizontaler Richtung gelesen wird.</p>
<p>Wie aussagekräftig diese Ergebnisse für die Bewertung von Minderungsstrategien sind, hängt von der Anzahl und Qualität der Proben ab. Interessengruppen auf kommunaler oder lokaler Ebene benötigen detaillierte Daten über bestimmte Objekte. Nationale und internationale Stakeholder hingegen tendieren dazu, breitere, aggregierte Gruppen zu verwenden.</p>
<p>Die Qualität der Daten steht in direktem Zusammenhang mit der Ausbildung und Unterstützung der Personen, die die Datenerhebung durchführen. Der Identifizierungsprozess erfordert ein gewisses Mass an Fachwissen, da viele Objekte und Materialien dem Durchschnittsbürger nicht bekannt sind. Ein Kernteam von erfahrenen Personen, die bei der Entwicklung und Schulung helfen, stellt sicher, dass die Datenerhebungen im Laufe der Zeit konsistent durchgeführt werden.</p>
<p>Das Monitoring-Programm in der Schweiz hat es geschafft, mit den Entwicklungen auf dem Kontinent Schritt zu halten, es gibt jedoch viele Bereiche, die verbessert werden können:</p>
<ol class="arabic simple">
<li><p>Festlegung einer standardisierten Methode zur Berichterstattung für kommunale, kantonale und nationale Akteure</p></li>
<li><p>Definition von Monitoring- oder Bewertungszielen</p></li>
<li><p>Formalisierung des Datenspeichers und der Methode zur Implementierung auf verschiedenen Verwaltungsebenen</p></li>
<li><p>Aufbau eines Netzwerks von Verbänden, die sich die Verantwortung und die Ressourcen für die Vermessung des Gebiets teilen</p></li>
<li><p>Entwicklung und Implementierung eines formellen Schulungsprogramms für die Personen, welche die Datenerhebung ausführen</p></li>
<li><p>Ermittlung der idealen Stichproben-Szenarien und des Forschungsbedarfs mit akademischen Partnern</p></li>
<li><p>Entwicklung einer Finanzierungsmethode zur Durchführung der empfohlenen Mindestanzahl von Erhebungen (40) pro Erhebungszeitraum und Erhebungsgebiet, um sicherzustellen, dass genaue Bewertungen vorgenommen werden können und die Forschungsanforderungen erfüllt werden.</p></li>
</ol>
<p>Veränderungen in den Ergebnissen von Strand-Abfalluntersuchungen sind Signale, und die Verwendung von Basiswerten hilft, das Ausmass dieser Signale zu erkennen. Ohne Kontext oder zusätzliche Informationen können diese Signale jedoch zufällig erscheinen.</p>
<p>Zum Expertenwissen gehört die Fähigkeit, Erhebungsergebnisse in den Kontext lokaler Ereignisse und der Topographie einzuordnen. Dieses Urteilsvermögen in Bezug auf die Daten und die Umgebung ist für die Identifizierung potenzieller Quellen und Prioritäten von wesentlicher Bedeutung.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="zurichsee.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">zurück</p>
        <p class="prev-next-title"><span class="section-number">13. </span>Zürichsee</p>
      </div>
    </a>
    <a class="right-next"
       href="key_indicators.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">weiter</p>
        <p class="prev-next-title"><span class="section-number">15. </span>Statistische Schlüsselindikatoren</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Inhalt
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#zahlen-von-abfallobjekten-am-strand-ein-uberblick">14.1. Zählen von Abfallobjekten am Strand: ein Überblick</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#schweiz-2020">14.1.1. Schweiz 2020</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#das-sammeln-von-daten">14.1.2. Das Sammeln von Daten</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#festlegung-des-erhebungsgebiets">14.1.2.1. Festlegung des Erhebungsgebiets</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zahlen-von-objekten">14.1.2.2. Zählen von Objekten</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#berechnung-der-basislinien">14.2. Berechnung der Basislinien</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#die-daten">14.2.1. Die Daten</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#die-bewertungsmetrik">14.2.2. Die Bewertungsmetrik</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#konfidenzintervalle-kis">14.2.3. Konfidenzintervalle (KIs)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-methoden">14.2.3.1. Bootstrap-Methoden:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vergleich-der-bootstrap-kis">14.2.4. Vergleich der Bootstrap-KIs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basiswerte">14.2.5. Basiswerte</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#basismedianwert-aller-erhebungsergebnisse">14.2.5.1. Basismedianwert aller Erhebungsergebnisse</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#median-basislinie-und-ki-pro-erhebungsgebiet">14.2.5.2. Median-Basislinie und KI pro Erhebungsgebiet</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extremwerte">14.3. Extremwerte</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extremwerte-definieren">14.3.1. Extremwerte definieren</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#angepasste-boxplots">14.3.1.1. Angepasste Boxplots</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modellierung">14.3.1.2. Modellierung</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#methode-der-momente-mom">14.3.1.2.1. Methode der Momente (MOM)</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-likelihood-schatzung-mle">14.3.1.2.2. Maximum-Likelihood-Schätzung (MLE)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#umsetzung">14.4. Umsetzung</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Durch hammerdirt staff
</p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
   Im Auftrag des Bundesamtes für Umwelt (BAFU), © 2021
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>