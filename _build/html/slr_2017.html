
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>21. More and less since 2018</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="20. Shared responsibility" href="shared_responsibility.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/iqaaslogo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="titlepage.html">
   Identification, quantification and analysis of observable anthropogenic litter along Swiss lake systems
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Executive summary
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Foreword
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="esummary.html">
   Executive summary
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Survey results
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="lakes_rivers.html">
   1. Lakes and rivers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="alpes_valaisannes.html">
   2. The Alps and the Jura
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Survey areas
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="aare_sa.html">
   3. Aare survey area
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linth_sa.html">
   4. Linth survey area
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rhone_sa.html">
   5. Rhone survey area
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ticino_sa.html">
   6. Ticino survey area
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lakes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="bielersee.html">
   7. Bielersee
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lac_leman.html">
   8. Lac LÃ©man
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="neuenburgersee.html">
   9. Neuenburgersee
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="maggiore_lugano.html">
   10. Maggiore/Lugano
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="thunersee_brienzersee.html">
   11. Thunersee/Brienzersee
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="walensee.html">
   12. Walensee
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zurichsee.html">
   13. Zurichsee
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Understand
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="baselines.html">
   14. Beach litter baselines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="key_indicators.html">
   15. Key statistical indicators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="code_groups.html">
   16. Code groups
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="land_use_correlation.html">
   17. The land use profile
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="references.html">
   18. Bibliografie
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Application
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="reuse_remake.html">
   19. Recycle and remake
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="shared_responsibility.html">
   20. Shared responsibility
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   21. More and less since 2018
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/slr_2017.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/hammerdirt-analyst/IQAASL-End-0f-Sampling-2021"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/hammerdirt-analyst/IQAASL-End-0f-Sampling-2021/issues/new?title=Issue%20on%20page%20%2Fslr_2017.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/hammerdirt-analyst/IQAASL-End-0f-Sampling-2021/main?urlpath=tree/docs/slr_2017.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scope-of-projects-slr-iqaasl">
   21.1. Scope of projects SLR - IQAASL
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#land-use-profile-of-survey-locations">
     21.1.1. Land use profile of survey locations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#results-lakes-and-rivers">
   21.2. Results lakes and rivers
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#distribution-of-results-2018-and-2020">
     21.2.1. Distribution of results 2018 and 2020
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summary-data-and-material-types-2018-and-2020">
     21.2.2. Summary data and material types 2018 and 2020
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#difference-of-medians-2018-2020">
       21.2.2.1. Difference of medians 2018 - 2020
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-most-common-objects-year-over-year">
     21.2.3. The most common objects year over year
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#results-lakes-2018-and-2020">
   21.3. Results lakes 2018 and 2020
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lakes-results-most-common-objects-from-2018">
     21.3.1. Lakes: results most common objects from 2018
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#difference-of-mean-survey-total">
     21.3.2. Difference of mean survey total
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#difference-of-means-most-common-objects">
       21.3.2.1. Difference of means most common objects
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#land-use-profile-spearmans-ranked-correlation">
     21.3.3. Land use profile: Spearmans ranked correlation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interpret-spearmans-rho">
       21.3.3.1. Interpret Spearmans
       <span class="math notranslate nohighlight">
        \(\rho\)
       </span>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   21.4. Conclusion
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#on-balance-no-change">
     21.4.1. On balance no change
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#protocols-matter">
     21.4.2. Protocols matter
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plastic-lids">
     21.4.3. Plastic lids
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#land-use-profile">
     21.4.4. Land use profile
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conclusions">
     21.4.5. Conclusions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#annex">
   21.5. Annex
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lakes-monthly-median-common-objects">
     21.5.1. Lakes monthly median common objects:
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#survey-locations">
       21.5.1.1. Survey locations
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>More and less since 2018</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scope-of-projects-slr-iqaasl">
   21.1. Scope of projects SLR - IQAASL
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#land-use-profile-of-survey-locations">
     21.1.1. Land use profile of survey locations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#results-lakes-and-rivers">
   21.2. Results lakes and rivers
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#distribution-of-results-2018-and-2020">
     21.2.1. Distribution of results 2018 and 2020
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summary-data-and-material-types-2018-and-2020">
     21.2.2. Summary data and material types 2018 and 2020
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#difference-of-medians-2018-2020">
       21.2.2.1. Difference of medians 2018 - 2020
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-most-common-objects-year-over-year">
     21.2.3. The most common objects year over year
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#results-lakes-2018-and-2020">
   21.3. Results lakes 2018 and 2020
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lakes-results-most-common-objects-from-2018">
     21.3.1. Lakes: results most common objects from 2018
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#difference-of-mean-survey-total">
     21.3.2. Difference of mean survey total
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#difference-of-means-most-common-objects">
       21.3.2.1. Difference of means most common objects
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#land-use-profile-spearmans-ranked-correlation">
     21.3.3. Land use profile: Spearmans ranked correlation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interpret-spearmans-rho">
       21.3.3.1. Interpret Spearmans
       <span class="math notranslate nohighlight">
        \(\rho\)
       </span>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   21.4. Conclusion
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#on-balance-no-change">
     21.4.1. On balance no change
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#protocols-matter">
     21.4.2. Protocols matter
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plastic-lids">
     21.4.3. Plastic lids
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#land-use-profile">
     21.4.4. Land use profile
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conclusions">
     21.4.5. Conclusions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#annex">
   21.5. Annex
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lakes-monthly-median-common-objects">
     21.5.1. Lakes monthly median common objects:
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#survey-locations">
       21.5.1.1. Survey locations
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sys, file and nav packages:</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>

<span class="c1"># math packages:</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">statsmodels.distributions.empirical_distribution</span> <span class="kn">import</span> <span class="n">ECDF</span>

<span class="c1"># charting:</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">ticker</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>
<span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1"># home brew utitilties</span>
<span class="kn">import</span> <span class="nn">resources.chart_kwargs</span> <span class="k">as</span> <span class="nn">ck</span>
<span class="kn">import</span> <span class="nn">resources.sr_ut</span> <span class="k">as</span> <span class="nn">sut</span>

<span class="c1"># images and display</span>
<span class="c1"># import base64, io, IPython</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span> <span class="k">as</span> <span class="n">PILImage</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Markdown</span> <span class="k">as</span> <span class="n">md</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span> 

<span class="c1"># set some parameters:</span>
<span class="c1"># today = dt.datetime.now().date().strftime(&quot;%Y-%m-%d&quot;)</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="s2">&quot;2015-11-01&quot;</span>
<span class="n">end_date</span> <span class="o">=</span><span class="s2">&quot;2021-05-31&quot;</span>

<span class="n">start_end</span> <span class="o">=</span> <span class="p">[</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">]</span>

<span class="n">unit_label</span> <span class="o">=</span> <span class="s2">&quot;p/100m&quot;</span>

<span class="n">unit_value</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">fail_rate</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

<span class="c1"># colors for gradients</span>
<span class="n">cmap2</span> <span class="o">=</span> <span class="n">ck</span><span class="o">.</span><span class="n">cmap2</span>

<span class="c1"># colors for projects</span>
<span class="n">this_palette</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;2020&quot;</span><span class="p">:</span><span class="s2">&quot;dodgerblue&quot;</span><span class="p">,</span> <span class="s2">&quot;2018&quot;</span><span class="p">:</span><span class="s2">&quot;magenta&quot;</span><span class="p">}</span>
<span class="n">this_palettel</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;2020&quot;</span><span class="p">:</span><span class="s2">&quot;teal&quot;</span><span class="p">,</span> <span class="s2">&quot;2018&quot;</span><span class="p">:</span><span class="s2">&quot;indigo&quot;</span><span class="p">}</span>

<span class="c1"># get the data:</span>
<span class="n">survey_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;resources/agg_results_with_land_use_2015.csv&quot;</span><span class="p">)</span>
<span class="n">dfBeaches</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;resources/beaches_with_land_use_rates.csv&quot;</span><span class="p">)</span>
<span class="n">dfCodes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;resources/codes_with_group_names_2015.csv&quot;</span><span class="p">)</span>

<span class="c1"># there is a misspelling in survey data</span>
<span class="n">survey_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;% to agg&quot;</span><span class="p">:</span><span class="s2">&quot;% to ag&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># a common aggregation</span>
<span class="n">agg_pcs_quantity</span> <span class="o">=</span> <span class="p">{</span><span class="n">unit_label</span><span class="p">:</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;quantity&quot;</span><span class="p">:</span><span class="s2">&quot;sum&quot;</span><span class="p">}</span>

<span class="c1"># reference columns</span>
<span class="n">use_these_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span><span class="s2">&quot;loc_date&quot;</span> <span class="p">,</span><span class="s2">&quot;% to buildings&quot;</span><span class="p">,</span> <span class="s2">&quot;% to trans&quot;</span><span class="p">,</span> <span class="s2">&quot;% to recreation&quot;</span><span class="p">,</span> <span class="s2">&quot;% to ag&quot;</span><span class="p">,</span> <span class="s2">&quot;% to woods&quot;</span><span class="p">,</span><span class="s2">&quot;population&quot;</span><span class="p">,</span><span class="s2">&quot;water_name_slug&quot;</span><span class="p">,</span><span class="s2">&quot;streets km&quot;</span><span class="p">,</span> <span class="s2">&quot;intersects&quot;</span><span class="p">,</span> <span class="s2">&quot;groupname&quot;</span><span class="p">,</span><span class="s2">&quot;code&quot;</span><span class="p">]</span>

<span class="c1"># explanatory variables:</span>
<span class="n">luse_exp</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;% to buildings&quot;</span><span class="p">,</span> <span class="s2">&quot;% to recreation&quot;</span><span class="p">,</span> <span class="s2">&quot;% to ag&quot;</span><span class="p">,</span> <span class="s2">&quot;% to woods&quot;</span><span class="p">,</span> <span class="s2">&quot;streets km&quot;</span><span class="p">,</span> <span class="s2">&quot;intersects&quot;</span><span class="p">]</span>

<span class="c1"># lakes that have samples in both years</span>
<span class="n">these_lakes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;zurichsee&quot;</span><span class="p">,</span> <span class="s2">&quot;bielersee&quot;</span><span class="p">,</span> <span class="s2">&quot;lac-leman&quot;</span><span class="p">,</span> <span class="s2">&quot;neuenburgersee&quot;</span><span class="p">,</span> <span class="s2">&quot;walensee&quot;</span><span class="p">,</span> <span class="s2">&quot;thunersee&quot;</span><span class="p">]</span>

<span class="c1"># set the index of the beach data to location slug</span>
<span class="n">dfBeaches</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;slug&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># index the code data</span>
<span class="n">dfCodes</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">dfCodes</span> <span class="o">=</span>  <span class="n">sut</span><span class="o">.</span><span class="n">shorten_the_value</span><span class="p">([</span><span class="s2">&quot;G178&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;metal bottle tops&quot;</span><span class="p">],</span> <span class="n">dfCodes</span><span class="p">)</span>

<span class="c1"># make a map to the code descriptions</span>
<span class="n">code_description_map</span> <span class="o">=</span> <span class="n">dfCodes</span><span class="o">.</span><span class="n">description</span>

<span class="c1"># make a map to the code materials</span>
<span class="n">code_material_map</span> <span class="o">=</span> <span class="n">dfCodes</span><span class="o">.</span><span class="n">material</span>
</pre></div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="more-and-less-since-2018">
<span id="slr-iqaasl"></span><h1><span class="section-number">21. </span>More and less since 2018<a class="headerlink" href="#more-and-less-since-2018" title="Permalink to this headline">Â¶</a></h1>
<p><a href="slr_2017_de.html"> Deutsch </a></p>
<p>he first national beach litter report was produced in 2018. The Swiss Litter Report (SLR) was a project initiated by Gabriele Kuhl  <span id="id1">[<a class="reference internal" href="references.html#id77" title="Gabrielle Kuhl. Stop plastic polution switzerland. URL: http://stoppp.org/.">Kuh</a>]</span> and supported by the World Wildlife Fund Switzerland <span id="id2">[<a class="reference internal" href="references.html#id78" title="World Wildlife Fund. World wildlife fund switzerland. URL: https://www.wwf.ch/fr.">Fun</a>]</span>. The protocol was based on the Guide for monitoring marine litter <span id="id3">[<a class="reference internal" href="references.html#id41" title="George Hanke. Guidance on monitoring of marine litter in european seas. Joint Research Centre of the European Commission, 2013. URL: https://indicit-europa.eu/cms/wp-content/uploads/2017/05/guidance_monitoring_marine_litter_2013.pdf.">Han13</a>]</span>, the project was managed by the WWF and the surveys were conducted by volunteers from both organizations. The project began in April 2017 and ended March 2018 the SLR covered much of the national territory except for the Ticino region.</p>
<p>The SLR collected 1,052 samples from 112 locations. More than 150 trained volunteers from 81 municipalities collected and categorized 98,474 pieces of trash from the shores of 48 lakes and 67 rivers in Switzerland. <span id="id4">[<a class="reference internal" href="references.html#id60" title="Pascal Blarer. The swiss litter report. 2018. URL: http://stoppp.org/researchvalue.">Bla18</a>]</span></p>
<p>The most obvious question is: Was there more or less litter observed in 2020 than 2018? To answer the question the survey locations from each project were first compared based on the land use profile within 1500m of each survey location for each project. The survey results were limited to:</p>
<ol class="simple">
<li><p>Rivers and lakes with samples in both years</p></li>
<li><p>Only objects that were identified in 2018 were considered</p></li>
</ol>
<p>From this subset of data, the median survey total of all objects and the average survey total of the most common objects were compared to identify statistically significant changes in either direction from one project to the next. This test was conducted on two groups of the subset:</p>
<ol class="simple">
<li><p>Rivers and lakes combined with samples from both projects</p></li>
<li><p>Only the lakes with samples from both projects</p></li>
</ol>
<div class="section" id="scope-of-projects-slr-iqaasl">
<h2><span class="section-number">21.1. </span>Scope of projects SLR - IQAASL<a class="headerlink" href="#scope-of-projects-slr-iqaasl" title="Permalink to this headline">Â¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="_images/slr_2017_2_0.png" src="_images/slr_2017_2_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make sure date is time stamp</span>
<span class="n">survey_data</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">survey_data</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># get only the water features that were sampled in 2020</span>
<span class="n">after_2020</span> <span class="o">=</span> <span class="n">survey_data</span><span class="p">[</span><span class="n">survey_data</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s2">&quot;2020-01-01&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">water_name_slug</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">a_data</span> <span class="o">=</span> <span class="n">survey_data</span><span class="p">[</span><span class="n">survey_data</span><span class="o">.</span><span class="n">water_name_slug</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">after_2020</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># convert pcs-m to unit_value</span>
<span class="n">a_data</span><span class="p">[</span><span class="s2">&quot;pcs_m&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">a_data</span><span class="o">.</span><span class="n">pcs_m</span> <span class="o">*</span> <span class="n">unit_value</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
<span class="n">a_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;pcs_m&quot;</span><span class="p">:</span><span class="n">unit_label</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># the date ranges of two projects</span>
<span class="n">first_date_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">a_data</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="s2">&quot;2017-04-01&quot;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">a_data</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;=</span> <span class="s2">&quot;2018-03-31&quot;</span><span class="p">)</span>
<span class="n">second_date_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">a_data</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="s2">&quot;2020-04-01&quot;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">a_data</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;=</span> <span class="s2">&quot;2021-03-31&quot;</span><span class="p">)</span>

<span class="c1"># a df for each set</span>
<span class="n">slr_data</span> <span class="o">=</span> <span class="n">a_data</span><span class="p">[</span><span class="n">first_date_range</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">iqasl_data</span> <span class="o">=</span> <span class="n">a_data</span><span class="p">[</span><span class="n">second_date_range</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># only use codes identified in the first project</span>
<span class="n">these_codes</span> <span class="o">=</span> <span class="n">slr_data</span><span class="p">[</span><span class="n">slr_data</span><span class="o">.</span><span class="n">quantity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="c1"># add a survey year column to each data set</span>
<span class="n">iqasl_data</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;2020&quot;</span>
<span class="n">slr_data</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;2018&quot;</span>

<span class="c1"># put the two sets of data back together</span>
<span class="n">combined_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">iqasl_data</span><span class="p">,</span> <span class="n">slr_data</span><span class="p">])</span>
<span class="n">combined_data</span><span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">combined_data</span><span class="o">.</span><span class="n">quantity</span><span class="o">/</span><span class="n">combined_data</span><span class="p">[</span><span class="n">unit_label</span><span class="p">])</span><span class="o">*</span><span class="n">unit_value</span>

<span class="c1"># unique locations in both years</span>
<span class="n">sdlocs</span> <span class="o">=</span> <span class="n">slr_data</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">iqs</span> <span class="o">=</span> <span class="n">iqasl_data</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="c1"># locations common to both</span>
<span class="n">both_years</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">sdlocs</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">iqs</span><span class="p">))</span>

<span class="c1"># locations specific to each year</span>
<span class="n">just_2017</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sdlocs</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">iqs</span><span class="p">]</span>
<span class="n">j_2020</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">iqs</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sdlocs</span><span class="p">]</span>

<span class="c1"># use only the codes identified in 2017, the protocol only called for certain MLW codes</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">combined_data</span><span class="p">[</span><span class="n">combined_data</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">these_codes</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># scale the streets value</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;streets km&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">streets</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="land-use-profile-of-survey-locations">
<h3><span class="section-number">21.1.1. </span>Land use profile of survey locations<a class="headerlink" href="#land-use-profile-of-survey-locations" title="Permalink to this headline">Â¶</a></h3>
<p>The land use profile is the measurable properties that are geolocated and can be extracted from the current versions of <em>Statistique Suisse de la superficie</em> <span id="id5">[<a class="reference internal" href="references.html#id35" title="Confederation. Statistique de la superficie selon nomenclature 2004 - utilisation du sol, description: mÃ©tainformations sur les gÃ©odonnÃ©es. 2021. URL: https://www.bfs.admin.ch/bfs/en/home/services/geostat/swiss-federal-statistics-geodata/land-use-cover-suitability/swiss-land-use-statistics/standard-nomenclature.html.">Con21a</a>]</span> and <em>swissTlmRegio</em> <span id="id6">[<a class="reference internal" href="references.html#id36" title="Confederation. Swisstlmregio: le modÃ¨le numÃ©rique de la suisse Ã  petite Ã©chelle. 2021. URL: https://www.swisstopo.admin.ch/fr/geodata/landscape/tlmregio.html.">Con21b</a>]</span>. The land use profile is an estimate of the type and amplitude of economic activity near the survey locations. The following values were calculated within a radius of 1500m of each survey location:</p>
<ol class="simple">
<li><p>% of surface area attributed to buildings</p></li>
<li><p>% of surface area left to woods</p></li>
<li><p>% of surface area attributed to outdoor activities</p></li>
<li><p>% of surface area attributed to aggriculture</p></li>
<li><p>length in meters of all roadways</p></li>
<li><p>number of river discharge intersections</p></li>
</ol>
<p>As of June 22, 2021, the land use data for Walensee was not up to date. Walensse has been estimated by visually inspecting the relevant map layers and comparing land use rates to other locations that have a similar population. For details on how this is calculated and why it is important see The land use profile. <a class="reference internal" href="land_use_correlation.html#luseprofile"><span class="std std-ref"><em>The land use profile</em></span></a>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># !!walensee landuse is approximated by comparing the land use profile from similar locations!!</span>
<span class="c1"># the classification for that part of switzerland is incomplete for the current estimates</span>
<span class="c1"># the land use profile of wychely - brienzersee was used for walenstadt-wyss (more prairie, buildings less woods)</span>
<span class="c1"># the land use profile of grand-clos - lac-leman was used for other locations on walensee (more woods, less buildings, less praire and agg)</span>
<span class="n">luse_wstdt</span> <span class="o">=</span> <span class="n">dfBeaches</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;wycheley&quot;</span><span class="p">][[</span><span class="s2">&quot;population&quot;</span><span class="p">,</span><span class="s2">&quot;% to buildings&quot;</span><span class="p">,</span> <span class="s2">&quot;% to trans&quot;</span><span class="p">,</span> <span class="s2">&quot;% to recreation&quot;</span><span class="p">,</span> <span class="s2">&quot;% to agg&quot;</span><span class="p">,</span> <span class="s2">&quot;% to woods&quot;</span><span class="p">]]</span>
<span class="n">estimate_luse</span> <span class="o">=</span> <span class="n">dfBeaches</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;grand-clos&quot;</span><span class="p">][[</span><span class="s2">&quot;population&quot;</span><span class="p">,</span><span class="s2">&quot;% to buildings&quot;</span><span class="p">,</span> <span class="s2">&quot;% to trans&quot;</span><span class="p">,</span> <span class="s2">&quot;% to recreation&quot;</span><span class="p">,</span> <span class="s2">&quot;% to agg&quot;</span><span class="p">,</span> <span class="s2">&quot;% to woods&quot;</span><span class="p">]]</span>

<span class="c1"># seperate out the locations that aren&quot;t walenstadt</span>
<span class="n">wlsnsee_locs_not_wstdt</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;gasi-strand&quot;</span><span class="p">,</span> <span class="s2">&quot;untertenzen&quot;</span><span class="p">,</span> <span class="s2">&quot;mols-rocks&quot;</span><span class="p">,</span> <span class="s2">&quot;seeflechsen&quot;</span><span class="p">,</span> <span class="s2">&quot;seemuhlestrasse-strand&quot;</span><span class="p">,</span> <span class="s2">&quot;muhlehorn-dorf&quot;</span><span class="p">,</span> <span class="s2">&quot;murg-bad&quot;</span><span class="p">,</span> <span class="s2">&quot;flibach-river-right-bank&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">a_param</span> <span class="ow">in</span> <span class="n">estimate_luse</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">wlsnsee_locs_not_wstdt</span><span class="p">),</span> <span class="n">a_param</span><span class="p">]</span> <span class="o">=</span> <span class="n">estimate_luse</span><span class="p">[</span><span class="n">a_param</span><span class="p">]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;walensee_walenstadt_wysse&quot;</span><span class="p">,</span> <span class="n">a_param</span><span class="p">]</span> <span class="o">=</span> <span class="n">luse_wstdt</span><span class="p">[</span><span class="n">a_param</span><span class="p">]</span>
    
<span class="n">dfdt</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">use_these_cols</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">agg_pcs_quantity</span><span class="p">)</span>

<span class="c1"># chart the distribtuion of survey results with respect to the land use profile</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">luse_exp</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">luse_exp</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="s2">&quot;row&quot;</span><span class="p">)</span>

<span class="n">data</span><span class="o">=</span><span class="n">dfdt</span><span class="p">[(</span><span class="n">dfdt</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2018&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">use_these_cols</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;p/100m&quot;</span><span class="p">:</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;quantity&quot;</span><span class="p">:</span><span class="s2">&quot;sum&quot;</span><span class="p">})</span>
<span class="n">data2</span><span class="o">=</span><span class="n">dfdt</span><span class="p">[(</span><span class="n">dfdt</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2020&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">use_these_cols</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;p/100m&quot;</span><span class="p">:</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;quantity&quot;</span><span class="p">:</span><span class="s2">&quot;sum&quot;</span><span class="p">})</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">luse_exp</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
    <span class="c1"># land use data for each project</span>
    <span class="n">the_data</span> <span class="o">=</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>       
    <span class="n">the_data2</span> <span class="o">=</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">data2</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    
    <span class="c1"># the median value    </span>
    <span class="n">the_median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">median_two</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data2</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>    
    
    <span class="c1"># plot the curves</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span> <span class="n">the_data</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">the_data</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;SLR&quot;</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">the_data2</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">the_data2</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;IQAASL&quot;</span><span class="p">)</span>
    
    <span class="c1"># plot the median and drop horzontal and vertical lines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">the_median</span><span class="p">],</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;the median SLR&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">the_median</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">xmax</span><span class="o">=</span><span class="n">the_median</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="c1"># plot the median and drop horzontal and vertical lines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">median_two</span><span class="p">],</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;the median IQAASL&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">median_two</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">xmax</span><span class="o">=</span><span class="n">median_two</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Percent of samples&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k</span><span class="p">)</span>
    
<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">.9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">% la</span><span class="s2">nd use within 1500m of the survey location&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.97</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>    
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.9</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/slr_2017_5_0.png" src="_images/slr_2017_5_0.png" />
</div>
</div>
<p><em><strong>Above</strong> Distribution of number of surveys with respect to land use profile SLR - IQAASL</em></p>
<p>The sample locations in the SLR had a greater percent of land attributed to agriculture and a denser road network compared to locations in IQAASL. The percent of land attributed to woods diverges after the median at which point the locations in IQAASL had a greater percentage of land attributed to woods compared to SLR.</p>
<p>The population (not shown) is taken from statpop 2018  <span id="id7">[<a class="reference internal" href="references.html#id8" title="Confederation. Statistique de la population et des mÃ©nages. URL: https://www.bfs.admin.ch/bfs/en/home/statistics/population/surveys/statpop.html.">Con</a>]</span>.     The smallest population was 442 and the largest was 415,357. At least 50% of the samples came from municipalities with a population of 13,000 or less.</p>
<p>If percent of land use attributed to agriculture is a sign of urbanization, then the survey areas in 2020 were slightly more urban than 2018.</p>
</div>
</div>
<div class="section" id="results-lakes-and-rivers">
<h2><span class="section-number">21.2. </span>Results lakes and rivers<a class="headerlink" href="#results-lakes-and-rivers" title="Permalink to this headline">Â¶</a></h2>
<p>Considering only lakes and rivers that have samples in both years, there were more samples and trash collected from fewer locations in 2018 than 2020. However, on a pieces per meter basis the median was greater in 2020.</p>
<div class="section" id="distribution-of-results-2018-and-2020">
<h3><span class="section-number">21.2.1. </span>Distribution of results 2018 and 2020<a class="headerlink" href="#distribution-of-results-2018-and-2020" title="Permalink to this headline">Â¶</a></h3>
<p><em><strong>Top Left:</strong> survey totals by date. <strong>Top right:</strong> median monthly survey total. <strong>bottom Left:</strong> number of samples with respect to the survey total. <strong>bottom right:</strong> empirical cumulative distribution of survey totals.</em></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># group by survey and sum all the objects for each survey AKA: survey total</span>
<span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span><span class="s2">&quot;water_name_slug&quot;</span><span class="p">,</span><span class="s2">&quot;loc_date&quot;</span><span class="p">,</span> <span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;date&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;lakes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">water_name_slug</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">these_lakes</span><span class="p">)</span>

<span class="c1"># get the ecdf for both projects</span>
<span class="n">ecdf_2017</span> <span class="o">=</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2018&quot;</span><span class="p">][</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">ecdf_2020</span> <span class="o">=</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2020&quot;</span><span class="p">][</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="c1"># get the ecddf for the condition lakes in both years</span>
<span class="n">l2017</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">water_name_slug</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">these_lakes</span><span class="p">))</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2018&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">l2020</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">water_name_slug</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">these_lakes</span><span class="p">))</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2020&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">ecdf_2017l</span> <span class="o">=</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">l2017</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">ecdf_2020l</span> <span class="o">=</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">l2020</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="c1"># convenience func and dict to display table values</span>
<span class="n">change_names</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;count&quot;</span><span class="p">:</span><span class="s2">&quot;# samples&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">:</span><span class="sa">F</span><span class="s2">&quot;average </span><span class="si">{</span><span class="n">unit_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">:</span><span class="s2">&quot;standard deviation&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span><span class="sa">F</span><span class="s2">&quot;min </span><span class="si">{</span><span class="n">unit_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="s2">&quot;25%&quot;</span><span class="p">:</span><span class="s2">&quot;25%&quot;</span><span class="p">,</span>  <span class="s2">&quot;50%&quot;</span><span class="p">:</span><span class="s2">&quot;50%&quot;</span><span class="p">,</span> <span class="s2">&quot;75%&quot;</span><span class="p">:</span><span class="s2">&quot;75%&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span><span class="sa">F</span><span class="s2">&quot;max </span><span class="si">{</span><span class="n">unit_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span><span class="s2">&quot;min p/100&quot;</span><span class="p">,</span> <span class="s2">&quot;total objects&quot;</span><span class="p">:</span><span class="s2">&quot;total objects&quot;</span><span class="p">,</span> <span class="s2">&quot;# locations&quot;</span><span class="p">:</span><span class="s2">&quot;# locations&quot;</span><span class="p">,</span> <span class="s2">&quot;survey year&quot;</span><span class="p">:</span><span class="s2">&quot;survey year&quot;</span><span class="p">}</span>

<span class="c1"># group by survey year and use pd.describe to get basic stats</span>
<span class="n">som_1720</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;survey year&quot;</span><span class="p">)[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># add total quantity and number of unique locations</span>
<span class="n">som_1720</span><span class="p">[</span><span class="s2">&quot;total objects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">som_1720</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">som_1720</span><span class="p">[</span><span class="s2">&quot;# locations&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">som_1720</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>

<span class="c1"># make columns names more descriptive</span>
<span class="n">som_1720</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="n">change_names</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ab</span> <span class="o">=</span> <span class="n">som_1720</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># melt that on survey year</span>
<span class="n">c_s</span> <span class="o">=</span> <span class="n">ab</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">])</span>

<span class="c1"># pivot on survey year</span>
<span class="n">combined_summary</span> <span class="o">=</span> <span class="n">c_s</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># format for printing</span>
<span class="n">combined_summary</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">combined_summary</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">combined_summary</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">combined_summary</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># change the index to date</span>
<span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># get the median monthly value</span>
<span class="n">monthly_2017</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2018&quot;</span><span class="p">][</span><span class="s2">&quot;p/100m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="c1"># change the date to the name of the month for charting</span>
<span class="n">months_2017</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;month&quot;</span><span class="p">:[</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;%b&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">monthly_2017</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">unit_label</span><span class="p">:</span><span class="n">monthly_2017</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>

<span class="c1"># repeat for 2020</span>
<span class="n">monthly_2020</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2020&quot;</span><span class="p">][</span><span class="s2">&quot;p/100m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">months_2020</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;month&quot;</span><span class="p">:[</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;%b&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">monthly_2020</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">unit_label</span><span class="p">:</span><span class="n">monthly_2020</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>

<span class="c1"># set the date intervals for the chart</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">MonthLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">months_fmt</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s2">&quot;%b&quot;</span><span class="p">)</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">()</span>

<span class="c1"># set a y limit axis:</span>
<span class="n">the_90th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;p/100m&quot;</span><span class="p">],</span> <span class="mi">95</span><span class="p">)</span>

<span class="c1"># chart that</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># set axs and lables</span>
<span class="n">axone</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">axtwo</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">axthree</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">axfour</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">axone</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">unit_label</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>
<span class="n">axone</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">months</span><span class="p">)</span>
<span class="n">axone</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
<span class="n">axone</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>

<span class="n">axtwo</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">axtwo</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">unit_label</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>
<span class="n">axtwo</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">the_90th</span><span class="p">)</span>

<span class="n">axthree</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;# of samples&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>
<span class="n">axthree</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">unit_label</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k</span><span class="p">)</span>

<span class="n">axfour</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f samples&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>
<span class="n">axfour</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">unit_label</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k</span><span class="p">)</span>

<span class="c1"># histogram data:</span>
<span class="n">data_long</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="s2">&quot;loc_date&quot;</span><span class="p">,</span> <span class="n">unit_label</span><span class="p">]],</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span><span class="s2">&quot;loc_date&quot;</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">(</span><span class="n">unit_label</span><span class="p">,),</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;survey total&quot;</span><span class="p">)</span>
<span class="n">data_long</span><span class="p">[</span><span class="s2">&quot;year_bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data_long</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2018&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># scatter plot of surveys both years</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;p/100m&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;survey total&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">this_palette</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axone</span><span class="p">)</span>
<span class="c1"># sns.scatterplot(data=data[data.water_name_slug.isin(these_lakes)], x=&quot;date&quot;, y=&quot;p/100m&quot;, color=&quot;red&quot;, s=34, ec=&quot;white&quot;,label=&quot;survey total&quot;, hue=&quot;survey year&quot;, palette= this_palettel, ax=axone)</span>
<span class="n">axone</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">)</span>

<span class="c1"># monthly median</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">months_2017</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">unit_label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">F</span><span class="s2">&quot;Monthly median:2018&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axtwo</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">months_2020</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">unit_label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">F</span><span class="s2">&quot;Monthly median:2020&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axtwo</span><span class="p">)</span>

<span class="c1"># histogram</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_long</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;survey total&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="s2">&quot;stack&quot;</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="n">this_palette</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axthree</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="mi">20</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">80</span><span class="p">)])</span>

<span class="c1"># empirical cumulative distribution</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ecdf_2017</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ecdf_2017</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axfour</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;survey results 2018&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ecdf_2020</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ecdf_2020</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axfour</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;survey results 2020&quot;</span><span class="p">)</span>


<span class="n">axfour</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span> 
<span class="n">axfour</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span> 

<span class="n">axfour</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center right&quot;</span><span class="p">)</span>
<span class="n">axfour</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axfour</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_82185/2131065129.py:111: MatplotlibDeprecationWarning: The &#39;b&#39; parameter of grid() has been renamed &#39;visible&#39; since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
  axfour.grid(b=True, which=&quot;minor&quot;,linewidth=0.5)
</pre></div>
</div>
<img alt="_images/slr_2017_12_1.png" src="_images/slr_2017_12_1.png" />
</div>
</div>
</div>
<div class="section" id="summary-data-and-material-types-2018-and-2020">
<h3><span class="section-number">21.2.2. </span>Summary data and material types 2018 and 2020<a class="headerlink" href="#summary-data-and-material-types-2018-and-2020" title="Permalink to this headline">Â¶</a></h3>
<p><em><strong>Left:</strong> summary of survey totals. <strong>Right:</strong> material type</em></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># material totals</span>
<span class="n">mat_total</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># add material type:</span>
<span class="n">mat_total</span><span class="p">[</span><span class="s2">&quot;mat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat_total</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">code_material_map</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>

<span class="c1"># the cumulative sum of material by category</span>
<span class="n">mat_total</span> <span class="o">=</span> <span class="n">mat_total</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="s2">&quot;mat&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># get the % of total and fail rate for each object from each year</span>
<span class="c1"># add the yearly total column</span>
<span class="n">mat_total</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mat_total</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2018&quot;</span><span class="p">,</span> <span class="s2">&quot;yt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat_total</span><span class="p">[</span><span class="n">mat_total</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2018&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">mat_total</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mat_total</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2020&quot;</span><span class="p">,</span> <span class="s2">&quot;yt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat_total</span><span class="p">[</span><span class="n">mat_total</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2020&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># get % of total</span>
<span class="n">mat_total</span><span class="p">[</span><span class="s2">&quot;pt&quot;</span><span class="p">]</span> <span class="o">=</span><span class="p">((</span><span class="n">mat_total</span><span class="o">.</span><span class="n">quantity</span><span class="o">/</span><span class="n">mat_total</span><span class="o">.</span><span class="n">yt</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># format for printing:</span>
<span class="n">mat_total</span><span class="p">[</span><span class="s2">&quot;pt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat_total</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="n">mat_total</span><span class="p">[</span><span class="s2">&quot;quantity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat_total</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># pivot and rename columns</span>
<span class="n">m_t</span> <span class="o">=</span> <span class="n">mat_total</span><span class="p">[[</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span><span class="s2">&quot;mat&quot;</span><span class="p">,</span> <span class="s2">&quot;quantity&quot;</span><span class="p">,</span> <span class="s2">&quot;pt&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s2">&quot;mat&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;pt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">m_t</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;mat&quot;</span><span class="p">:</span><span class="s2">&quot;material&quot;</span><span class="p">,</span> <span class="s2">&quot;pt&quot;</span><span class="p">:</span><span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f total&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># put that in a table</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">axone</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">axtwo</span><span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># convenience func</span>
<span class="n">sut</span><span class="o">.</span><span class="n">hide_spines_ticks_grids</span><span class="p">(</span><span class="n">axone</span><span class="p">)</span>
<span class="n">sut</span><span class="o">.</span><span class="n">hide_spines_ticks_grids</span><span class="p">(</span><span class="n">axtwo</span><span class="p">)</span>

<span class="c1"># summary data table</span>
<span class="n">a_table</span> <span class="o">=</span> <span class="n">axone</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">cellText</span><span class="o">=</span><span class="n">combined_summary</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>  <span class="n">colLabels</span><span class="o">=</span><span class="n">combined_summary</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">colWidths</span><span class="o">=</span><span class="p">[</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.25</span><span class="p">,</span><span class="mf">.25</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower center&quot;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">the_material_table_data</span> <span class="o">=</span> <span class="n">sut</span><span class="o">.</span><span class="n">make_a_summary_table</span><span class="p">(</span><span class="n">a_table</span><span class="p">,</span><span class="n">combined_summary</span><span class="p">,</span><span class="n">combined_summary</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">s_et_bottom_row</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># material totals</span>
<span class="n">a_table</span> <span class="o">=</span> <span class="n">axtwo</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">cellText</span><span class="o">=</span><span class="n">m_t</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>  <span class="n">colLabels</span><span class="o">=</span><span class="n">m_t</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">colWidths</span><span class="o">=</span><span class="p">[</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.25</span><span class="p">,</span><span class="mf">.25</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower center&quot;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">the_material_table_data</span> <span class="o">=</span> <span class="n">sut</span><span class="o">.</span><span class="n">make_a_summary_table</span><span class="p">(</span><span class="n">a_table</span><span class="p">,</span><span class="n">m_t</span><span class="p">,</span><span class="n">m_t</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">s_et_bottom_row</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/slr_2017_15_0.png" src="_images/slr_2017_15_0.png" />
</div>
</div>
<p><em>Chemicals refers to parafin wax and wood refers to treated or wood shaped for use</em></p>
<div class="section" id="difference-of-medians-2018-2020">
<h4><span class="section-number">21.2.2.1. </span>Difference of medians 2018 - 2020<a class="headerlink" href="#difference-of-medians-2018-2020" title="Permalink to this headline">Â¶</a></h4>
<p>The observed difference of the medians between the two projects is  14p/100m, differences of this magnitude would not be perceived and may be due to chance. A permutation test was conducted to test the hypothesis:</p>
<blockquote>
<div><p><em>Null hypothesis:</em> The median survey result from 2018 is not statistically different than the median from 2020. The observed difference is due to chance.</p>
</div></blockquote>
<blockquote>
<div><p><em>Alternate hypothesis:</em> The median survey result from 2018 is not statistically different than the median from 2020. The observed difference in the samples is not due to chance.</p>
</div></blockquote>
<p><em><strong>Below:</strong> The distribution of the difference of medians between the two sampling periods. The survey results were shuffled and sampled 5,000 times on the survey year column. The null hypothesis can not be rejected, supporting the argument that the median survey results were approximately equal year over year.</em></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data for testing</span>
<span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># get the survey total for each survey keep the survey year column</span>
<span class="n">pre_shuffle</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;loc_date&quot;</span><span class="p">,</span> <span class="s2">&quot;survey year&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># get the median from each year</span>
<span class="n">observed_median</span> <span class="o">=</span> <span class="n">pre_shuffle</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;survey year&quot;</span><span class="p">)[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="c1"># get the dif mu_2020 - mu_2017</span>
<span class="n">observed_dif</span> <span class="o">=</span> <span class="n">observed_median</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">observed_median</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">]</span>

<span class="c1"># a place to store the sample statistics</span>
<span class="n">new_medians</span><span class="o">=</span><span class="p">[]</span>

<span class="c1"># resampling:</span>
<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5000</span><span class="p">):</span>
    
    <span class="c1"># shuffle the entire survey year column</span>
    <span class="n">pre_shuffle</span><span class="p">[</span><span class="s2">&quot;new_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pre_shuffle</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
    <span class="c1"># get the median for both &quot;survey years&quot;</span>
    <span class="n">b</span><span class="o">=</span><span class="n">pre_shuffle</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;new_class&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
    <span class="c1"># get the change and store it    </span>
    <span class="n">new_medians</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">b</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># calculate the empirical p</span>
<span class="n">emp_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">new_medians</span> <span class="o">&lt;=</span> <span class="n">observed_dif</span> <span class="p">)</span><span class="o">/</span> <span class="mi">5000</span>

<span class="c1"># chart the results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">new_medians</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">F</span><span class="s2">&quot;observed $</span><span class="se">\u0394</span><span class="s2">\mu$ = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">observed_dif</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">, perm=5000, p=</span><span class="si">{</span><span class="n">emp_p</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">title_k14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;permutations&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$\mu$ 2020 - $\mu$ 2018&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/slr_2017_18_0.png" src="_images/slr_2017_18_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="the-most-common-objects-year-over-year">
<h3><span class="section-number">21.2.3. </span>The most common objects year over year<a class="headerlink" href="#the-most-common-objects-year-over-year" title="Permalink to this headline">Â¶</a></h3>
<p><em><strong>Below:</strong> The most common objects are the ten most abundant by quantity AND/OR objects identified in at least 50% of all surveys. This accounts for 60% - 80% of all objects identified in any given survey period. The most common objects are not the same year over year. To assess the changes only the objects that were the most common in both years are included. <strong>Left:</strong> most common objects 2018, <strong>right:</strong> most common objects 2020</em></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># code totals by project</span>
<span class="n">c_totals</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;quantity&quot;</span><span class="p">:</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;fail&quot;</span><span class="p">:</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="n">unit_label</span><span class="p">:</span><span class="s2">&quot;median&quot;</span><span class="p">})</span>

<span class="c1"># calculate the fail rate % of total for each code and survey year</span>
<span class="k">for</span> <span class="n">a_year</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">,</span> <span class="s2">&quot;2020&quot;</span><span class="p">]:</span>
    <span class="n">c_totals</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c_totals</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">a_year</span><span class="p">,</span> <span class="s2">&quot;fail rate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">c_totals</span><span class="o">.</span><span class="n">fail</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">a_year</span><span class="p">]</span><span class="o">.</span><span class="n">loc_date</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
    <span class="n">c_totals</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c_totals</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">a_year</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">c_totals</span><span class="o">.</span><span class="n">quantity</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">a_year</span><span class="p">]</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
    
<span class="c1"># get all the instances where the fail rate is &gt; fail_rate</span>
<span class="n">c_50</span> <span class="o">=</span> <span class="n">c_totals</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c_totals</span><span class="p">[</span><span class="s2">&quot;fail rate&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">fail_rate</span><span class="p">]</span>

<span class="c1"># the top ten from each project</span>
<span class="n">ten_2017</span> <span class="o">=</span> <span class="n">c_totals</span><span class="p">[</span><span class="n">c_totals</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2018&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;quantity&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">ten_2020</span> <span class="o">=</span> <span class="n">c_totals</span><span class="p">[</span><span class="n">c_totals</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2020&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;quantity&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="c1"># combine the most common from each year with the top ten from each year</span>
<span class="c1"># most common 2017</span>
<span class="n">mcom_2017</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">c_50</span><span class="p">[</span><span class="n">c_50</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;2018&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span><span class="o">|</span><span class="nb">set</span><span class="p">(</span><span class="n">ten_2017</span><span class="p">))</span>

<span class="c1"># most common 2020</span>
<span class="n">mcom_2020</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">c_50</span><span class="p">[</span><span class="n">c_50</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;2020&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span><span class="o">|</span><span class="nb">set</span><span class="p">(</span><span class="n">ten_2020</span><span class="p">))</span>

<span class="c1"># the set of objects that were the most common in both years:</span>
<span class="n">mcom</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">mcom_2017</span><span class="p">)</span><span class="o">&amp;</span><span class="nb">set</span><span class="p">(</span><span class="n">mcom_2020</span><span class="p">))</span>

<span class="c1"># get the data</span>
<span class="n">com_2017</span> <span class="o">=</span> <span class="n">c_totals</span><span class="p">[(</span><span class="n">c_totals</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2018&quot;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">c_totals</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">mcom</span><span class="p">))]</span>
<span class="n">com_2020</span> <span class="o">=</span> <span class="n">c_totals</span><span class="p">[(</span><span class="n">c_totals</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2020&quot;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">c_totals</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">mcom</span><span class="p">))]</span>

<span class="c1"># format values for table</span>
<span class="n">table_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">chart_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">,</span> <span class="s2">&quot;2020&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">som_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">com_2017</span><span class="p">,</span> <span class="n">com_2020</span><span class="p">]):</span>
    <span class="n">som_data</span> <span class="o">=</span> <span class="n">som_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">)</span>
    <span class="n">som_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;quantity&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">som_data</span><span class="p">[</span><span class="s2">&quot;item&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">som_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">code_description_map</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
    <span class="n">som_data</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">som_data</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f total&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
    <span class="n">som_data</span><span class="p">[</span><span class="s2">&quot;quantity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">som_data</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">som_data</span><span class="p">[</span><span class="s2">&quot;fail rate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">som_data</span><span class="p">[</span><span class="s2">&quot;fail rate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
    <span class="n">som_data</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span> <span class="o">=</span> <span class="n">som_data</span><span class="p">[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>    
    <span class="n">table_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">chart_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span><span class="n">som_data</span><span class="p">})</span>

<span class="c1"># the columns needed</span>
<span class="n">cols_to_use</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span><span class="s2">&quot;Item&quot;</span><span class="p">,</span><span class="s2">&quot;quantity&quot;</span><span class="p">:</span><span class="s2">&quot;Quantity&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f total&quot;</span><span class="p">:</span><span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f total&quot;</span><span class="p">,</span> <span class="s2">&quot;fail rate&quot;</span><span class="p">:</span><span class="s2">&quot;fail rate&quot;</span><span class="p">,</span> <span class="n">unit_label</span><span class="p">:</span><span class="n">unit_label</span><span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">10</span><span class="o">*</span><span class="mf">.8</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">this_table</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table_data</span><span class="p">):</span>
    <span class="n">this_ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
    <span class="n">sut</span><span class="o">.</span><span class="n">hide_spines_ticks_grids</span><span class="p">(</span><span class="n">this_ax</span><span class="p">)</span>
    <span class="n">the_first_table_data</span> <span class="o">=</span> <span class="n">this_ax</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">table_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">chart_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">cols_to_use</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>  <span class="n">colLabels</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">cols_to_use</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">colWidths</span><span class="o">=</span><span class="p">[</span><span class="mf">.48</span><span class="p">,</span> <span class="mf">.13</span><span class="p">,</span><span class="mf">.13</span><span class="p">,</span><span class="mf">.13</span><span class="p">,</span> <span class="mf">.13</span><span class="p">],</span> <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">a_summary_table_one</span> <span class="o">=</span> <span class="n">sut</span><span class="o">.</span><span class="n">make_a_summary_table</span><span class="p">(</span><span class="n">the_first_table_data</span><span class="p">,</span><span class="n">table_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">chart_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">cols_to_use</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">cols_to_use</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">])</span>
    <span class="n">this_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">chart_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/slr_2017_20_0.png" src="_images/slr_2017_20_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="results-lakes-2018-and-2020">
<h2><span class="section-number">21.3. </span>Results lakes 2018 and 2020<a class="headerlink" href="#results-lakes-2018-and-2020" title="Permalink to this headline">Â¶</a></h2>
<p>The following lakes were sampled in both project years:</p>
<ol class="simple">
<li><p>Zurichsee</p></li>
<li><p>Bielersee</p></li>
<li><p>Neuenburgersee</p></li>
<li><p>Walensee</p></li>
<li><p>Lac LÃ©man</p></li>
<li><p>Thunersee</p></li>
</ol>
<p>When considering the six lakes (above), in 2020 there were more samples and locations and greater quantities of litter collected, but the median and average were both lower with respect to 2018.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p><em><strong>Top Left:</strong> survey totals by date, <strong>Top right:</strong> median monthly survey total, <strong>bottom Left:</strong> number of samples with respect to the survey total, <strong>bottom right:</strong> empirical cumulative distribution of survey totals</em></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">lks_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span><span class="s2">&quot;loc_date&quot;</span><span class="p">,</span> <span class="s2">&quot;date&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># the empirical distributions for each year</span>
<span class="n">ecdf_2017</span> <span class="o">=</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2018&quot;</span><span class="p">][</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">ecdf_2020</span> <span class="o">=</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2020&quot;</span><span class="p">][</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="c1"># get the x,y vals for each year</span>
<span class="n">ecdf_2017_x</span><span class="p">,</span> <span class="n">ecdf_2017_y</span> <span class="o">=</span> <span class="n">ecdf_2017</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ecdf_2017</span><span class="o">.</span><span class="n">y</span>
<span class="n">ecdf_2020_x</span><span class="p">,</span> <span class="n">ecdf_2020_y</span> <span class="o">=</span> <span class="n">ecdf_2020</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ecdf_2020</span><span class="o">.</span><span class="n">y</span>

<span class="n">the_90th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">unit_label</span><span class="p">],</span> <span class="mi">95</span><span class="p">)</span>

<span class="c1"># the monthly plots</span>
<span class="n">just_2017</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2018&quot;</span><span class="p">][</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">monthly_2017</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">just_2017</span><span class="p">)</span>
<span class="n">monthly_2017</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">monthly_2017</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">monthly_2017</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;%b&quot;</span><span class="p">))</span>

<span class="n">just_2020</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2020&quot;</span><span class="p">][</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">monthly_2020</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">just_2020</span><span class="p">)</span>
<span class="n">monthly_2020</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">monthly_2020</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">monthly_2020</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;%b&quot;</span><span class="p">))</span>

<span class="c1"># long form data for histogram</span>
<span class="n">data_long</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="s2">&quot;p/100m&quot;</span><span class="p">]],</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;p/100m&quot;</span><span class="p">,),</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;survey total&quot;</span><span class="p">)</span>
<span class="n">data_long</span><span class="p">[</span><span class="s2">&quot;year_bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data_long</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2018&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data_long</span> <span class="o">=</span> <span class="n">data_long</span><span class="p">[</span><span class="n">data_long</span><span class="p">[</span><span class="s2">&quot;survey total&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">the_90th</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># set axs and labels</span>
<span class="n">axone</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">axtwo</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">axthree</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">axfour</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">axone</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;pieces of trash per 100m&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>
<span class="n">axone</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>

<span class="n">axone</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">months</span><span class="p">)</span>
<span class="n">axone</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>

<span class="n">axtwo</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">axtwo</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;pieces of trash per 100m&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>

<span class="n">axthree</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;nummber of surveys&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>
<span class="n">axthree</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;pieces of trash per 100m&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k</span><span class="p">)</span>
<span class="n">axtwo</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">the_90th</span><span class="p">)</span>

<span class="n">axfour</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;percent of surveys&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>
<span class="n">axfour</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;pieces of trash per 100m&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k</span><span class="p">)</span>

<span class="c1"># all samples scatter</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">unit_label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">34</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;survey total&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span> <span class="n">this_palette</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axone</span><span class="p">)</span>

<span class="c1"># monthly medians</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">monthly_2017</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">unit_label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">F</span><span class="s2">&quot;Monthly median:2018&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axtwo</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">monthly_2020</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">unit_label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="sa">F</span><span class="s2">&quot;Monthly median:2020&quot;</span><span class="p">,</span>  <span class="n">ax</span><span class="o">=</span><span class="n">axtwo</span><span class="p">)</span>

<span class="c1"># histogram of survey results</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_long</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;survey total&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="s2">&quot;stack&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">this_palette</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axthree</span><span class="p">)</span>

<span class="c1"># ecdfs</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ecdf_2017_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ecdf_2017_y</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axfour</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;survey results 2018&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ecdf_2020_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ecdf_2020_y</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axfour</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;survey results 2020&quot;</span><span class="p">)</span>

<span class="n">axfour</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span> 
<span class="n">axfour</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span> 
<span class="n">axfour</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center right&quot;</span><span class="p">)</span>
<span class="n">axfour</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axfour</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">axone</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_82185/1905224855.py:72: MatplotlibDeprecationWarning: The &#39;b&#39; parameter of grid() has been renamed &#39;visible&#39; since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
  axfour.grid(b=True, which=&quot;minor&quot;,linewidth=0.5)
</pre></div>
</div>
<img alt="_images/slr_2017_24_1.png" src="_images/slr_2017_24_1.png" />
</div>
</div>
<p><em><strong>Left:</strong> summary of survey totals, <strong>right:</strong> material type</em></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># group by survey year and use pd.describe to get basic stats</span>
<span class="n">som_1720</span> <span class="o">=</span> <span class="n">lks_dt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;survey year&quot;</span><span class="p">)[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># add total quantity and number of unique locations</span>
<span class="n">som_1720</span><span class="p">[</span><span class="s2">&quot;total objects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">som_1720</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">som_1720</span><span class="p">[</span><span class="s2">&quot;# locations&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">som_1720</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>

<span class="c1"># make columns names more descriptive</span>
<span class="n">som_1720</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="n">change_names</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ab</span> <span class="o">=</span> <span class="n">som_1720</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># melt that on survey year</span>
<span class="n">c_s</span> <span class="o">=</span> <span class="n">ab</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">])</span>

<span class="c1"># pivot on survey year</span>
<span class="n">combined_summary</span> <span class="o">=</span> <span class="n">c_s</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># format for printing</span>
<span class="n">combined_summary</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">combined_summary</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">combined_summary</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">combined_summary</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># material totals</span>
<span class="n">mat_total</span> <span class="o">=</span> <span class="n">lks_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># add material type:</span>
<span class="n">mat_total</span><span class="p">[</span><span class="s2">&quot;mat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat_total</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">code_material_map</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>

<span class="c1"># the most common codes for each year</span>
<span class="n">mat_total</span> <span class="o">=</span> <span class="n">mat_total</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="s2">&quot;mat&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># get the % of total and fail rate for each object from each year</span>
<span class="c1"># add the yearly total column</span>
<span class="n">mat_total</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mat_total</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2018&quot;</span><span class="p">,</span> <span class="s2">&quot;yt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat_total</span><span class="p">[</span><span class="n">mat_total</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2018&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">mat_total</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mat_total</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2020&quot;</span><span class="p">,</span> <span class="s2">&quot;yt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat_total</span><span class="p">[</span><span class="n">mat_total</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2020&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># get % of total</span>
<span class="n">mat_total</span><span class="p">[</span><span class="s2">&quot;pt&quot;</span><span class="p">]</span> <span class="o">=</span><span class="p">((</span><span class="n">mat_total</span><span class="o">.</span><span class="n">quantity</span><span class="o">/</span><span class="n">mat_total</span><span class="o">.</span><span class="n">yt</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># format for printing:</span>
<span class="n">mat_total</span><span class="p">[</span><span class="s2">&quot;pt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat_total</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="n">mat_total</span><span class="p">[</span><span class="s2">&quot;quantity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat_total</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">m_t</span> <span class="o">=</span> <span class="n">mat_total</span><span class="p">[[</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span><span class="s2">&quot;mat&quot;</span><span class="p">,</span> <span class="s2">&quot;quantity&quot;</span><span class="p">,</span> <span class="s2">&quot;pt&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s2">&quot;mat&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;pt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">m_t</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;mat&quot;</span><span class="p">:</span><span class="s2">&quot;material&quot;</span><span class="p">,</span> <span class="s2">&quot;pt&quot;</span><span class="p">:</span><span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f total&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># put that in a table</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">axone</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">axtwo</span><span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">sut</span><span class="o">.</span><span class="n">hide_spines_ticks_grids</span><span class="p">(</span><span class="n">axone</span><span class="p">)</span>
<span class="n">sut</span><span class="o">.</span><span class="n">hide_spines_ticks_grids</span><span class="p">(</span><span class="n">axtwo</span><span class="p">)</span>

<span class="c1"># summary data table</span>
<span class="n">a_table</span> <span class="o">=</span> <span class="n">axone</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">cellText</span><span class="o">=</span><span class="n">combined_summary</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>  <span class="n">colLabels</span><span class="o">=</span><span class="n">combined_summary</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">colWidths</span><span class="o">=</span><span class="p">[</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.25</span><span class="p">,</span><span class="mf">.25</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower center&quot;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">the_material_table_data</span> <span class="o">=</span> <span class="n">sut</span><span class="o">.</span><span class="n">make_a_summary_table</span><span class="p">(</span><span class="n">a_table</span><span class="p">,</span><span class="n">combined_summary</span><span class="p">,</span><span class="n">combined_summary</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">s_et_bottom_row</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># material totals</span>
<span class="n">a_table</span> <span class="o">=</span> <span class="n">axtwo</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">cellText</span><span class="o">=</span><span class="n">m_t</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>  <span class="n">colLabels</span><span class="o">=</span><span class="n">m_t</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">colWidths</span><span class="o">=</span><span class="p">[</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.25</span><span class="p">,</span><span class="mf">.25</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower center&quot;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">the_material_table_data</span> <span class="o">=</span> <span class="n">sut</span><span class="o">.</span><span class="n">make_a_summary_table</span><span class="p">(</span><span class="n">a_table</span><span class="p">,</span><span class="n">m_t</span><span class="p">,</span><span class="n">m_t</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">s_et_bottom_row</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/slr_2017_26_0.png" src="_images/slr_2017_26_0.png" />
</div>
</div>
<div class="section" id="lakes-results-most-common-objects-from-2018">
<h3><span class="section-number">21.3.1. </span>Lakes: results most common objects from 2018<a class="headerlink" href="#lakes-results-most-common-objects-from-2018" title="Permalink to this headline">Â¶</a></h3>
<p><em><strong>Below:</strong> the most common objects were 71% of all objects counted in 2018 versus 60% in 2020. Cigarette filters and fragmented plastic pieces were recorded at almost double the rate in 2018 versus 2020.</em></p>
<p><em>Lakes: key indicators of the most common objects 2018 - 2020</em></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compare the key indicators of the most common objects</span>
<span class="n">lks_codes</span> <span class="o">=</span> <span class="n">lks_df</span><span class="p">[</span><span class="n">lks_df</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">mcom</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">lks_codes</span> <span class="o">=</span> <span class="n">lks_df</span><span class="p">[</span><span class="n">lks_df</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">mcom</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;survey year&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="n">unit_label</span><span class="p">:</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="s2">&quot;quantity&quot;</span><span class="p">:</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;fail&quot;</span><span class="p">:</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;loc_date&quot;</span><span class="p">:</span><span class="s2">&quot;nunique&quot;</span><span class="p">})</span>

<span class="c1"># get fail rate and % of total</span>
<span class="k">for</span> <span class="n">a_year</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">,</span> <span class="s2">&quot;2018&quot;</span><span class="p">]:</span>
    <span class="n">lks_codes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">lks_codes</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">a_year</span><span class="p">,</span> <span class="s2">&quot;fail rate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lks_codes</span><span class="o">.</span><span class="n">fail</span><span class="o">/</span><span class="n">lks_df</span><span class="p">[</span><span class="n">lks_df</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">a_year</span><span class="p">]</span><span class="o">.</span><span class="n">loc_date</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
    <span class="n">lks_codes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">lks_codes</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">a_year</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lks_codes</span><span class="o">.</span><span class="n">quantity</span><span class="o">/</span><span class="n">lks_df</span><span class="p">[</span><span class="n">lks_df</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">a_year</span><span class="p">]</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># pivot on the survey year column and keep all the values</span>
<span class="n">pivot_2017_2020</span> <span class="o">=</span> <span class="n">lks_codes</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="n">unit_label</span><span class="p">,</span> <span class="s2">&quot;fail rate&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f total&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="s2">&quot;code&quot;</span><span class="p">)</span>

<span class="c1"># map description to code</span>
<span class="n">pivot_2017_2020</span><span class="p">[</span><span class="s2">&quot;Item&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pivot_2017_2020</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">code_description_map</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>

<span class="c1"># set index and sort</span>
<span class="n">pivot_2017_2020</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Item&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pivot_2017_2020</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">(</span><span class="n">unit_label</span><span class="p">,</span><span class="s2">&quot;2018&quot;</span><span class="p">),</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># plot that</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># use gridspec to position</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
<span class="n">axone</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">spec</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="n">axtwo</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">spec</span><span class="p">[:,</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
<span class="n">axthree</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">spec</span><span class="p">[:,</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">])</span>

<span class="c1"># get an order to assign each ax</span>
<span class="n">an_order</span> <span class="o">=</span> <span class="n">pivot_2017_2020</span><span class="p">[</span><span class="s2">&quot;p/100m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;2018&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># index axtwo and and axthree to axone</span>
<span class="n">axtwo_data</span> <span class="o">=</span> <span class="n">pivot_2017_2020</span><span class="p">[</span><span class="s2">&quot;fail rate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;2018&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">an_order</span><span class="p">)</span>
<span class="n">axthree_data</span> <span class="o">=</span> <span class="n">pivot_2017_2020</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f total&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;2018&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">an_order</span><span class="p">)</span>

<span class="c1"># pieces per meter</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pivot_2017_2020</span><span class="p">[</span><span class="n">unit_label</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap2</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.0f&quot;</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span><span class="mi">12</span><span class="p">},</span>  <span class="n">ax</span><span class="o">=</span><span class="n">axone</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span>  <span class="n">linecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">axone</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">labeltop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">no_xticks</span><span class="p">)</span>
<span class="n">axone</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">axone</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;median p/100m&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">title_k14r</span><span class="p">)</span>

<span class="c1"># fail rate</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pivot_2017_2020</span><span class="p">[</span><span class="s2">&quot;fail rate&quot;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap2</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span><span class="mi">12</span><span class="p">},</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.0%&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axtwo</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span>  <span class="n">linecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">axtwo</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">labeltop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">no_xticks</span><span class="p">)</span>
<span class="n">axtwo</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axtwo</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">axtwo</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;fail rate&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">title_k14r</span><span class="p">)</span>

<span class="c1"># percent of total</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pivot_2017_2020</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f total&quot;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap2</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span><span class="mi">12</span><span class="p">},</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.0%&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axthree</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span>  <span class="n">linecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">axthree</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">labeltop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">no_xticks</span><span class="p">)</span>
<span class="n">axthree</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axthree</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">axthree</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f total&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">title_k14r</span><span class="p">)</span>

<span class="k">for</span> <span class="n">anax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">axone</span><span class="p">,</span> <span class="n">axtwo</span><span class="p">,</span> <span class="n">axthree</span><span class="p">]:</span>
    <span class="n">anax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [12],</span> in <span class="ni">&lt;cell line: 38&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">34</span> <span class="n">axthree_data</span> <span class="o">=</span> <span class="n">pivot_2017_2020</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f total&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;2018&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">an_order</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">36</span> <span class="c1"># pieces per meter</span>
<span class="ne">---&gt; </span><span class="mi">38</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pivot_2017_2020</span><span class="p">[</span><span class="n">unit_label</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap2</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.0f&quot;</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span><span class="mi">12</span><span class="p">},</span>  <span class="n">ax</span><span class="o">=</span><span class="n">axone</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span>  <span class="n">linecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">39</span> <span class="n">axone</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">labeltop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">no_xticks</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> <span class="n">axone</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/envs/ppenv/lib/python3.8/site-packages/seaborn/_decorators.py:46,</span> in <span class="ni">_deprecate_positional_args.&lt;locals&gt;.inner_f</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">36</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">37</span>         <span class="s2">&quot;Pass the following variable</span><span class="si">{}</span><span class="s2"> as </span><span class="si">{}</span><span class="s2">keyword arg</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">. &quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">38</span>         <span class="s2">&quot;From version 0.12, the only valid positional argument &quot;</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span>         <span class="ne">FutureWarning</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span>     <span class="p">)</span>
<span class="nn">     45 kwargs.update({k: arg for k, arg</span> in <span class="ni">zip</span><span class="nt">(sig.parameters, args)})</span>
<span class="ne">---&gt; </span><span class="mi">46</span> <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/envs/ppenv/lib/python3.8/site-packages/seaborn/matrix.py:553,</span> in <span class="ni">heatmap</span><span class="nt">(data, vmin, vmax, cmap, center, robust, annot, fmt, annot_kws, linewidths, linecolor, cbar, cbar_kws, cbar_ax, square, xticklabels, yticklabels, mask, ax, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">551</span> <span class="k">if</span> <span class="n">square</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">552</span>     <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">553</span> <span class="n">plotter</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">cbar_ax</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">554</span> <span class="k">return</span> <span class="n">ax</span>

<span class="nn">File ~/anaconda3/envs/ppenv/lib/python3.8/site-packages/seaborn/matrix.py:302,</span> in <span class="ni">_HeatMapper.plot</span><span class="nt">(self, ax, cax, kws)</span>
<span class="g g-Whitespace">    </span><span class="mi">299</span>     <span class="n">kws</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;vmax&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span> <span class="c1"># Draw the heatmap</span>
<span class="ne">--&gt; </span><span class="mi">302</span> <span class="n">mesh</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">304</span> <span class="c1"># Set the axis limits</span>
<span class="g g-Whitespace">    </span><span class="mi">305</span> <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="nn">File ~/anaconda3/envs/ppenv/lib/python3.8/site-packages/matplotlib/__init__.py:1412,</span> in <span class="ni">_preprocess_data.&lt;locals&gt;.inner</span><span class="nt">(ax, data, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1409</span> <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1410</span> <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1411</span>     <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1412</span>         <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">sanitize_sequence</span><span class="p">,</span> <span class="n">args</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1414</span>     <span class="n">bound</span> <span class="o">=</span> <span class="n">new_sig</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1415</span>     <span class="n">auto_label</span> <span class="o">=</span> <span class="p">(</span><span class="n">bound</span><span class="o">.</span><span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">label_namer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1416</span>                   <span class="ow">or</span> <span class="n">bound</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">label_namer</span><span class="p">))</span>

<span class="nn">File ~/anaconda3/envs/ppenv/lib/python3.8/site-packages/matplotlib/axes/_axes.py:6070,</span> in <span class="ni">Axes.pcolormesh</span><span class="nt">(self, alpha, norm, cmap, vmin, vmax, shading, antialiased, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">6066</span> <span class="n">C</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">6068</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;snap&#39;</span><span class="p">,</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;pcolormesh.snap&#39;</span><span class="p">])</span>
<span class="ne">-&gt; </span><span class="mi">6070</span> <span class="n">collection</span> <span class="o">=</span> <span class="n">mcoll</span><span class="o">.</span><span class="n">QuadMesh</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">6071</span>     <span class="n">coords</span><span class="p">,</span> <span class="n">antialiased</span><span class="o">=</span><span class="n">antialiased</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="n">shading</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">6072</span>     <span class="n">array</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">6073</span> <span class="n">collection</span><span class="o">.</span><span class="n">_scale_norm</span><span class="p">(</span><span class="n">norm</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">6074</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pcolor_grid_deprecation_helper</span><span class="p">()</span>

<span class="nn">File ~/anaconda3/envs/ppenv/lib/python3.8/site-packages/matplotlib/collections.py:2016,</span> in <span class="ni">QuadMesh.__init__</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2013</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span><span class="o">.</span><span class="n">update_from_data_xy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_coordinates</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">2014</span> <span class="c1"># super init delayed after own init because array kwarg requires</span>
<span class="g g-Whitespace">   </span><span class="mi">2015</span> <span class="c1"># self._coordinates and self._shading</span>
<span class="ne">-&gt; </span><span class="mi">2016</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/envs/ppenv/lib/python3.8/site-packages/matplotlib/collections.py:221,</span> in <span class="ni">Collection.__init__</span><span class="nt">(self, edgecolors, facecolors, linewidths, linestyles, capstyle, joinstyle, antialiaseds, offsets, transOffset, norm, cmap, pickradius, hatch, urls, zorder, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">218</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transOffset</span> <span class="o">=</span> <span class="n">transOffset</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_effects</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">--&gt; </span><span class="mi">221</span> <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span> <span class="bp">self</span><span class="o">.</span><span class="n">_paths</span> <span class="o">=</span> <span class="kc">None</span>

<span class="nn">File ~/anaconda3/envs/ppenv/lib/python3.8/site-packages/matplotlib/artist.py:1066,</span> in <span class="ni">Artist.update</span><span class="nt">(self, props)</span>
<span class="g g-Whitespace">   </span><span class="mi">1063</span>             <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1064</span>                 <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">!r}</span><span class="s2"> object &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1065</span>                                      <span class="sa">f</span><span class="s2">&quot;has no property </span><span class="si">{</span><span class="n">k</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1066</span>             <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">1067</span> <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1068</span>     <span class="bp">self</span><span class="o">.</span><span class="n">pchanged</span><span class="p">()</span>

<span class="nn">File ~/anaconda3/envs/ppenv/lib/python3.8/site-packages/matplotlib/collections.py:2077,</span> in <span class="ni">QuadMesh.set_array</span><span class="nt">(self, A)</span>
<span class="g g-Whitespace">   </span><span class="mi">2072</span>     <span class="k">if</span> <span class="n">faulty_data</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2073</span>         <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2074</span>             <span class="sa">f</span><span class="s2">&quot;Dimensions of A </span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> are incompatible with &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2075</span>             <span class="sa">f</span><span class="s2">&quot;X (</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">) and/or Y (</span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2077</span> <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/envs/ppenv/lib/python3.8/site-packages/matplotlib/cm.py:477,</span> in <span class="ni">ScalarMappable.set_array</span><span class="nt">(self, A)</span>
<span class="g g-Whitespace">    </span><span class="mi">475</span> <span class="n">A</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">safe_masked_invalid</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">476</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">can_cast</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;same_kind&quot;</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">477</span>     <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Image data of dtype </span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2"> cannot be &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">478</span>                     <span class="s2">&quot;converted to float&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">480</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="o">=</span> <span class="n">A</span>

<span class="ne">TypeError</span>: Image data of dtype object cannot be converted to float
</pre></div>
</div>
<img alt="_images/slr_2017_29_1.png" src="_images/slr_2017_29_1.png" />
</div>
</div>
</div>
<div class="section" id="difference-of-mean-survey-total">
<h3><span class="section-number">21.3.2. </span>Difference of mean survey total<a class="headerlink" href="#difference-of-mean-survey-total" title="Permalink to this headline">Â¶</a></h3>
<p>When considering only lakes the difference of medians is inversed, less litter was observed in 2020 than 2018 and the difference of means is much larger in favor of 2018. Suggesting that at the lake level there was a decrease in observed quantities.</p>
<blockquote>
<div><p>Null hypothesis: The mean of the survey results for lakes from 2018 is not statistically different than the mean for 2020. The observed difference is due to chance.</p>
</div></blockquote>
<blockquote>
<div><p>Alternate hypothesis: The mean survey results for lakes in 2018 is not the same in 2020. The observed difference in the samples is significant.</p>
</div></blockquote>
<p><em><strong>Below:</strong> The distribution of the difference of means between the two sampling periods. The survey results were shuffled and sampled 5,000 times on the survey year column. The null hypothesis could be rejected, supporting the initial observation that there was less observed in 2020 than 2018.</em></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data for testing</span>
<span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">water_name_slug</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">these_lakes</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># get the survey total for each survey keep the survey year column</span>
<span class="n">pre_shuffle</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="s2">&quot;loc_date&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># get the mean for each survey year</span>
<span class="n">observed_mean</span> <span class="o">=</span> <span class="n">pre_shuffle</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;survey year&quot;</span><span class="p">)[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># get the diff</span>
<span class="n">observed_dif</span> <span class="o">=</span> <span class="n">observed_mean</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">observed_mean</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">]</span>

<span class="n">new_means</span><span class="o">=</span><span class="p">[]</span>
<span class="c1"># resampling:</span>
<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5000</span><span class="p">):</span>
    
    <span class="c1"># shuffle the survey year column</span>
    <span class="n">pre_shuffle</span><span class="p">[</span><span class="s2">&quot;new_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pre_shuffle</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
    <span class="c1"># get the means for both years</span>
    <span class="n">b</span><span class="o">=</span><span class="n">pre_shuffle</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;new_class&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="c1"># get the change and store it</span>
    <span class="n">new_means</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">b</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># calculate p</span>
<span class="n">emp_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">new_means</span> <span class="o">&lt;=</span> <span class="n">observed_dif</span> <span class="p">)</span><span class="o">/</span> <span class="mi">5000</span>

<span class="c1"># chart the results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">new_means</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">F</span><span class="s2">&quot;$</span><span class="se">\u0394</span><span class="s2">\mu$ = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">observed_dif</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">, perm=5000, p=</span><span class="si">{</span><span class="n">emp_p</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">title_k14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;permutations&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$\mu$ 2020 - $\mu$ 2018&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="difference-of-means-most-common-objects">
<h4><span class="section-number">21.3.2.1. </span>Difference of means most common objects<a class="headerlink" href="#difference-of-means-most-common-objects" title="Permalink to this headline">Â¶</a></h4>
<p>The observed difference of means between the two sampling periods was -235p/100m. The most common objects are approximately equal to 60% of the total. Changes in the daily total may be reflected in the daily totals of the most common objects as well.</p>
<p><strong>Test one:</strong></p>
<blockquote>
<div><p>Null hypothesis: The mean of the of the survey results of the most common objects from 2018 is the same as 2020. The observed difference is due to chance.</p>
</div></blockquote>
<blockquote>
<div><p>Alternate hypothesis: The mean of the survey results of the most common objects from 2018 is different than 2020. The observed difference in the samples is significant.</p>
</div></blockquote>
<ul class="simple">
<li><p>if p &lt; 0.05 = yellow: the difference is statistically significant.</p></li>
</ul>
<p><em><strong>Below:</strong> The observed difference in means between the two years could be in part explained by the decrease in the quantities of cigarettes, foam polystyrene, metal bottle tops and fragmented plastics.</em></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data testing</span>
<span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">water_name_slug</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">these_lakes</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># # the common codes from both years</span>
<span class="c1"># common_codes_both_years = list(set([*mcom_2017, *mcom_2020]))</span>

<span class="c1"># data to resample</span>
<span class="n">pre_shuffle</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">mcom</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="s2">&quot;loc_date&quot;</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># the observed mean from each year</span>
<span class="n">observed_mean</span> <span class="o">=</span> <span class="n">pre_shuffle</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;survey year&quot;</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">])[</span><span class="n">unit_label</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># get the differences from one year to the next: check the inverse</span>
<span class="n">observed_dif</span> <span class="o">=</span> <span class="n">observed_mean</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">observed_mean</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">]</span>
<span class="n">inv_diff</span> <span class="o">=</span> <span class="n">observed_mean</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">observed_mean</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">]</span>

<span class="c1"># number of shuffles</span>
<span class="n">perms</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">new_means</span><span class="o">=</span><span class="p">[]</span>
<span class="c1"># resample</span>
<span class="k">for</span> <span class="n">a_code</span> <span class="ow">in</span> <span class="n">mcom</span><span class="p">:</span>
    
    <span class="c1"># store the test statisitc</span>
    <span class="n">cdif</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#     invdif=[]</span>
    
    <span class="c1"># code data</span>
    <span class="n">c_data</span> <span class="o">=</span> <span class="n">pre_shuffle</span><span class="p">[</span><span class="n">pre_shuffle</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="n">a_code</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">perms</span><span class="p">):</span>
        <span class="c1"># shuffle labels</span>
        <span class="n">c_data</span><span class="p">[</span><span class="s2">&quot;new_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_data</span><span class="p">[</span><span class="s2">&quot;survey year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
        <span class="n">b</span><span class="o">=</span><span class="n">c_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;new_class&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">cdif</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">b</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2018&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1">#         invdif.append((b.loc[&quot;2018&quot;] - b.loc[&quot;2020&quot;]).values[0])</span>
    
    <span class="c1"># calculate p</span>
    <span class="n">emp_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">cdif</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">observed_dif</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a_code</span><span class="p">]))</span> <span class="o">/</span> <span class="n">perms</span>
<span class="c1">#     inv_p = np.count_nonzero(invdif &gt;= (observed_dif.loc[a_code])) / perms</span>
    
    <span class="c1"># store that result</span>
    <span class="n">new_means</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">a_code</span><span class="p">:{</span><span class="s2">&quot;p&quot;</span><span class="p">:</span><span class="n">emp_p</span><span class="p">,</span><span class="s2">&quot;difs&quot;</span><span class="p">:</span><span class="n">cdif</span><span class="p">}})</span>    

<span class="c1"># chart the results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">code</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mcom</span><span class="p">):</span>
    
    <span class="c1"># set up the ax</span>
    <span class="n">row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">%</span><span class="k">4</span>))
    <span class="n">col</span> <span class="o">=</span><span class="n">i</span><span class="o">%</span><span class="k">2</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>
    
    <span class="c1"># data for charts</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">new_means</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">code</span><span class="p">][</span><span class="s2">&quot;difs&quot;</span><span class="p">]</span>
    
    <span class="c1"># pvalues</span>
    <span class="n">p</span><span class="o">=</span><span class="n">new_means</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">code</span><span class="p">][</span><span class="s2">&quot;p&quot;</span><span class="p">]</span>
   
    
    <span class="c1"># set the facecolor based on the p value</span>
    
    <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s2">&quot;palegoldenrod&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>        
    <span class="c1"># plot that    </span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">this_palette</span><span class="p">[</span><span class="s2">&quot;2020&quot;</span><span class="p">])</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">code_description_map</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">code</span><span class="p">],</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">title_k</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">F</span><span class="s2">&quot;$</span><span class="se">\u0394</span><span class="s2">\mu$=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">observed_dif</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">code</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">new_means</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">code</span><span class="p">][</span><span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;permutations&quot;</span><span class="p">)</span>

<span class="c1"># hide the unused axs</span>
<span class="n">sut</span><span class="o">.</span><span class="n">hide_spines_ticks_grids</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># get some space for xaxis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
</div>
</div>
<div class="section" id="land-use-profile-spearmans-ranked-correlation">
<h3><span class="section-number">21.3.3. </span>Land use profile: Spearmans ranked correlation<a class="headerlink" href="#land-use-profile-spearmans-ranked-correlation" title="Permalink to this headline">Â¶</a></h3>
<p>The land use features were previously calculated to compare the survey locations. To test the statistical significance of land use on beach litter survey results the survey totals and locations from both projects were considered as one group. The survey results of the most common objects were tested against the measured land use features.</p>
<p>Spearmans <span class="math notranslate nohighlight">\(\rho\)</span> or Spearmans ranked correlation coefficient is a non-parametric test of rank correlation between two variables <span id="id8">[<a class="reference internal" href="references.html#id10" title="Wikepedia. Spearman's rank correlation coefficient. URL: https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient.">Wikd</a>]</span> <span id="id9">[<a class="reference internal" href="references.html#id13" title="Mathematics Education Innovation. Spearmans rank correlation. URL: https://mei.org.uk/files/pdf/Spearmanrcc.pdf.">Inn</a>]</span>. The test results are evaluated at p&lt;0.05 and 454 samples, SciPy is used to implement the test <span id="id10">[<a class="reference internal" href="references.html#id11" title="Python scientific computing. Scipy stats spearmanr: implementation. URL: https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.spearmanr.html.">scc</a>]</span>.</p>
<ol class="simple">
<li><p>Red/rose is a positive association: p&lt;0.05 AND <span class="math notranslate nohighlight">\(\rho\)</span> &gt; 0</p></li>
<li><p>yellow is a negative association: p&lt;0.05 AND <span class="math notranslate nohighlight">\(\rho\)</span> &lt; 0</p></li>
<li><p>white medians that p&gt;0.05, there is no statistical basis to assume an association</p></li>
</ol>
<p><em><strong>Below:</strong> An association suggests that survey totals for that object will change in relation to the amount of space attributed to that feature, or in the case of roads or river intersections, the quantity. The magnitude of the relationship is not defined, and any association is not linear.</em></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr_data</span> <span class="o">=</span> <span class="n">lks_df</span><span class="p">[(</span><span class="n">lks_df</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">mcom</span><span class="p">))]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># keys to the column names</span>
<span class="n">some_keys</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;% to buildings&quot;</span><span class="p">:</span><span class="s2">&quot;lu_build&quot;</span><span class="p">,</span>
    <span class="s2">&quot;% to agg&quot;</span><span class="p">:</span><span class="s2">&quot;lu_agg&quot;</span><span class="p">,</span>
    <span class="s2">&quot;% to woods&quot;</span><span class="p">:</span><span class="s2">&quot;lu_woods&quot;</span><span class="p">,</span>
    <span class="s2">&quot;% to recreation&quot;</span><span class="p">:</span><span class="s2">&quot;lu_rec&quot;</span><span class="p">,</span>
    <span class="s2">&quot;% to trans&quot;</span><span class="p">:</span><span class="s2">&quot;lu_trans&quot;</span><span class="p">,</span>
    <span class="s2">&quot;% to meadow&quot;</span><span class="p">:</span><span class="s2">&quot;lu_m&quot;</span><span class="p">,</span>
    <span class="s2">&quot;str_rank&quot;</span><span class="p">:</span><span class="s2">&quot;lu_trans&quot;</span>
<span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mcom</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">luse_exp</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">luse_exp</span><span class="p">)</span><span class="o">+</span><span class="mi">7</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">mcom</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="s2">&quot;row&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">code</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mcom</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">corr_data</span><span class="p">[</span><span class="n">corr_data</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="n">code</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">luse_exp</span><span class="p">):</span>
        <span class="c1"># each grid is its own axis with a scatterplot</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
       
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
        
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">F</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">code_description_map</span><span class="p">[</span><span class="n">code</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">ck</span><span class="o">.</span><span class="n">xlab_k14</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">corr</span><span class="p">,</span> <span class="n">a_p</span> <span class="o">=</span> <span class="n">sut</span><span class="o">.</span><span class="n">make_plot_with_spearmans</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        
        <span class="c1"># assign the facecolor based on the value of p and rho</span>
        <span class="k">if</span> <span class="n">a_p</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">corr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s2">&quot;salmon&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s2">&quot;palegoldenrod&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># plt.savefig(F&quot;{project_directory}/test_one.jpg&quot;, dpi=300)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="interpret-spearmans-rho">
<h4><span class="section-number">21.3.3.1. </span>Interpret Spearmans <span class="math notranslate nohighlight">\(\rho\)</span><a class="headerlink" href="#interpret-spearmans-rho" title="Permalink to this headline">Â¶</a></h4>
<p><strong>Interpreting results for the most common objects</strong></p>
<p>A positive association medians that the land use attribute or feature had increased survey results when compared to other locations. This may be due to a covariance of attributes, either way <strong>a positive association is a signal that the survey locations are near a zone of accumulation or a source</strong>. This signal should be assessed along with the other key indicators of survey locations that have similar land use profiles. In general locations that fit the criteria could be considered as both a source and an area of accumulation for any objects that are positively associated.</p>
<p>A negative association medians that the land use feature or attribute does not facilitate the accumulation of the object. This result is common for agricultural areas and woods on the national level. <strong>A negative association is a signal that the locations are not a zone of accumulation for the object</strong>.</p>
<p>No or few association means that the land use features had no effect on the accumulation of that object. The survey results of the most common objects with no or few associations fall into two characteristics:</p>
<ol class="simple">
<li><p>Ubiquitous: high fail rate, high pieces per meter. Found at consistent rates through out the survey area indifferent of land use</p></li>
<li><p>Transient: low fail rate, high quantity, high pieces per meter, few associations. Found occasionally in large quantities at specific locations</p></li>
</ol>
</div>
</div>
</div>
<div class="section" id="conclusion">
<h2><span class="section-number">21.4. </span>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="on-balance-no-change">
<h3><span class="section-number">21.4.1. </span>On balance no change<a class="headerlink" href="#on-balance-no-change" title="Permalink to this headline">Â¶</a></h3>
<p>The summary statistics and the results of the difference of medians test imply that there was no statistically measurable change on the national scale from one project to the next. The 95% CI of the median survey total in 2020 was 137 - 188p/100m ( <em>section <a class="reference internal" href="baselines.html#threshhold"><span class="std std-ref">Calculating Baselines</span></a></em> ). The median result for 2018 was 125p/100m with a CI of 112p/100m to 146p/100m, which includes the lower bound of the median from 2020. <strong>However, the difference of means for the most common objects suggest a more realistic and dynamic result:</strong></p>
<ol class="simple">
<li><p>There was a statistically significant decrease in four of seven most common objects from both years:</p>
<ul class="simple">
<li><p>cigarette ends</p></li>
<li><p>metal bottle caps</p></li>
<li><p>plastic fragments</p></li>
<li><p>foam fragments</p></li>
</ul>
</li>
</ol>
<p>The decrease in tobacco and bottle tops is likely the result of pandemic related restrictions that marked 2020. These results suggest that perceived local decreases in litter quantities were most likely the result of a general decline in usage as opposed to a sweeping change in behavior. Consequently the survey results for list 1 items will most likely return to 2018 levels as pandemic related restrictions are relaxed and usage patterns return to <em>normal</em>.</p>
<p>The decreases in fragmented foams and plastics is likely due to a difference in protocols between the two years.</p>
</div>
<div class="section" id="protocols-matter">
<h3><span class="section-number">21.4.2. </span>Protocols matter<a class="headerlink" href="#protocols-matter" title="Permalink to this headline">Â¶</a></h3>
<p>There was a key difference between the two projects:</p>
<ul class="simple">
<li><p>The 2020 protocol counts all visible objects and classifies fragments by size</p></li>
<li><p>The 2018 protocol limited the object counts to items greater than or equal to 2.5cm in length</p></li>
</ul>
<p>The total amount of plastic pieces collected in 2020 is 7,400 or 18p/100m and 5,563 or 5p/100m foamed plastic fragments. There were 3,662 plastic pieces between 0.5cm and 2.5cm removed in 2020, equal to the total amount recorded in 2018. The same for foamed plastics between 0.5cm and 2.5cm, see <a class="reference internal" href="lakes_rivers.html#allsurveys"><span class="std std-ref"><em>Lakes and rivers</em></span></a>.</p>
<p>The difference in protocol and the results from 2020 cast doubt on the likelihood of any decrease of fragmented plastics and foamed plastics from 2018 to 2020. Foamed plastics and fragmented plastics are objects whose original use is unknown but the material can be distinguished. Fragmented plastics and foamed plastics greater than 0.5cm are 27% of the total survey results for the lakes in 2020. Studies in the Meuse/Rhine delta show that these small, fragmented objects make up large portions of the total abundance <span id="id11">[<a class="reference internal" href="references.html#id52" title="Tim van Emmerik. Riverbank macrolitter in the dutch rhineâmeuse delta. URL: https://iopscience.iop.org/article/10.1088/1748-9326/abb2c6.">vE</a>]</span>.</p>
<p>Allowing surveyors to use a broader range of object codes increases the accuracy of the total survey count and adds levels of differentiation between similar materials. For example, expanded polystyrene is an object that fragments easily. Whether or not surveyors are finding a few larger pieces &gt; 20cm or thousands of pieces &lt; 10mm is an important detail if reducing these objects in the environment is the goal.</p>
<p>Reduced cost and increased access are another result of a harmonized protocol. The procedures used by the SLR and IQAASL were almost identical, except for the size limit it can be assumed that the samples were collected under similar conditions. The SLR data gives the results of over 1,000 observations by approximately 150 people and the IQAASL data gives the results of 350 observations from approximately 10 people. Both methods have weaknesses and strengths that address very diverse topics:</p>
<ul class="simple">
<li><p>experience of surveyor</p></li>
<li><p>consistency of survey results</p></li>
<li><p>oversight</p></li>
<li><p>intended use of data</p></li>
<li><p>allocation of resources</p></li>
</ul>
<p>All of these topics should be considered with each project, as well as stewardship of the data. Regardless of the differences, <strong>we were able to build on the model proposed by the SLR</strong> and add to the shared experience.</p>
</div>
<div class="section" id="plastic-lids">
<h3><span class="section-number">21.4.3. </span>Plastic lids<a class="headerlink" href="#plastic-lids" title="Permalink to this headline">Â¶</a></h3>
<p>Plastic lids are separated into three categories during the counting process:</p>
<ol class="simple">
<li><p>drink, food</p></li>
<li><p>household cleaners etc..</p></li>
<li><p>unknown</p></li>
</ol>
<p>As group plastic lids make up 2% of the total objects in 2018 and 3% in 2020. Drink lids were ~51% of all lids found in 2018, 45% in 2020. On a pieces per meter basis there was a decrease in the amount of drink lids and an increase of non-drink lids from 2018 - 2020.</p>
</div>
<div class="section" id="land-use-profile">
<h3><span class="section-number">21.4.4. </span>Land use profile<a class="headerlink" href="#land-use-profile" title="Permalink to this headline">Â¶</a></h3>
<p>The land use profile for each location was calculated using the same data for both years. When survey results from both years are considered as a group the results from Spearmans ð lend support to the SLR conclusions in 2018 that survey results were elevated in urban and suburban environments and this was also true in 2020. At the same time the ubiquitous nature of fragmented plastics, industrial sheeting and expanded foams noted in <a class="reference internal" href="land_use_correlation.html#luseprofile"><span class="std std-ref"><em>The land use profile</em></span></a> was likely prevalent in 2018.</p>
<p>The amount of land attributed to recreational activities are locations near the survey site designed to accommodate groups of people for various activities. The positive association of tobacco and food/drink related products with this land attribute could be interpreted as the result of temporary increases in population near the survey site.</p>
</div>
<div class="section" id="conclusions">
<h3><span class="section-number">21.4.5. </span>Conclusions<a class="headerlink" href="#conclusions" title="Permalink to this headline">Â¶</a></h3>
<p>The samples from both projects were taken from locations, in some cases the same location, that had similar levels of infrastructure and economic development. A common protocol was used in both projects, the samples were collected by two different groups and managed by two different associations.</p>
<p>From 2018 - 2020 there was a statistically significant change, a decrease in the number of objects directly related to behavior at the survey site. This indicates that any perceived decreases were in locations that had a higher % of land attributed to buildings and lower % of land attributed to agriculture or woods.</p>
<p>Locations with an opposing or different land use profile (less buildings, more agriculture or woods) will most likely not have experienced any decrease at all. For locations near river interchanges or major discharge points there would be no perceivable difference from 2018 - 2020 and increases in fragmented plastics, expanded foams and industrial sheeting were likely. Both the test of difference of medians of the most common objects and the results from Spearmans <span class="math notranslate nohighlight">\(\rho\)</span> of survey results support this conclusion.</p>
<p>Both survey years show peak survey results in June - July (annex) and lows in November. The possible causes for the peaks and troughs are different depending on the object in question. Food and tobacco objects are more prevalent during the summer season because of increased use. Objects like fragmented plastics depend more on hydrological conditions and the peak discharge rate of the biggest rivers in this study are from May - July(  <em>section <a class="reference internal" href="shared_responsibility.html#transport"><span class="std std-ref">Shared responsibility</span></a></em> ).</p>
<p>Future surveys should include visible items of all sizes. Data aggregation can be done at the server using defined rules based on known relationships. The total count is a key indicator in all statistics that rely on count data, for modeling purposes it is essential.</p>
</div>
</div>
<div class="section" id="annex">
<h2><span class="section-number">21.5. </span>Annex<a class="headerlink" href="#annex" title="Permalink to this headline">Â¶</a></h2>
<p><strong>Pariticipating organizations</strong></p>
<ol class="simple">
<li><p>Precious plastic leman</p></li>
<li><p>Association pour la sauvetage du LÃ©man</p></li>
<li><p>Geneva international School</p></li>
<li><p>Solid waste management: Ãcole polytechnique fÃ©dÃ©ral Lausanne</p></li>
</ol>
<div class="section" id="lakes-monthly-median-common-objects">
<h3><span class="section-number">21.5.1. </span>Lakes monthly median common objects:<a class="headerlink" href="#lakes-monthly-median-common-objects" title="Permalink to this headline">Â¶</a></h3>
<p>All lakes were sampled in all months in both projects. In 2018 the minimum samples per month  was 12 and the maximum was 17 compared to a minimum of 17 and max of 34 in 2020.</p>
<p><em>Lakes 2018: monthly average survey result most common objects</em></p>
<div class="cell tag_hide-input tag_remove-input docutils container">
</div>
<p><br></br>
<em>Lakes 2020: monthly average survey result most common objects</em></p>
<div class="cell tag_remove-input docutils container">
</div>
<p><a id="gps"></a></p>
<div class="section" id="survey-locations">
<h4><span class="section-number">21.5.1.1. </span><a class="reference external" href="#annex">Survey locations</a><a class="headerlink" href="#survey-locations" title="Permalink to this headline">Â¶</a></h4>
<div class="cell tag_remove-input docutils container">
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="shared_responsibility.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">20. </span>Shared responsibility</p>
        </div>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      <div class="extra_footer">
        <p>
   Comissioned by the Swiss Federal Office for the Environment (FOEN), Â© 2021
</p>

      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>